import{x as ae,g as te}from"./vendor-vue-C6le94gM.js";import{_ as le}from"./AppLayout.vue_vue_type_script_setup_true_lang-BeAMINRz.js";import{_ as ne}from"./Layout.vue_vue_type_script_setup_true_lang-CU45tdIh.js";import{_ as oe}from"./Input.vue_vue_type_script_setup_true_lang-1zH_gJ02.js";import{_ as g}from"./Button.vue_vue_type_script_setup_true_lang-DA-5a5tM.js";import{b as C,_ as A,a as re}from"./DialogDescription.vue_vue_type_script_setup_true_lang-BDOQqQHy.js";import{_ as ue}from"./DialogFooter.vue_vue_type_script_setup_true_lang-C4cZ_wVx.js";import{_ as ie,a as me}from"./DialogTitle.vue_vue_type_script_setup_true_lang-K_t0Wv0O.js";import{_ as de,a as pe,b as fe,c as ce,d as ve,e as _e}from"./RoleForm.vue_vue_type_script_setup_true_lang-DembVhbV.js";import{_ as xe}from"./HeadingSmall.vue_vue_type_script_setup_true_lang-BhvImSkb.js";import{_ as B}from"./Card.vue_vue_type_script_setup_true_lang-DQTQMX6v.js";import{_ as T}from"./CardContent.vue_vue_type_script_setup_true_lang-DNXZ8J1r.js";import{_ as V}from"./CardHeader.vue_vue_type_script_setup_true_lang-n-Rvhb9V.js";import{_ as E}from"./CardTitle.vue_vue_type_script_setup_true_lang-AShXP1uR.js";import{_ as we}from"./Separator.vue_vue_type_script_setup_true_lang-NVRt3j8w.js";import{s as ye,U as ge,p as L,j as be,B as Se,o as $e}from"./vendor-icons-Bu7C1ObZ.js";import{d as Ue,c as b,r as u,b as p,e as i,f as a,l as s,u as e,X as r,L as ke,k as f,S as D,U as N}from"./vendor-cgn9wV4E.js";import"./vendor-axios-C0Zqfgkc.js";import"./utils-C4uCeQPu.js";import"./vendor-ui-BuPyOEYe.js";import"./Icon.vue_vue_type_script_setup_true_lang-g5QrAIpa.js";import"./useInitials-DzeGKvtI.js";import"./app-8KAEFqwr.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BM02NuXb.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Badge.vue_vue_type_script_setup_true_lang-BpieHD20.js";import"./Label.vue_vue_type_script_setup_true_lang-WOFpmVDV.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-ChpZyGGS.js";import"./InputError.vue_vue_type_script_setup_true_lang-B3W--yJp.js";const Ce={class:"flex flex-col space-y-6 w-full"},Ae={key:0,class:"relative w-full max-w-lg"},De={class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},Me={class:"flex items-center space-x-2"},he={class:"flex items-center space-x-2"},Re={class:"flex items-center space-x-2"},rs=Ue({__name:"UserRolesManagement",props:{users:{type:Object,default:()=>({data:[],links:[]})},roles:{type:Object,default:()=>({data:[],links:[]})},tenants:{type:Object,default:()=>({data:[],links:[]})},permissions:Array,search:String,tenantSlug:{type:String,default:null},SuperAdmin:Boolean},setup(c){const n=c,{tenantSlug:m}=n,z=b(()=>[{title:m?"Dashboard":"Admin Dashboard",href:m?route("dashboard",{tenantSlug:n.tenantSlug}):route("admin.dashboard")}]),S=u(n.search||""),v=u(!1),_=u(!1),x=u(!1),M=u(null),h=u(null),R=u(null),w=n.SuperAdmin,d=u(!1),$=u(""),U=u(""),k=ae({}),O=b(()=>{if(!S.value.trim())return n.users;const l=S.value.toLowerCase(),t=n.users.data.filter(o=>o.name.toLowerCase().includes(l)||o.email.toLowerCase().includes(l));return{...n.users,data:t}}),F=()=>{M.value=null,v.value=!0},P=()=>{v.value=!1},X=()=>{R.value=null,x.value=!0},q=()=>{x.value=!1},G=()=>{h.value=null,_.value=!0},H=()=>{_.value=!1},I=l=>{M.value=l,v.value=!0},J=l=>{R.value=l,x.value=!0},K=l=>{h.value=l,_.value=!0},Q=l=>{$.value=w?route("admin.users.destroy",l):route("users.destroy",[m,l]),U.value=`Are you sure you want to delete user ${l.name}?`,d.value=!0},W=l=>{$.value=w?route("admin.roles.destroy",l):route("roles.destroy",[m,l]),U.value=`Are you sure you want to delete role ${l.name}?`,d.value=!0},Y=l=>{$.value=route("admin.tenants.destroy",l),U.value=`Are you sure you want to delete tenant ${l.name}?`,d.value=!0},Z=()=>{k.delete($.value,{onSuccess:()=>{d.value=!1},onError:l=>{console.error("Delete failed:",l)}})},j=()=>{_.value=!1,v.value=!1,x.value=!1},ee=b(()=>n.roles.data),se=b(()=>n.tenants.data),y=b(()=>n.permissions.map(l=>l.name));return(l,t)=>(i(),p(le,{breadcrumbs:z.value,tenantSlug:e(m),permissions:n.permissions},{default:a(()=>[s(e(te),{title:"Users Management"}),s(ne,{permissions:n.permissions},{default:a(()=>[r("div",Ce,[s(xe,{title:"User and Role Management",description:"Manage users, roles, and permissions for your application"}),s(e(we)),y.value.includes("users.view")?(i(),ke("div",Ae,[r("div",De,[s(e(ye),{class:"h-5 w-5 text-gray-400"})]),s(oe,{modelValue:S.value,"onUpdate:modelValue":t[0]||(t[0]=o=>S.value=o),placeholder:"Search users...",class:"w-full pl-10 rounded-md"},null,8,["modelValue"])])):f("",!0),y.value.includes("users.view")?(i(),p(e(B),{key:1,class:"w-full"},{default:a(()=>[s(e(V),{class:"p-2 md:p-4 lg:p-6 flex flex-row items-center justify-between space-y-0 pb-2"},{default:a(()=>[s(e(E),{class:"text-xl font-semibold"},{default:a(()=>[r("div",Me,[s(e(ge),{class:"h-5 w-5"}),t[6]||(t[6]=r("span",null,"Users",-1))])]),_:1}),y.value.includes("users.create")?(i(),p(g,{key:0,onClick:F,variant:"default",size:"sm",class:"gap-1"},{default:a(()=>[s(e(L),{class:"h-4 w-4"}),t[7]||(t[7]=r("span",null,"Add User",-1))]),_:1})):f("",!0)]),_:1}),s(e(T),{class:"p-2 md:p-4 lg:p-6"},{default:a(()=>[s(de,{permissions:n.permissions,users:O.value,isSuperAdmin:e(w),onEdit:I,onDelete:Q},null,8,["permissions","users","isSuperAdmin"])]),_:1})]),_:1})):f("",!0),y.value.includes("roles.view")?(i(),p(e(B),{key:2,class:"w-full"},{default:a(()=>[s(e(V),{class:"p-2 md:p-4 lg:p-6 flex flex-row items-center justify-between space-y-0 pb-2"},{default:a(()=>[s(e(E),{class:"text-xl font-semibold"},{default:a(()=>[r("div",he,[s(e(be),{class:"h-5 w-5"}),t[8]||(t[8]=r("span",null,"Roles",-1))])]),_:1}),y.value.includes("roles.create")?(i(),p(g,{key:0,onClick:G,variant:"default",size:"sm",class:"gap-1"},{default:a(()=>[s(e(L),{class:"h-4 w-4"}),t[9]||(t[9]=r("span",null,"Add Role",-1))]),_:1})):f("",!0)]),_:1}),s(e(T),{class:"p-2 md:p-4 lg:p-6"},{default:a(()=>[s(pe,{permissions:n.permissions,roles:c.roles,onEdit:K,onDelete:W},null,8,["permissions","roles"])]),_:1})]),_:1})):f("",!0),e(w)?(i(),p(e(B),{key:3,class:"w-full"},{default:a(()=>[s(e(V),{class:"p-2 md:p-4 lg:p-6 flex flex-row items-center justify-between space-y-0 pb-2"},{default:a(()=>[s(e(E),{class:"text-xl font-semibold"},{default:a(()=>[r("div",Re,[s(e(Se),{class:"h-5 w-5"}),t[10]||(t[10]=r("span",null,"Companies",-1))])]),_:1}),s(g,{onClick:X,variant:"default",size:"sm",class:"gap-1"},{default:a(()=>[s(e(L),{class:"h-4 w-4"}),t[11]||(t[11]=r("span",null,"Add Company",-1))]),_:1})]),_:1}),s(e(T),{class:"p-2 md:p-4 lg:p-6"},{default:a(()=>[s(fe,{tenants:c.tenants,onEdit:J,onDelete:Y},null,8,["tenants"])]),_:1})]),_:1})):f("",!0),s(e(C),{open:v.value,"onUpdate:open":t[1]||(t[1]=o=>v.value=o)},{default:a(()=>[s(e(A),{class:"max-w-[95vw] sm:max-w-[90vw] md:max-w-4xl"},{default:a(()=>[s(ce,{user:M.value,roles:ee.value,permissions:c.permissions,tenants:se.value,isSuperAdmin:e(w),tenantSlug:e(m),onClose:P,onSaved:j},null,8,["user","roles","permissions","tenants","isSuperAdmin","tenantSlug"])]),_:1})]),_:1},8,["open"]),s(e(C),{open:x.value,"onUpdate:open":t[2]||(t[2]=o=>x.value=o)},{default:a(()=>[s(e(A),{class:"max-w-[95vw] sm:max-w-[90vw] md:max-w-2xl"},{default:a(()=>[s(ve,{tenants:c.tenants,tenant:R.value,onClose:q,onSaved:j},null,8,["tenants","tenant"])]),_:1})]),_:1},8,["open"]),s(e(C),{open:_.value,"onUpdate:open":t[3]||(t[3]=o=>_.value=o)},{default:a(()=>[s(e(A),{class:"max-w-[95vw] sm:max-w-[90vw] md:max-w-4xl"},{default:a(()=>[s(_e,{role:h.value,permissions:c.permissions,isSuperAdmin:e(w),tenantSlug:e(m),onClose:H,onSaved:j},null,8,["role","permissions","isSuperAdmin","tenantSlug"])]),_:1})]),_:1},8,["open"]),s(e(C),{open:d.value,"onUpdate:open":t[5]||(t[5]=o=>d.value=o)},{default:a(()=>[s(e(A),{class:"max-w-[95vw] sm:max-w-md"},{default:a(()=>[s(e(ie),{class:"px-4 sm:px-6"},{default:a(()=>[s(e(me),{class:"text-lg sm:text-xl"},{default:a(()=>t[12]||(t[12]=[D("Confirm Deletion")])),_:1}),s(e(re),{class:"text-xs sm:text-sm"},{default:a(()=>[D(N(U.value),1)]),_:1})]),_:1}),s(e(ue),{class:"px-4 sm:px-6"},{default:a(()=>[s(g,{type:"button",onClick:t[4]||(t[4]=o=>d.value=!1),variant:"outline",class:"h-9 px-4 py-1 text-xs sm:h-10 sm:text-sm"},{default:a(()=>t[13]||(t[13]=[D(" Cancel ")])),_:1}),s(g,{type:"button",onClick:Z,variant:"destructive",class:"h-9 px-4 py-1 text-xs sm:h-10 sm:text-sm",disabled:e(k).processing},{default:a(()=>[e(k).processing?(i(),p(e($e),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):f("",!0),D(" "+N(e(k).processing?"Deleting...":"Delete"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])])]),_:1},8,["permissions"])]),_:1},8,["breadcrumbs","tenantSlug","permissions"]))}});export{rs as default};
