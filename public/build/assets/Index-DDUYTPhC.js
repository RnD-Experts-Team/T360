import{c as V,L as f,e as u,X as t,U as g,b2 as K,M,S as c,N as z,a1 as vt,r as F,A as Je,w as de,bW as bt,b as $,l as r,k as _,f as n,u as a,d as Te,D as X,Y as te,bH as gt,P as be,h as Z,K as _t,bF as xt}from"./vendor-cgn9wV4E.js";import{a as yt,W as Fe,x as Me,g as kt}from"./vendor-vue-C6le94gM.js";import{_ as wt}from"./Badge.vue_vue_type_script_setup_true_lang-BpieHD20.js";import{_ as H}from"./Icon.vue_vue_type_script_setup_true_lang-g5QrAIpa.js";import{_ as U}from"./Button.vue_vue_type_script_setup_true_lang-DA-5a5tM.js";import{b as Ve,_ as Ae,a as Re}from"./AlertDescription.vue_vue_type_script_setup_true_lang-BdYx0SaG.js";import{_ as ge}from"./Card.vue_vue_type_script_setup_true_lang-DQTQMX6v.js";import{_ as _e}from"./CardContent.vue_vue_type_script_setup_true_lang-DNXZ8J1r.js";import{_ as Ie,a as Le,b as ue,c as se,d as Ue,e as re}from"./TableRow.vue_vue_type_script_setup_true_lang-58J5Q7id.js";import{b as Se,a as he,_ as Ce}from"./DialogDescription.vue_vue_type_script_setup_true_lang-BDOQqQHy.js";import{_ as $e,a as De}from"./DialogTitle.vue_vue_type_script_setup_true_lang-K_t0Wv0O.js";import{_ as Ee}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as Y}from"./Input.vue_vue_type_script_setup_true_lang-1zH_gJ02.js";import{_ as R}from"./Label.vue_vue_type_script_setup_true_lang-WOFpmVDV.js";import{_ as jt}from"./CardHeader.vue_vue_type_script_setup_true_lang-n-Rvhb9V.js";import{_ as St}from"./CardTitle.vue_vue_type_script_setup_true_lang-AShXP1uR.js";import{_ as Ze}from"./DialogFooter.vue_vue_type_script_setup_true_lang-C4cZ_wVx.js";import{_ as ht}from"./AppLayout.vue_vue_type_script_setup_true_lang-BeAMINRz.js";import"./vendor-axios-C0Zqfgkc.js";import"./utils-C4uCeQPu.js";import"./vendor-icons-Bu7C1ObZ.js";import"./vendor-ui-BuPyOEYe.js";import"./useInitials-DzeGKvtI.js";import"./app-8KAEFqwr.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BM02NuXb.js";const Ct={class:"bg-background rounded-lg border shadow-sm p-2 md:p-4 flex flex-col items-center justify-center"},$t={class:"text-sm font-semibold mb-2 text-foreground"},Dt={__name:"TotalLateStops",props:{title:{type:String,required:!0},value:{type:[Number,String],required:!0}},setup(j){const s=j,h=V(()=>s.value===null||s.value===void 0||s.value===""?"No Data":s.value),T=V(()=>{const I=Number(s.value);return s.title.toLowerCase().includes("total")&&I>0});return(I,E)=>(u(),f("div",Ct,[t("h3",$t,g(j.title),1),t("p",{class:K(["text-2xl font-bold",T.value?"text-red-600":"text-primary"])},g(h.value),3)]))}},Vt={class:"bg-background rounded-lg border shadow-sm p-2 md:p-4"},At={class:"text-base text-center font-semibold mb-4"},Rt={key:0,class:"text-center text-sm py-4 text-primary font-medium"},Tt={class:"space-y-3"},Bt={class:"text-sm"},Nt={__name:"BottomDrivers",props:{title:{type:String,default:"Bottom 5 Drivers"},drivers:{type:Array,default:()=>[]},totalRejections:{type:Number,default:0},rejectionType:{type:String,default:""}},setup(j){const s=j;V(()=>s.rejectionType==="load"?"No load rejections recorded. You're on track for Fantastic+ !":s.rejectionType==="block"?"No block rejections recorded. You're on track for Fantastic+ !":"No rejections recorded. You're on track for Fantastic+ !");const h=T=>{const I=["#ef4444","#f97316","#f59e0b","#84cc16","#10b981"],w=[...s.drivers].sort((C,B)=>B.total_penalty-C.total_penalty).map(C=>C.total_penalty).indexOf(T);return I[w]||"#6b7280"};return(T,I)=>(u(),f("div",Vt,[t("h3",At,g(j.title),1),j.drivers.length===0?(u(),f("div",Rt,[j.totalRejections===0?(u(),f(M,{key:0},[j.rejectionType==="block"?(u(),f(M,{key:0},[c(" No block rejections recorded. You're on track for Fantastic+ ! ")],64)):j.rejectionType==="load"?(u(),f(M,{key:1},[c(" No load rejections recorded. You're on track for Fantastic+ ! ")],64)):(u(),f(M,{key:2},[c(" No rejections recorded. You're on track for Fantastic+ ! ")],64))],64)):(u(),f(M,{key:1},[c(" No delays recorded. You're on track for Fantastic+ ! ")],64))])):(u(),f(M,{key:1},[I[0]||(I[0]=t("div",{class:"flex justify-between items-center mb-2"},[t("span",{class:"text-base mb-2 font-medium"},"Driver Name"),t("span",{class:"text-base mb-2 font-medium"},"Total Penalty")],-1)),t("div",Tt,[(u(!0),f(M,null,z(j.drivers,(E,w)=>(u(),f("div",{key:w,class:"flex justify-between items-center"},[t("span",Bt,g(E.driver_name),1),t("span",{class:"text-sm font-medium",style:vt({color:h(E.total_penalty)})},g(E.total_penalty),5)]))),128))])],64))]))}},Ft={class:"bg-background rounded-lg border shadow-sm p-2 md:p-4"},Mt={class:"text-base text-center font-semibold mb-4"},It={class:"h-64"},Lt={__name:"LineChart",props:{title:{type:String,default:"Acceptance Score"},chartData:{type:Object,default:()=>({labels:[],datasets:[]})},averageAcceptance:{type:Number,default:null}},setup(j){const s=j,h=F(null);let T=null;const I=()=>{if(T&&T.destroy(),!h.value)return;const E=h.value.getContext("2d"),w=[];s.chartData.datasets.forEach(D=>{D.data&&D.data.length&&w.push(...D.data)});const C=w.length>0?Math.min(...w):0,B=w.length>0?Math.max(...w):100;T=new bt(E,{type:"line",data:s.chartData,options:{responsive:!0,maintainAspectRatio:!1,layout:{padding:{left:15,right:15,top:10,bottom:10}},plugins:{legend:{position:!1},tooltip:{callbacks:{label:function(D){const i=D.raw||0,O=s.averageAcceptance||0,d=s.chartData.dateRangeLabel||"selected period",o=Number(O).toFixed(2);return[`Acceptance Score: ${i}`,`Average Score Over ${d}: ${o}`]}}}},scales:{y:{beginAtZero:!(C>10),min:Math.max(Math.floor(C-5),0),max:Math.min(102.5,Math.ceil(B+5)),ticks:{stepSize:2.5,padding:10,font:{size:11},callback:function(D){return D<=100?D:""}},grid:{drawBorder:!0,color:"rgba(200, 200, 200, 0.2)"}},x:{ticks:{padding:10,font:{size:11}},grid:{drawBorder:!0,color:"rgba(200, 200, 200, 0.2)"}}}}})};return Je(()=>{I()}),de(()=>s.chartData,()=>{I()},{deep:!0}),(E,w)=>(u(),f("div",Ft,[t("h3",Mt,g(j.title),1),t("div",It,[t("canvas",{ref_key:"chartCanvas",ref:h},null,512)])]))}},Ut={class:"space-y-2 md:space-y-4 lg:space-y-6 mb-2 md:mb-4 lg:mb-6"},Et={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-2 md:gap-4"},Pt={class:"grid grid-cols-1 lg:grid-cols-4 gap-2 md:gap-4 lg:gap-6"},Ot={key:1,class:"bg-background rounded-lg border shadow-sm p-4 md:p-6 lg:col-span-3 md:col-span-2 transition-all duration-300 hover:shadow-md flex flex-col justify-center"},Wt={class:"flex flex-col sm:flex-row items-center justify-center sm:justify-around gap-3 mb-4"},Ht={class:"text-xs text-muted-foreground text-center mt-2"},Yt={key:2,class:"bg-background rounded-lg border shadow-sm p-4 md:p-6 lg:col-span-3 md:col-span-2 transition-all duration-300 hover:shadow-md flex flex-col justify-center items-center"},zt={class:"flex flex-col items-center justify-center gap-3 mb-4"},qt={__name:"AcceptanceDashboard",props:{metricsData:{type:Object,default:()=>({})},driversData:{type:Array,default:()=>[]},chartData:{type:Object,default:()=>({})},averageAcceptance:{type:Number,default:null},currentDateFilter:{type:String,default:null},currentFilters:{type:Object,default:()=>({})}},setup(j){const s=j,h=V(()=>{var v;if(!s.metricsData||!s.metricsData.totalRejections)return[];const y=(v=s.currentFilters)==null?void 0:v.rejectionType;return!y||y===""?[{title:"Total Rejected Stops",value:s.metricsData.totalRejections||0},{title:"Rejected In Advance",value:s.metricsData.advancedRejectionCount||0},{title:"Rejected +24 Hours Before Start Time",value:s.metricsData.moreThan24Count||0},{title:"Rejected Within 24 Hours Before Start Time",value:s.metricsData.within24Count||0},{title:"Rejected +6 Hours Before Start Time",value:s.metricsData.moreThan6Count||0},{title:"Rejected Within 6 Hours Before Start Time",value:s.metricsData.within6Count||0},{title:"Rejected After Start Time",value:s.metricsData.afterStartCount||0}]:y==="block"?[{title:"Total Block Rejections",value:s.metricsData.totalRejections||0},{title:"Rejected In Advance",value:s.metricsData.advancedRejectionCount||0},{title:"Rejected +24 Hours Before Start Time",value:s.metricsData.moreThan24Count||0},{title:"Rejected Within 24 Hours Before Start Time",value:s.metricsData.within24Count||0},{title:"Rejected After Start Time",value:s.metricsData.afterStartCount||0}]:y==="load"?[{title:"Total Load Rejections",value:s.metricsData.totalRejections||0},{title:"Rejected +6 Hours Before Start Time",value:s.metricsData.moreThan6Count||0},{title:"Rejected Within 6 Hours Before Start Time",value:s.metricsData.within6Count||0},{title:"Rejected After Start Time",value:s.metricsData.afterStartCount||0}]:[]}),T=V(()=>s.driversData&&s.driversData.length?s.driversData:[]),I=V(()=>s.chartData&&Object.keys(s.chartData).length?s.chartData:{}),E=V(()=>{var y;return((y=s.metricsData)==null?void 0:y.totalRejections)||0}),w=V(()=>{var y;return((y=s.currentFilters)==null?void 0:y.rejectionType)||null}),C=V(()=>!s.chartData||!s.chartData.labels?!1:s.chartData.labels.length>1),B=V(()=>{var y,v,ne,P;return((P=(ne=(v=(y=s.chartData)==null?void 0:y.datasets)==null?void 0:v[0])==null?void 0:ne.data)==null?void 0:P.length)>0}),D=V(()=>B.value?s.chartData.datasets[0].data[0]:0),i=V(()=>{const y=D.value;return y>=98?"fantastic_plus":y>=95?"fantastic":y>=90?"good":y>=85?"fair":"poor"}),O=y=>y==null?"0%":`${Math.round(parseFloat(y))}%`,d=y=>{if(!y)return"Not Available";switch(y){case"fantastic_plus":return"Fantastic +";case"fantastic":return"Fantastic";case"good":return"Good";case"fair":return"Fair";case"poor":return"Poor";default:return y}},o=y=>{if(!y)return"outline";switch(y){case"fantastic_plus":return"fantastic-plus";case"fantastic":return"fantastic";case"good":return"good";case"fair":return"fair";case"poor":return"poor";default:return"outline"}},b=y=>{if(!y)return"text-gray-600";switch(y){case"fantastic_plus":return"text-green-600";case"fantastic":return"text-emerald-600";case"good":return"text-blue-600";case"fair":return"text-amber-600";case"poor":return"text-red-600";default:return"text-indigo-600"}},J=y=>{if(!y)return"";switch(y){case"fantastic_plus":return"Outstanding performance with exceptional acceptance rate";case"fantastic":return"Excellent performance with very high acceptance rate";case"good":return"Solid performance with good acceptance rate";case"fair":return"Acceptable performance with room for improvement";case"poor":return"Performance needs significant improvement";default:return""}};return(y,v)=>(u(),f("div",Ut,[t("div",Et,[(u(!0),f(M,null,z(h.value,(ne,P)=>(u(),$(Dt,{key:P,title:ne.title,value:ne.value,class:"transition-all duration-300 hover:shadow-md"},null,8,["title","value"]))),128))]),t("div",Pt,[r(Nt,{title:"Bottom 5 Drivers",drivers:T.value,"total-rejections":E.value,"rejection-type":w.value,class:K({"lg:col-span-1":C.value,"lg:col-span-1 md:col-span-1":!C.value,"transition-all duration-300 hover:shadow-md":!0})},null,8,["drivers","total-rejections","rejection-type","class"]),s.currentDateFilter!="Yesterday"&&C.value?(u(),$(Lt,{key:0,title:"Acceptance Score",chartData:I.value,averageAcceptance:j.averageAcceptance,class:"lg:col-span-3 md:col-span-2 transition-all duration-300 hover:shadow-md"},null,8,["chartData","averageAcceptance"])):_("",!0),!C.value&&B.value?(u(),f("div",Ot,[v[0]||(v[0]=t("h3",{class:"text-base md:text-lg text-center font-semibold mb-4"},"Acceptance Score",-1)),t("div",Wt,[t("div",{class:K(["text-4xl md:text-5xl font-bold text-center",b(i.value)])},g(O(D.value)),3),r(a(wt),{variant:o(i.value),class:"text-xs md:text-sm px-3 py-1"},{default:n(()=>[c(g(d(i.value)),1)]),_:1},8,["variant"])]),t("p",Ht,g(J(i.value)),1)])):_("",!0),B.value?_("",!0):(u(),f("div",Yt,[v[3]||(v[3]=t("h3",{class:"text-base md:text-lg text-center font-semibold mb-4"},"Acceptance Score",-1)),t("div",zt,[r(H,{name:"chart_bar",class:"h-16 w-16 text-muted-foreground/50"}),v[1]||(v[1]=t("div",{class:"text-lg font-medium text-center text-primary"}," No data available ",-1)),v[2]||(v[2]=t("p",{class:"text-sm text-primary/70 text-center max-w-md"}," There is no acceptance data available for the selected time period. Try selecting a different date range or check back later. ",-1))])]))])]))}},Gt={class:"flex items-center gap-2"},Kt={class:"flex-1 overflow-y-auto px-4 sm:px-6 py-4 space-y-5"},Qt={key:0,class:"space-y-2"},Xt=["disabled"],Zt=["value"],Jt={key:0,class:"text-xs text-amber-600 dark:text-amber-400 flex items-center gap-1"},el={class:"text-sm font-semibold flex items-center gap-2"},tl={class:"flex h-5 w-5 items-center justify-center rounded-full bg-primary text-[11px] font-bold text-primary-foreground"},ll={class:"grid grid-cols-1 sm:grid-cols-2 gap-3"},al=["value","disabled"],rl={class:"space-y-0.5"},nl={class:"text-sm font-medium"},ol={class:"text-xs text-muted-foreground"},sl={class:"space-y-2"},il={class:"text-sm font-semibold flex items-center gap-2"},ul={class:"flex h-5 w-5 items-center justify-center rounded-full bg-primary text-[11px] font-bold text-primary-foreground"},dl={key:0,class:"rounded-md border p-3 bg-muted/10 space-y-1"},cl={class:"cursor-pointer inline-flex items-center gap-2 text-sm text-primary hover:underline mt-1"},ml=["disabled"],pl={key:1,class:"rounded-md border border-amber-300 bg-amber-50 dark:bg-amber-900/10 p-3 text-xs text-amber-700 dark:text-amber-300"},fl={class:"cursor-pointer mt-3"},vl=["disabled"],bl={key:0,class:"mt-2 text-xs text-muted-foreground"},gl={class:"font-medium text-foreground"},_l={key:1,class:"text-xs text-muted-foreground mt-2"},xl={key:2,class:"flex items-center justify-center gap-2 py-4"},yl={key:0,class:"rounded-md border border-primary/30 bg-primary/5 px-3 py-2 text-xs text-primary flex items-center gap-2"},kl={class:"font-semibold ml-1"},wl={key:1,class:"rounded-lg border p-3"},jl={class:"flex items-center justify-between mb-2"},Sl={class:"text-xs text-muted-foreground"},hl={class:"flex flex-wrap gap-2"},Cl={class:"grid grid-cols-3 gap-4"},$l={class:"text-2xl font-bold"},Dl={class:"text-2xl font-bold text-green-600"},Vl={class:"text-2xl font-bold text-red-600"},Al={key:4},Rl={class:"flex items-center justify-between mb-3"},Tl={class:"text-base font-semibold text-red-600 flex items-center gap-2"},Bl={class:"border rounded-lg overflow-hidden"},Nl={class:"max-h-72 overflow-y-auto"},Fl={class:"flex flex-wrap gap-x-3 gap-y-1"},Ml={class:"font-medium text-foreground"},Il={key:5},Ll={class:"text-base font-semibold text-green-600 flex items-center gap-2 mb-3"},Ul={class:"border rounded-lg overflow-hidden"},El={class:"flex flex-wrap gap-x-3 gap-y-1"},Pl={class:"font-medium"},Ol={class:"flex justify-start"},Wl={class:"border-t px-4 sm:px-6 py-4 flex items-center justify-between gap-3 bg-background"},Hl={class:"text-xs text-muted-foreground"},Yl={key:0},zl={class:"font-medium"},ql={class:"font-medium"},Gl={class:"flex gap-3"},Kl={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"},Ql=Te({__name:"ImportRejectionModal",props:{open:{type:Boolean,default:!1},isSuperAdmin:{type:Boolean,default:!1},tenantSlug:{type:String,default:null},tenants:{type:Array,default:()=>[]}},emits:["update:open","success","error"],setup(j,{emit:s}){const h=j,T=s,I=V({get:()=>h.open,set:k=>T("update:open",k)}),E=[{value:"advanced_block",label:"Advanced Block",description:"Import advanced block rejections from a weekly block schedule CSV."},{value:"block",label:"Block",description:"Import rejected blocks from a block acceptance status CSV."},{value:"load",label:"Load",description:"Import rejected loads from a load status CSV."},{value:"load_with_trips",label:"Load + Trips",description:"Import rejected loads and attach a Trips CSV to auto-fill driver names."},{value:"trips_only",label:"Trips Only",description:"Upload a Trips CSV to update driver names on existing load rejections."}],w=F(null),C=F(""),B=F(null),D=F(null),i=F(null),O=F(!1),d=F(!1),o=F(!1),b=F(null),J=F(null);let y=0;const v=yt(),ne=V(()=>{var k;return((k=E.find(m=>m.value===C.value))==null?void 0:k.label)??""}),P=V(()=>{var k;return!h.isSuperAdmin||!w.value?"":((k=h.tenants.find(m=>m.id===w.value))==null?void 0:k.name)??""});V(()=>"/storage/upload-data-temps/Rejections Template.csv");const Q=V(()=>{var k,m;return!i.value||i.value.header_error||h.isSuperAdmin&&!w.value?!1:i.value.trips_only?!0:(((k=i.value.summary)==null?void 0:k.valid)??0)>0&&(((m=i.value.summary)==null?void 0:m.invalid)??0)===0}),le={advanced_block:{validate:"acceptance.validateAdvancedBlockImport",confirm:"acceptance.confirmAdvancedBlockImport"},block:{validate:"acceptance.validateBlockImport",confirm:"acceptance.confirmBlockImport"},load:{validate:"acceptance.validateLoadImport",confirm:"acceptance.confirmLoadImport"},load_with_trips:{validate:"acceptance.validateLoadImport",confirm:"acceptance.confirmLoadImport"},trips_only:{validate:"acceptance.validateLoadImport",confirm:"acceptance.confirmLoadImport"}};function ce(k){var ae;const m=(ae=le[C.value])==null?void 0:ae[k];if(!m)throw new Error(`No route for type: ${C.value}`);const N=h.isSuperAdmin?`${m}.admin`:m,ee=h.isSuperAdmin?{}:{tenantSlug:h.tenantSlug};return route(N,ee)}function me(){B.value=null,D.value=null,i.value=null,O.value=!1,o.value=!1,y=0,b.value&&(b.value.value=""),J.value&&(J.value.value="")}function xe(k){var N;const m=(N=k.target.files)==null?void 0:N[0];m&&we(m),k.target.value=""}function ie(k){var m;D.value=((m=k.target.files)==null?void 0:m[0])??null}function pe(){y++,o.value=!0}function fe(){o.value=!0}function Be(){y--,y<=0&&(y=0,o.value=!1)}function ye(k){var N,ee;y=0,o.value=!1;const m=(ee=(N=k.dataTransfer)==null?void 0:N.files)==null?void 0:ee[0];m&&we(m)}function we(k){if(!(k.type==="text/csv"||k.name.toLowerCase().endsWith(".csv"))){T("error","Please upload a valid CSV file.");return}B.value=k,O.value=!0;const N=new FormData;h.isSuperAdmin&&w.value&&N.append("tenant_id",String(w.value)),C.value==="trips_only"?N.append("trips_file",k):(N.append("file",k),C.value==="load_with_trips"&&D.value&&N.append("trips_file",D.value)),Fe.post(ce("validate"),N,{forceFormData:!0,preserveScroll:!0,onFinish:()=>{O.value=!1},onError:()=>{O.value=!1,T("error","Failed to validate CSV.")}})}function oe(){d.value=!0;const k={};h.isSuperAdmin&&w.value&&(k.tenant_id=w.value),Fe.post(ce("confirm"),k,{preserveScroll:!0,onSuccess:()=>{var N,ee;const m=((ee=(N=i.value)==null?void 0:N.summary)==null?void 0:ee.valid)??0;T("success",`Successfully imported ${m} rejection(s) for ${P.value||"company"}.`),je()},onError:()=>T("error","Import failed. Please try again."),onFinish:()=>{d.value=!1}})}function Ne(){const k=h.isSuperAdmin?"acceptance.downloadErrorReport.admin":"acceptance.downloadErrorReport",m=h.isSuperAdmin?{}:{tenantSlug:h.tenantSlug};window.location.href=route(k,m)}function je(){I.value=!1}return de(I,k=>{k||(w.value=null,C.value="",B.value=null,D.value=null,i.value=null,O.value=!1,d.value=!1,o.value=!1,y=0)}),de(()=>{var k;return(k=v.props.flash)==null?void 0:k.importValidation},k=>{k&&(O.value=!1,k.results?(i.value={...k.results},k.header_error&&(i.value.header_error=k.header_error),k.trips_only&&(i.value.trips_only=!0)):k.message&&T("error",k.message))},{immediate:!0}),(k,m)=>(u(),$(a(Se),{open:I.value,"onUpdate:open":m[3]||(m[3]=N=>I.value=N)},{default:n(()=>[r(a(Ce),{class:"max-w-[95vw] sm:max-w-[90vw] md:max-w-5xl max-h-[90vh] overflow-hidden flex flex-col"},{default:n(()=>{var N,ee,ae;return[r(a($e),{class:"px-4 sm:px-6 border-b pb-3"},{default:n(()=>[t("div",Gt,[r(H,{name:"upload",class:"h-5 w-5 text-primary"}),r(a(De),{class:"text-lg sm:text-xl font-semibold"},{default:n(()=>m[4]||(m[4]=[c(" Import Rejections ")])),_:1})]),r(a(he),{class:"text-xs sm:text-sm mt-1 text-muted-foreground"},{default:n(()=>m[5]||(m[5]=[c(" Choose an import type, then upload your CSV file. The file will be validated before import. ")])),_:1})]),_:1}),t("div",Kt,[j.isSuperAdmin?(u(),f("div",Qt,[m[8]||(m[8]=t("p",{class:"text-sm font-semibold flex items-center gap-2"},[t("span",{class:"flex h-5 w-5 items-center justify-center rounded-full bg-primary text-[11px] font-bold text-primary-foreground"},"1"),c(" Select Company ")],-1)),X(t("select",{"onUpdate:modelValue":m[0]||(m[0]=A=>w.value=A),class:"select-base",disabled:O.value||d.value,onChange:me},[m[6]||(m[6]=t("option",{value:null,disabled:""},"— Choose a company —",-1)),(u(!0),f(M,null,z(j.tenants,A=>(u(),f("option",{key:A.id,value:A.id},g(A.name),9,Zt))),128))],40,Xt),[[te,w.value]]),w.value?_("",!0):(u(),f("p",Jt,[r(H,{name:"alert-triangle",class:"h-3 w-3"}),m[7]||(m[7]=c(" You must select a company before uploading a file. "))]))])):_("",!0),t("div",{class:K(["space-y-2",{"opacity-50 pointer-events-none":j.isSuperAdmin&&!w.value}])},[t("p",el,[t("span",tl,g(j.isSuperAdmin?"2":"1"),1),m[9]||(m[9]=c(" Import Type "))]),t("div",ll,[(u(),f(M,null,z(E,A=>t("label",{key:A.value,class:K(["flex items-start gap-3 rounded-md border p-3 cursor-pointer hover:bg-muted/20 transition-colors",C.value===A.value?"border-primary bg-primary/5":"border-border"])},[X(t("input",{type:"radio",class:"mt-1 accent-primary",value:A.value,"onUpdate:modelValue":m[1]||(m[1]=q=>C.value=q),disabled:O.value||d.value||j.isSuperAdmin&&!w.value,onChange:me},null,40,al),[[gt,C.value]]),t("div",rl,[t("div",nl,g(A.label),1),t("div",ol,g(A.description),1)])],2)),64))])],2),C.value&&!i.value&&(!j.isSuperAdmin||w.value)?(u(),f(M,{key:1},[t("div",sl,[t("p",il,[t("span",ul,g(j.isSuperAdmin?"3":"2"),1),m[10]||(m[10]=c(" Upload File "))])]),C.value==="load_with_trips"?(u(),f("div",dl,[m[11]||(m[11]=t("p",{class:"text-xs font-semibold text-muted-foreground uppercase tracking-wide"},"Optional: Trips file",-1)),m[12]||(m[12]=t("p",{class:"text-xs text-muted-foreground"}," Upload a Trips CSV alongside the Loads CSV to auto-populate driver names. ",-1)),t("label",cl,[r(H,{name:"file-plus",class:"h-4 w-4"}),c(" "+g(D.value?D.value.name:"Attach Trips CSV (optional)")+" ",1),t("input",{ref_key:"tripsFileInput",ref:J,type:"file",class:"hidden",accept:".csv,text/csv",onChange:ie,disabled:O.value},null,40,ml)]),D.value?(u(),f("button",{key:0,type:"button",onClick:m[2]||(m[2]=A=>D.value=null),class:"ml-2 text-xs text-red-500 hover:underline"}," Remove ")):_("",!0)])):_("",!0),C.value==="trips_only"?(u(),f("div",pl," This will upload a Trips CSV only to update driver names on existing load rejections. No new rejections will be created. ")):_("",!0),t("div",{class:K(["flex flex-col items-center justify-center border-2 border-dashed rounded-lg p-8 bg-muted/10 transition-colors",{"border-primary bg-primary/5":o.value,"opacity-60 pointer-events-none":O.value}]),onDragenter:be(pe,["prevent"]),onDragover:be(fe,["prevent"]),onDragleave:be(Be,["prevent"]),onDrop:be(ye,["prevent"])},[r(H,{name:"file-spreadsheet",class:"h-12 w-12 text-muted-foreground mb-3"}),m[15]||(m[15]=t("div",{class:"text-center"},[t("p",{class:"text-sm font-medium"},[t("span",{class:"text-primary"},"Drag & drop"),c(" your CSV here ")]),t("p",{class:"text-xs text-muted-foreground mt-1"},"or")],-1)),t("label",fl,[m[13]||(m[13]=t("span",{class:"text-sm font-medium text-primary hover:underline"},"Choose CSV file",-1)),t("input",{ref_key:"mainFileInput",ref:b,type:"file",class:"hidden",accept:".csv,text/csv",onChange:xe,disabled:O.value},null,40,vl)]),B.value?(u(),f("p",bl,[m[14]||(m[14]=c(" Selected: ")),t("span",gl,g(B.value.name),1)])):(u(),f("p",_l,"CSV files only"))],34),O.value?(u(),f("div",xl,m[16]||(m[16]=[t("div",{class:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary"},null,-1),t("span",{class:"text-sm text-muted-foreground"},"Validating CSV file...",-1)]))):_("",!0)],64)):_("",!0),i.value?(u(),f(M,{key:2},[j.isSuperAdmin&&w.value?(u(),f("div",yl,[r(H,{name:"building",class:"h-4 w-4 flex-shrink-0"}),m[17]||(m[17]=c(" Importing for: ")),t("span",kl,g(P.value),1)])):_("",!0),(N=i.value.headers)!=null&&N.length?(u(),f("div",wl,[t("div",jl,[m[18]||(m[18]=t("span",{class:"text-sm font-semibold"},"CSV Headers Detected",-1)),t("span",Sl,g(i.value.headers.length)+" columns",1)]),t("div",hl,[(u(!0),f(M,null,z(i.value.headers,A=>(u(),f("span",{key:A,class:"rounded-full bg-muted px-2 py-0.5 text-xs"},g(A),1))),128))])])):_("",!0),i.value.header_error?(u(),$(a(Ve),{key:2,variant:"destructive"},{default:n(()=>[r(a(Ae),null,{default:n(()=>m[19]||(m[19]=[c("Header Error")])),_:1}),r(a(Re),null,{default:n(()=>[c(g(i.value.header_error),1)]),_:1})]),_:1})):_("",!0),t("div",Cl,[r(a(ge),{class:"border-2"},{default:n(()=>[r(a(_e),{class:"p-4 text-center"},{default:n(()=>[t("div",$l,g(i.value.summary.total),1),m[20]||(m[20]=t("div",{class:"text-sm text-muted-foreground"},"Total Rows",-1))]),_:1})]),_:1}),r(a(ge),{class:"border-2 border-green-500/50 bg-green-50 dark:bg-green-900/10"},{default:n(()=>[r(a(_e),{class:"p-4 text-center"},{default:n(()=>[t("div",Dl,g(i.value.summary.valid),1),m[21]||(m[21]=t("div",{class:"text-sm text-muted-foreground"},"Valid",-1))]),_:1})]),_:1}),r(a(ge),{class:"border-2 border-red-500/50 bg-red-50 dark:bg-red-900/10"},{default:n(()=>[r(a(_e),{class:"p-4 text-center"},{default:n(()=>[t("div",Vl,g(i.value.summary.invalid),1),m[22]||(m[22]=t("div",{class:"text-sm text-muted-foreground"},"Invalid",-1))]),_:1})]),_:1})]),i.value.trips_only?(u(),$(a(Ve),{key:3,class:"border-amber-300 bg-amber-50 dark:bg-amber-900/10"},{default:n(()=>[r(a(Ae),{class:"text-amber-700 dark:text-amber-300"},{default:n(()=>m[23]||(m[23]=[c("Trips Only Mode")])),_:1}),r(a(Re),{class:"text-amber-600 dark:text-amber-400"},{default:n(()=>m[24]||(m[24]=[c(" Only driver names will be updated on existing load rejections. No new records will be created. ")])),_:1})]),_:1})):_("",!0),(ee=i.value.invalid)!=null&&ee.length?(u(),f("div",Al,[t("div",Rl,[t("h3",Tl,[r(H,{name:"alert-triangle",class:"h-5 w-5"}),c(" Validation Errors ("+g(i.value.invalid.length)+") ",1)]),r(U,{onClick:Ne,variant:"outline",size:"sm"},{default:n(()=>[r(H,{name:"download",class:"h-4 w-4 mr-1"}),m[25]||(m[25]=c(" Download Error Report "))]),_:1})]),t("div",Bl,[t("div",Nl,[r(a(Ie),null,{default:n(()=>[r(a(Le),{class:"sticky top-0 bg-background"},{default:n(()=>[r(a(ue),null,{default:n(()=>[r(a(se),{class:"w-20"},{default:n(()=>m[26]||(m[26]=[c("Row #")])),_:1}),r(a(se),null,{default:n(()=>m[27]||(m[27]=[c("Preview")])),_:1}),r(a(se),null,{default:n(()=>m[28]||(m[28]=[c("Errors")])),_:1})]),_:1})]),_:1}),r(a(Ue),null,{default:n(()=>[(u(!0),f(M,null,z(i.value.invalid,A=>(u(),$(a(ue),{key:A.rowNumber},{default:n(()=>[r(a(re),{class:"font-medium text-sm"},{default:n(()=>[c(g(A.rowNumber),1)]),_:2},1024),r(a(re),{class:"text-xs text-muted-foreground"},{default:n(()=>[t("div",Fl,[(u(!0),f(M,null,z(A.preview||[],q=>(u(),f("span",{key:q.key,class:"whitespace-nowrap"},[t("span",Ml,g(q.label)+":",1),c(" "+g(q.value),1)]))),128))])]),_:2},1024),r(a(re),null,{default:n(()=>[(u(!0),f(M,null,z(A.errors||[],(q,ve)=>(u(),f("div",{key:ve,class:"text-xs text-red-600"}," • "+g(q),1))),128))]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])])])):_("",!0),(ae=i.value.valid)!=null&&ae.length&&!i.value.trips_only?(u(),f("div",Il,[t("h3",Ll,[r(H,{name:"check-circle",class:"h-5 w-5"}),c(" Valid Rows Preview (first 5 of "+g(i.value.valid.length)+") ",1)]),t("div",Ul,[r(a(Ie),null,{default:n(()=>[r(a(Le),null,{default:n(()=>[r(a(ue),null,{default:n(()=>[r(a(se),{class:"w-20"},{default:n(()=>m[29]||(m[29]=[c("Row #")])),_:1}),r(a(se),null,{default:n(()=>m[30]||(m[30]=[c("Preview")])),_:1})]),_:1})]),_:1}),r(a(Ue),null,{default:n(()=>[(u(!0),f(M,null,z(i.value.valid.slice(0,5),A=>(u(),$(a(ue),{key:A.rowNumber},{default:n(()=>[r(a(re),{class:"font-medium text-sm"},{default:n(()=>[c(g(A.rowNumber),1)]),_:2},1024),r(a(re),{class:"text-xs"},{default:n(()=>[t("div",El,[(u(!0),f(M,null,z(A.preview||[],q=>(u(),f("span",{key:q.key,class:"whitespace-nowrap"},[t("span",Pl,g(q.label)+":",1),c(" "+g(q.value),1)]))),128))])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])])):_("",!0),t("div",Ol,[r(U,{onClick:me,variant:"ghost",size:"sm",class:"text-muted-foreground"},{default:n(()=>[r(H,{name:"rotate_ccw",class:"mr-2 h-4 w-4"}),m[31]||(m[31]=c(" Upload a different file "))]),_:1})])],64)):_("",!0)]),t("div",Wl,[t("div",Hl,[j.isSuperAdmin&&P.value?(u(),f("span",Yl,[m[32]||(m[32]=c(" Company: ")),t("span",zl,g(P.value),1)])):_("",!0),C.value?(u(),f("span",{key:1,class:K({"ml-3":j.isSuperAdmin&&P.value})},[m[33]||(m[33]=c(" Mode: ")),t("span",ql,g(ne.value),1)],2)):_("",!0)]),t("div",Gl,[r(U,{onClick:je,variant:"outline",disabled:d.value},{default:n(()=>m[34]||(m[34]=[c("Close")])),_:1},8,["disabled"]),Q.value?(u(),$(U,{key:0,onClick:oe,variant:"default",disabled:d.value},{default:n(()=>{var A,q,ve;return[d.value?(u(),f("div",Kl)):(u(),$(H,{key:1,name:"check",class:"h-4 w-4 mr-1"})),c(" "+g(d.value?"Importing...":(A=i.value)!=null&&A.trips_only?"Update Driver Names":`Import ${((ve=(q=i.value)==null?void 0:q.summary)==null?void 0:ve.valid)??0} Rows`),1)]}),_:1},8,["disabled"])):_("",!0)])])]}),_:1})]),_:1},8,["open"]))}}),Xl=Ee(Ql,[["__scopeId","data-v-4a4fe7fb"]]),Zl={key:0,class:"text-sm text-red-500"},W=Te({__name:"InputError",props:{message:{type:String,default:""}},setup(j){return(s,h)=>j.message?(u(),f("div",Zl,g(j.message),1)):_("",!0)}}),Jl={key:0,class:"col-span-full"},ea=["value"],ta={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},la={class:"flex gap-2 mt-1"},aa={key:1,class:"grid grid-cols-1 sm:grid-cols-2 gap-4 rounded-md border p-4"},ra={key:2,class:"grid grid-cols-1 sm:grid-cols-2 gap-4 rounded-md border p-4"},na={key:3,class:"grid grid-cols-1 sm:grid-cols-2 gap-4 rounded-md border p-4"},oa={class:"flex flex-col space-y-2 sm:space-y-0 sm:flex-row sm:justify-end sm:space-x-2 pt-4 border-t"},sa=Te({__name:"RejectionForm",props:{rejection:{type:Object,default:null},tenants:{type:Array,default:()=>[]},isSuperAdmin:{type:Boolean,default:!1},tenantSlug:{type:String,default:null}},emits:["close","success"],setup(j,{emit:s}){const h=j,T=s,I=[{value:"advanced_block",label:"Advanced Block"},{value:"block",label:"Block"},{value:"load",label:"Load"}];function E(d){return d&&d.type&&["advanced_block","block","load"].includes(d.type)?d.type:"block"}function w(d){return d?d.includes("T")?d.slice(0,16):d.replace(" ","T").slice(0,16):""}function C(d){return d?String(d).split("T")[0].split(" ")[0]:""}function B(d){return d===!0||d===1||d==="1"}function D(d){const o=E(d);return{id:(d==null?void 0:d.id)??null,tenant_id:(d==null?void 0:d.tenant_id)??null,date:C(d==null?void 0:d.date)??"",disputed:(d==null?void 0:d.disputed)??"none",carrier_controllable:B(d==null?void 0:d.carrier_controllable),driver_controllable:B(d==null?void 0:d.driver_controllable),rejection_reason:(d==null?void 0:d.rejection_reason)??"",type:o,advance_block_rejection_id:(d==null?void 0:d.advance_block_rejection_id)??"",week_start:C(d==null?void 0:d.week_start)??"",week_end:C(d==null?void 0:d.week_end)??"",impacted_blocks:(d==null?void 0:d.impacted_blocks)??"",expected_blocks:(d==null?void 0:d.expected_blocks)??"",block_id:(d==null?void 0:d.block_id)??"",block_driver_name:(d==null?void 0:d.block_driver_name)??"",block_start:w(d==null?void 0:d.block_start)??"",block_end:w(d==null?void 0:d.block_end)??"",rejection_datetime:w(d==null?void 0:d.rejection_datetime)??"",load_id:(d==null?void 0:d.load_id)??"",load_driver_name:(d==null?void 0:d.load_driver_name)??"",origin_yard_arrival:w(d==null?void 0:d.origin_yard_arrival)??"",load_rejection_bucket:(d==null?void 0:d.load_rejection_bucket)??""}}const i=Me(D(h.rejection));de(()=>h.rejection,d=>{const o=D(d);Object.keys(o).forEach(b=>{i[b]=o[b]}),i.clearErrors()},{immediate:!0});function O(){const d=!!i.id,o=h.isSuperAdmin?d?"acceptance.update.admin":"acceptance.store.admin":d?"acceptance.update":"acceptance.store",b=h.isSuperAdmin?d?{rejection:i.id}:{}:d?{tenantSlug:h.tenantSlug,rejection:i.id}:{tenantSlug:h.tenantSlug};i[d?"put":"post"](route(o,b),{preserveScroll:!0,onSuccess:()=>{T("success"),T("close")}})}return(d,o)=>(u(),f("form",{onSubmit:be(O,["prevent"]),class:"space-y-6"},[j.isSuperAdmin?(u(),f("div",Jl,[r(R,null,{default:n(()=>o[21]||(o[21]=[c("Company Name")])),_:1}),X(t("select",{"onUpdate:modelValue":o[0]||(o[0]=b=>a(i).tenant_id=b),class:"select-base"},[o[22]||(o[22]=t("option",{value:null,disabled:""},"Select Company",-1)),(u(!0),f(M,null,z(j.tenants,b=>(u(),f("option",{key:b.id,value:b.id},g(b.name),9,ea))),128))],512),[[te,a(i).tenant_id]]),r(W,{message:a(i).errors.tenant_id},null,8,["message"])])):_("",!0),t("div",null,[r(R,null,{default:n(()=>o[23]||(o[23]=[c("Date")])),_:1}),r(a(Y),{type:"date",modelValue:a(i).date,"onUpdate:modelValue":o[1]||(o[1]=b=>a(i).date=b),class:"w-full"},null,8,["modelValue"]),r(W,{message:a(i).errors.date},null,8,["message"])]),t("div",ta,[t("div",null,[r(R,{for:"disputed"},{default:n(()=>o[24]||(o[24]=[c("Disputed")])),_:1}),X(t("select",{id:"disputed","onUpdate:modelValue":o[2]||(o[2]=b=>a(i).disputed=b),class:"select-base"},o[25]||(o[25]=[t("option",{value:"none"},"None",-1),t("option",{value:"pending"},"Pending",-1),t("option",{value:"won"},"Won",-1),t("option",{value:"lost"},"Lost",-1)]),512),[[te,a(i).disputed]]),r(W,{message:a(i).errors.disputed},null,8,["message"])]),t("div",null,[r(R,{for:"carrier_controllable"},{default:n(()=>o[26]||(o[26]=[c("Carrier Controllable")])),_:1}),X(t("select",{id:"carrier_controllable","onUpdate:modelValue":o[3]||(o[3]=b=>a(i).carrier_controllable=b),class:"select-base"},o[27]||(o[27]=[t("option",{value:!0},"Yes",-1),t("option",{value:!1},"No",-1)]),512),[[te,a(i).carrier_controllable]]),r(W,{message:a(i).errors.carrier_controllable},null,8,["message"])]),t("div",null,[r(R,{for:"driver_controllable"},{default:n(()=>o[28]||(o[28]=[c("Driver Controllable")])),_:1}),X(t("select",{id:"driver_controllable","onUpdate:modelValue":o[4]||(o[4]=b=>a(i).driver_controllable=b),class:"select-base"},o[29]||(o[29]=[t("option",{value:!0},"Yes",-1),t("option",{value:!1},"No",-1)]),512),[[te,a(i).driver_controllable]]),r(W,{message:a(i).errors.driver_controllable},null,8,["message"])]),t("div",null,[r(R,{for:"rejection_reason"},{default:n(()=>o[30]||(o[30]=[c("Rejection Reason")])),_:1}),r(a(Y),{id:"rejection_reason",modelValue:a(i).rejection_reason,"onUpdate:modelValue":o[5]||(o[5]=b=>a(i).rejection_reason=b),placeholder:"Optional reason...",class:"w-full"},null,8,["modelValue"]),r(W,{message:a(i).errors.rejection_reason},null,8,["message"])])]),t("div",null,[r(R,null,{default:n(()=>o[31]||(o[31]=[c("Rejection Type")])),_:1}),t("div",la,[(u(),f(M,null,z(I,b=>r(U,{type:"button",key:b.value,variant:a(i).type===b.value?"default":"outline",size:"sm",onClick:J=>a(i).type=b.value},{default:n(()=>[c(g(b.label),1)]),_:2},1032,["variant","onClick"])),64))]),r(W,{message:a(i).errors.type},null,8,["message"])]),a(i).type==="advanced_block"?(u(),f("div",aa,[o[37]||(o[37]=t("p",{class:"col-span-full text-sm font-semibold text-muted-foreground"},"Advanced Block Details",-1)),t("div",null,[r(R,null,{default:n(()=>o[32]||(o[32]=[c("Advance Block Rejection ID")])),_:1}),r(a(Y),{modelValue:a(i).advance_block_rejection_id,"onUpdate:modelValue":o[6]||(o[6]=b=>a(i).advance_block_rejection_id=b),class:"w-full"},null,8,["modelValue"]),r(W,{message:a(i).errors.advance_block_rejection_id},null,8,["message"])]),t("div",null,[r(R,null,{default:n(()=>o[33]||(o[33]=[c("Week Start")])),_:1}),r(a(Y),{type:"date",modelValue:a(i).week_start,"onUpdate:modelValue":o[7]||(o[7]=b=>a(i).week_start=b),class:"w-full"},null,8,["modelValue"]),r(W,{message:a(i).errors.week_start},null,8,["message"])]),t("div",null,[r(R,null,{default:n(()=>o[34]||(o[34]=[c("Week End")])),_:1}),r(a(Y),{type:"date",modelValue:a(i).week_end,"onUpdate:modelValue":o[8]||(o[8]=b=>a(i).week_end=b),class:"w-full"},null,8,["modelValue"]),r(W,{message:a(i).errors.week_end},null,8,["message"])]),t("div",null,[r(R,null,{default:n(()=>o[35]||(o[35]=[c("Impacted Blocks")])),_:1}),r(a(Y),{type:"number",min:"0",modelValue:a(i).impacted_blocks,"onUpdate:modelValue":o[9]||(o[9]=b=>a(i).impacted_blocks=b),class:"w-full"},null,8,["modelValue"]),r(W,{message:a(i).errors.impacted_blocks},null,8,["message"])]),t("div",null,[r(R,null,{default:n(()=>o[36]||(o[36]=[c("Expected Blocks")])),_:1}),r(a(Y),{type:"number",min:"0",modelValue:a(i).expected_blocks,"onUpdate:modelValue":o[10]||(o[10]=b=>a(i).expected_blocks=b),class:"w-full"},null,8,["modelValue"]),r(W,{message:a(i).errors.expected_blocks},null,8,["message"])])])):_("",!0),a(i).type==="block"?(u(),f("div",ra,[o[43]||(o[43]=t("p",{class:"col-span-full text-sm font-semibold text-muted-foreground"},"Block Details",-1)),t("div",null,[r(R,null,{default:n(()=>o[38]||(o[38]=[c("Block ID")])),_:1}),r(a(Y),{modelValue:a(i).block_id,"onUpdate:modelValue":o[11]||(o[11]=b=>a(i).block_id=b),class:"w-full"},null,8,["modelValue"]),r(W,{message:a(i).errors.block_id},null,8,["message"])]),t("div",null,[r(R,null,{default:n(()=>o[39]||(o[39]=[c("Driver Name")])),_:1}),r(a(Y),{modelValue:a(i).block_driver_name,"onUpdate:modelValue":o[12]||(o[12]=b=>a(i).block_driver_name=b),class:"w-full"},null,8,["modelValue"]),r(W,{message:a(i).errors.block_driver_name},null,8,["message"])]),t("div",null,[r(R,null,{default:n(()=>o[40]||(o[40]=[c("Block Start")])),_:1}),r(a(Y),{type:"datetime-local",modelValue:a(i).block_start,"onUpdate:modelValue":o[13]||(o[13]=b=>a(i).block_start=b),class:"w-full"},null,8,["modelValue"]),r(W,{message:a(i).errors.block_start},null,8,["message"])]),t("div",null,[r(R,null,{default:n(()=>o[41]||(o[41]=[c("Block End")])),_:1}),r(a(Y),{type:"datetime-local",modelValue:a(i).block_end,"onUpdate:modelValue":o[14]||(o[14]=b=>a(i).block_end=b),class:"w-full"},null,8,["modelValue"]),r(W,{message:a(i).errors.block_end},null,8,["message"])]),t("div",null,[r(R,null,{default:n(()=>o[42]||(o[42]=[c("Rejection Date/Time")])),_:1}),r(a(Y),{type:"datetime-local",modelValue:a(i).rejection_datetime,"onUpdate:modelValue":o[15]||(o[15]=b=>a(i).rejection_datetime=b),class:"w-full"},null,8,["modelValue"]),r(W,{message:a(i).errors.rejection_datetime},null,8,["message"])])])):_("",!0),a(i).type==="load"?(u(),f("div",na,[o[49]||(o[49]=t("p",{class:"col-span-full text-sm font-semibold text-muted-foreground"},"Load Details",-1)),t("div",null,[r(R,null,{default:n(()=>o[44]||(o[44]=[c("Load ID")])),_:1}),r(a(Y),{modelValue:a(i).load_id,"onUpdate:modelValue":o[16]||(o[16]=b=>a(i).load_id=b),class:"w-full"},null,8,["modelValue"]),r(W,{message:a(i).errors.load_id},null,8,["message"])]),t("div",null,[r(R,null,{default:n(()=>o[45]||(o[45]=[c("Driver Name")])),_:1}),r(a(Y),{modelValue:a(i).load_driver_name,"onUpdate:modelValue":o[17]||(o[17]=b=>a(i).load_driver_name=b),class:"w-full"},null,8,["modelValue"]),r(W,{message:a(i).errors.load_driver_name},null,8,["message"])]),t("div",null,[r(R,null,{default:n(()=>o[46]||(o[46]=[c("Origin Yard Arrival")])),_:1}),r(a(Y),{type:"datetime-local",modelValue:a(i).origin_yard_arrival,"onUpdate:modelValue":o[18]||(o[18]=b=>a(i).origin_yard_arrival=b),class:"w-full"},null,8,["modelValue"]),r(W,{message:a(i).errors.origin_yard_arrival},null,8,["message"])]),t("div",null,[r(R,null,{default:n(()=>o[47]||(o[47]=[c("Load Rejection Bucket")])),_:1}),X(t("select",{"onUpdate:modelValue":o[19]||(o[19]=b=>a(i).load_rejection_bucket=b),class:"select-base"},o[48]||(o[48]=[t("option",{value:""},"— Select —",-1),t("option",{value:"rejected_after_start_time"},"After Start Time",-1),t("option",{value:"rejected_0_6_hours_before_start_time"},"0–6 Hours Before Start",-1),t("option",{value:"rejected_6_plus_hours_before_start_time"},"6+ Hours Before Start",-1)]),512),[[te,a(i).load_rejection_bucket]]),r(W,{message:a(i).errors.load_rejection_bucket},null,8,["message"])])])):_("",!0),t("div",oa,[r(U,{type:"button",onClick:o[20]||(o[20]=b=>T("close")),variant:"outline",class:"w-full sm:w-auto"},{default:n(()=>o[50]||(o[50]=[c(" Cancel ")])),_:1}),r(U,{type:"submit",disabled:a(i).processing,class:"w-full sm:w-auto"},{default:n(()=>[c(g(a(i).id?"Update":"Create"),1)]),_:1},8,["disabled"])])],32))}}),ia=Ee(sa,[["__scopeId","data-v-bf916ea7"]]),ua={class:"w-full md:max-w-2xl lg:max-w-3xl xl:max-w-6xl lg:mx-auto m-0 p-2 md:p-4 lg:p-6 space-y-2 md:space-y-4 lg:space-y-6"},da={class:"mb-2 flex flex-col items-center justify-between px-2 sm:flex-row md:mb-4 lg:mb-6"},ca={class:"flex flex-wrap gap-3 ml-3"},ma=["action"],pa={class:"flex flex-col items-center gap-2 md:items-start"},fa={class:"flex flex-wrap gap-1 md:gap-2"},va={key:0,class:"text-sm text-muted-foreground"},ba={key:0},ga={key:1},_a={key:2},xa={key:3,class:"ml-1"},ya={class:"flex items-center justify-between"},ka={class:"flex items-center gap-3 flex-wrap"},wa={class:"flex items-center rounded-lg border border-input bg-muted p-0.5 gap-0.5"},ja={key:0,class:"flex flex-wrap gap-2"},Sa={key:0,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold"},ha={key:1,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold"},Ca={key:2,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold"},$a={key:3,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold capitalize"},Da={key:4,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold"},Va={key:5,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold"},Aa={key:6,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold"},Ra={class:"flex flex-col gap-3 md:gap-4"},Ta={class:"grid w-full grid-cols-1 gap-3 sm:grid-cols-3 md:gap-4"},Ba={class:"grid w-full grid-cols-1 gap-3 sm:grid-cols-3 md:gap-4"},Na={class:"grid w-full grid-cols-1 gap-3 sm:grid-cols-2 md:gap-4"},Fa={class:"flex justify-end space-x-2"},Ma={class:"overflow-x-auto"},Ia={class:"flex items-center justify-center"},La=["checked"],Ua={class:"flex items-center gap-1"},Ea={key:0},Pa={key:0,class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Oa={key:1,class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Wa={key:1,class:"opacity-40"},Ha=["value"],Ya={class:"flex space-x-2"},za={key:0,class:"border-t bg-muted/20 px-4 py-3"},qa={class:"flex flex-col items-center justify-between gap-2 sm:flex-row"},Ga={class:"flex items-center gap-4 text-sm text-muted-foreground"},Ka={class:"flex items-center gap-2"},Qa=["value"],Xa={class:"flex flex-wrap"},Za=["innerHTML"],Ja={__name:"Index",props:{rejections:{type:Object,default:()=>({data:[],links:[],total:0})},tenantSlug:{type:String,default:null},tenants:{type:Array,default:()=>[]},isSuperAdmin:{type:Boolean,default:!1},dateFilter:{type:String,default:"yesterday"},dateRange:{type:Object,default:()=>({})},perPage:{type:Number,default:10},weekNumber:{type:Number,default:null},startWeekNumber:{type:Number,default:null},endWeekNumber:{type:Number,default:null},year:{type:Number,default:null},rejection_breakdown:{type:Object,default:null},line_chart_data:{type:Array,default:()=>[]},average_acceptance:{type:Number,default:null},filters:{type:Object,default:()=>({search:"",rejectionType:"",rejectionBucket:"",disputed:"",carrierControllable:"",driverControllable:"",penaltyMin:"",penaltyMax:"",rejectionReasonFilter:"with_reason"})},permissions:{type:Array,default:()=>[]}},setup(j){var We,He,Ye,ze,qe,Ge,Ke,Qe,Xe;const s=j,h=F(!1),T=F(null),I=F(""),E=F(""),w=F(s.dateFilter||"quarterly"),C=F(s.perPage||10),B=F([]),D=F(!1),i=F(!1),O=F(null),d=F(null),o=F(!1),b=F(!1),J=F("date"),y=F("desc"),v=F({search:((We=s.filters)==null?void 0:We.search)??"",rejectionType:((He=s.filters)==null?void 0:He.rejectionType)??"",rejectionBucket:((Ye=s.filters)==null?void 0:Ye.rejectionBucket)??"",disputed:((ze=s.filters)==null?void 0:ze.disputed)??"",carrierControllable:((qe=s.filters)==null?void 0:qe.carrierControllable)??"",driverControllable:((Ge=s.filters)==null?void 0:Ge.driverControllable)??"",penaltyMin:((Ke=s.filters)==null?void 0:Ke.penaltyMin)??"",penaltyMax:((Qe=s.filters)==null?void 0:Qe.penaltyMax)??"",rejectionReasonFilter:((Xe=s.filters)==null?void 0:Xe.rejectionReasonFilter)??"with_reason"}),ne=[{title:s.tenantSlug?"Dashboard":"Admin Dashboard",href:s.tenantSlug?route("dashboard",{tenantSlug:s.tenantSlug}):route("admin.dashboard")},{title:"Acceptance",href:s.tenantSlug?route("acceptance.index",{tenantSlug:s.tenantSlug}):route("acceptance.index.admin")}];function P(l){var e;return((e=l.advanced_rejected_block)==null?void 0:e[0])??null}function Q(l){var e;return((e=l.rejected_block)==null?void 0:e[0])??null}function le(l){var e;return((e=l.rejected_load)==null?void 0:e[0])??null}function ce(l){return P(l)?"advanced_block":le(l)?"load":Q(l)?"block":"unknown"}function me(l){return{advanced_block:"Advanced Block",block:"Block",load:"Load",unknown:"—"}[l]??l}function xe(l){return{more_than_24:"24+ hours before start",less_than_24:"Less than 24 hours before start",rejected_after_start_time:"Rejected after start time",rejected_0_6_hours_before_start_time:"Rejected 0–6 hours before start",rejected_6_plus_hours_before_start_time:"Rejected 6+ hours before start"}[l]??l??"—"}function ie(l){if(!l)return"—";const e=String(l).split(" ")[0],[S,p,L]=e.split("-");return!S||!p||!L?l:`${Number(p)}/${Number(L)}/${S}`}function pe(l){if(!l)return"—";try{return new Date(l).toLocaleString("en-US",{month:"numeric",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{return l}}const fe=[{key:"date",label:"Date",shared:!0,getValue:l=>ie(l.date)},{key:"type",label:"Type",shared:!0,getValue:l=>ce(l),render:l=>{const e=ce(l),S={advanced_block:"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300",block:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300",load:"bg-amber-100 text-amber-700 dark:bg-amber-900/30 dark:text-amber-300",unknown:"bg-muted text-muted-foreground"}[e]??"bg-muted text-muted-foreground";return Z("span",{class:`inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium ${S}`},me(e))}},{key:"penalty",label:"Penalty",shared:!0,getValue:l=>{const e=l.disputed==="won",S=l.driver_controllable===!0||l.driver_controllable===1||l.driver_controllable==="1"||l.driver_controllable==="true";return e&&S||e?0:l.penalty!=null?Number(l.penalty):null},render:l=>{const e=l.penalty!=null?Number(l.penalty).toFixed(2):null,S=l.disputed==="won",p=l.driver_controllable===!0||l.driver_controllable===1||l.driver_controllable==="1"||l.driver_controllable==="true";return!e&&!S?Z("span",{class:"text-muted-foreground"},"—"):S&&p?Z("div",{class:"flex flex-col leading-tight"},[Z("span",{class:"font-mono text-xs font-semibold text-green-600 dark:text-green-400"},"0.00"),Z("span",{class:"self-end text-[10px] opacity-60 font-mono whitespace-nowrap"},`Driver: ${e}`)]):S?Z("span",{class:"font-mono text-xs font-semibold text-green-600 dark:text-green-400"},"0.00"):Z("span",{class:"font-mono text-xs"},e)}},{key:"disputed",label:"Disputed",shared:!0,getValue:l=>l.disputed||null,render:l=>{const e={none:"bg-muted text-muted-foreground",pending:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-300",won:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300",lost:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300"}[l.disputed]??"bg-muted text-muted-foreground";return Z("span",{class:`inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium capitalize ${e}`},l.disputed||"none")}},{key:"carrier_controllable",label:"Carrier Ctrl.",shared:!0,getValue:l=>l.carrier_controllable!=null?l.carrier_controllable?"Yes":"No":null},{key:"driver_controllable",label:"Driver Ctrl.",shared:!0,getValue:l=>l.driver_controllable!=null?l.driver_controllable?"Yes":"No":null},{key:"rejection_reason",label:"Reason",shared:!0,getValue:l=>l.rejection_reason||null,render:l=>l.rejection_reason?Z("span",{class:"block max-w-[180px] truncate",title:l.rejection_reason},l.rejection_reason):Z("span",{class:"text-muted-foreground"},"—")},{key:"ab_rejection_id",label:"Adv. Rejection ID",shared:!1,getValue:l=>{var e;return((e=P(l))==null?void 0:e.advance_block_rejection_id)??null}},{key:"ab_week_start",label:"Week Start",shared:!1,getValue:l=>{var e;return(e=P(l))!=null&&e.week_start?ie(P(l).week_start):null}},{key:"ab_week_end",label:"Week End",shared:!1,getValue:l=>{var e;return(e=P(l))!=null&&e.week_end?ie(P(l).week_end):null}},{key:"ab_impacted_blocks",label:"Impacted Blocks",shared:!1,getValue:l=>{var e;return((e=P(l))==null?void 0:e.impacted_blocks)!=null?String(P(l).impacted_blocks):null}},{key:"ab_expected_blocks",label:"Expected Blocks",shared:!1,getValue:l=>{var e;return((e=P(l))==null?void 0:e.expected_blocks)!=null?String(P(l).expected_blocks):null}},{key:"b_block_id",label:"Block ID",shared:!1,getValue:l=>{var e;return((e=Q(l))==null?void 0:e.block_id)??null}},{key:"b_driver_name",label:"Driver Name",shared:!1,getValue:l=>{var e;return((e=Q(l))==null?void 0:e.driver_name)??null}},{key:"b_block_start",label:"Block Start",shared:!1,getValue:l=>{var e;return(e=Q(l))!=null&&e.block_start?pe(Q(l).block_start):null}},{key:"b_block_end",label:"Block End",shared:!1,getValue:l=>{var e;return(e=Q(l))!=null&&e.block_end?pe(Q(l).block_end):null}},{key:"b_rejection_datetime",label:"Rejection Time",shared:!1,getValue:l=>{var e;return(e=Q(l))!=null&&e.rejection_datetime?pe(Q(l).rejection_datetime):null}},{key:"b_rejection_bucket",label:"Bucket",shared:!1,getValue:l=>{var e;return(e=Q(l))!=null&&e.rejection_bucket?xe(Q(l).rejection_bucket):null}},{key:"l_load_id",label:"Load ID",shared:!1,getValue:l=>{var e;return((e=le(l))==null?void 0:e.load_id)??null}},{key:"l_driver_name",label:"Driver Name",shared:!1,getValue:l=>{var e;return((e=le(l))==null?void 0:e.driver_name)??null}},{key:"l_origin_yard_arrival",label:"Yard Arrival",shared:!1,getValue:l=>{var e;return(e=le(l))!=null&&e.origin_yard_arrival?pe(le(l).origin_yard_arrival):null}},{key:"l_rejection_bucket",label:"Bucket",shared:!1,getValue:l=>{var e;return(e=le(l))!=null&&e.rejection_bucket?xe(le(l).rejection_bucket):null}}],Be=Te({props:{col:String,rejection:Object},setup(l){return()=>{const e=fe.find(p=>p.key===l.col);if(!e)return Z("span",{class:"text-muted-foreground"},"—");if(e.render)return e.render(l.rejection);const S=e.getValue(l.rejection);return S?Z("span",{},S):Z("span",{class:"text-muted-foreground"},"—")}}}),ye=V(()=>{const l=oe.value;return l.length?fe.filter(e=>e.shared?!0:l.some(S=>{const p=e.getValue(S);return p!==null&&p!==""&&p!=="—"})):fe.filter(e=>e.shared)}),we=V(()=>{let l=ye.value.length;return s.isSuperAdmin&&(l+=1),G.value.includes("acceptance.delete")&&(l+=1),(G.value.includes("acceptance.update")||G.value.includes("acceptance.delete"))&&(l+=1),l}),oe=V(()=>[...s.rejections.data??[]].sort((e,S)=>{const p=fe.find(ft=>ft.key===J.value),L=p?p.getValue(e)??"":"",x=p?p.getValue(S)??"":"";if(L==="—"||L==="")return 1;if(x==="—"||x==="")return-1;const ke=String(L).toLowerCase()<String(x).toLowerCase()?-1:String(L).toLowerCase()>String(x).toLowerCase()?1:0;return y.value==="asc"?ke:-ke}));function Ne(l){J.value===l?y.value=y.value==="asc"?"desc":"asc":(J.value=l,y.value="asc")}const je=V(()=>{var p,L;if(!T.value)return null;const l=T.value,e=ce(l),S={id:l.id,tenant_id:l.tenant_id,date:l.date,disputed:l.disputed??"none",carrier_controllable:l.carrier_controllable,driver_controllable:l.driver_controllable,rejection_reason:l.rejection_reason??"",penalty:l.penalty,type:e};if(e==="advanced_block"){const x=P(l);return{...S,advance_block_rejection_id:(x==null?void 0:x.advance_block_rejection_id)??"",week_start:((p=x==null?void 0:x.week_start)==null?void 0:p.split(" ")[0])??"",week_end:((L=x==null?void 0:x.week_end)==null?void 0:L.split(" ")[0])??"",impacted_blocks:(x==null?void 0:x.impacted_blocks)??"",expected_blocks:(x==null?void 0:x.expected_blocks)??""}}if(e==="block"){const x=Q(l);return{...S,block_id:(x==null?void 0:x.block_id)??"",block_driver_name:(x==null?void 0:x.driver_name)??"",block_start:(x==null?void 0:x.block_start)??"",block_end:(x==null?void 0:x.block_end)??"",rejection_datetime:(x==null?void 0:x.rejection_datetime)??""}}if(e==="load"){const x=le(l);return{...S,load_id:(x==null?void 0:x.load_id)??"",load_driver_name:(x==null?void 0:x.driver_name)??"",origin_yard_arrival:(x==null?void 0:x.origin_yard_arrival)??"",load_rejection_bucket:(x==null?void 0:x.rejection_bucket)??""}}return S}),k=V(()=>!!v.value.search||!!v.value.rejectionType||!!v.value.rejectionBucket||!!v.value.disputed||!!v.value.carrierControllable||!!v.value.driverControllable||!!v.value.penaltyMin||!!v.value.penaltyMax||v.value.rejectionReasonFilter!=="with_reason");V(()=>{const l=v.value.rejectionType,e=[{value:"rejected_after_start_time",label:"After Start Time"},{value:"rejected_0_6_hours_before_start_time",label:"0–6 Hours Before"},{value:"rejected_6_plus_hours_before_start_time",label:"6+ Hours Before"}],S=[{value:"less_than_24",label:"Less Than 24 Hours Before"},{value:"more_than_24",label:"24+ Hours Before"}];return l==="load"?e:l==="block"?S:[...e,...S]}),de(()=>v.value.rejectionType,()=>{v.value.rejectionBucket=""});function m(l){v.value.rejectionReasonFilter=l,N()}function N(l={}){const e=s.tenantSlug?"acceptance.index":"acceptance.index.admin",S=s.tenantSlug?{tenantSlug:s.tenantSlug}:{};return Fe.get(route(e,S),{...v.value,perPage:C.value,dateFilter:w.value,...l},{preserveState:!0,preserveScroll:!0})}function ee(){N()}function ae(l){w.value=l,N({dateFilter:l})}function A(){N()}function q(){v.value={search:"",rejectionType:"",rejectionBucket:"",disputed:"",carrierControllable:"",driverControllable:"",penaltyMin:"",penaltyMax:"",rejectionReasonFilter:"with_reason"},N()}function ve(l){if(!l)return;const e=new URL(l);N({page:e.searchParams.get("page")||1})}const Pe=V(()=>["yesterday","current-week"].includes(w.value)&&s.weekNumber&&s.year?`Week ${s.weekNumber}, ${s.year}`:["6w","quarterly"].includes(w.value)&&s.startWeekNumber&&s.endWeekNumber&&s.year?`Weeks ${s.startWeekNumber}–${s.endWeekNumber}, ${s.year}`:""),G=V(()=>s.permissions.map(l=>l.name));function Oe(l=null){T.value=l,h.value=!0}function et(){h.value=!1,E.value=T.value?"Rejection updated successfully.":"Rejection created successfully."}function tt(l){O.value=l,i.value=!0}function lt(l){const e=Me({}),S=s.isSuperAdmin?"acceptance.destroy.admin":"acceptance.destroy",p=s.isSuperAdmin?{rejection:l}:{tenantSlug:s.tenantSlug,rejection:l};e.delete(route(S,p),{preserveScroll:!0,onSuccess:()=>{E.value="Rejection deleted successfully.",i.value=!1}})}const at=V(()=>oe.value.length>0&&B.value.length===oe.value.length);function rt(l){B.value=l.target.checked?oe.value.map(e=>e.id):[]}function nt(){B.value.length>0&&(D.value=!0)}function ot(){const l=Me({ids:B.value}),e=s.isSuperAdmin?"acceptance.destroyBulk.admin":"acceptance.destroyBulk",S=s.isSuperAdmin?{}:{tenantSlug:s.tenantSlug};l.delete(route(e,S),{preserveScroll:!0,onSuccess:()=>{E.value=`${B.value.length} records deleted.`,B.value=[],D.value=!1}})}function st(l){E.value=l}function it(l){I.value=l}const ut=V(()=>s.tenantSlug?route("acceptance.export",{tenantSlug:s.tenantSlug}):route("acceptance.export.admin"));function dt(){if(!oe.value.length){I.value="No data to export.";return}d.value&&d.value.submit()}const ct=V(()=>{var e;const l=(e=s.rejection_breakdown)==null?void 0:e.by_category;return l?{totalRejections:l.total_rejections??0,afterStartCount:l.after_start_count??0,moreThan24Count:l.more_than_24_count??0,within24Count:l.within_24_count??0,advancedRejectionCount:l.advanced_rejection_count??0,moreThan6Count:l.more_than_6_count??0,within6Count:l.within_6_count??0}:null}),mt=V(()=>{var e,S,p,L,x,ke;const l=v.value.rejectionType;return l==="load"?((S=(e=s.rejection_breakdown)==null?void 0:e.bottom_five_drivers)==null?void 0:S.load)??[]:l==="block"?((L=(p=s.rejection_breakdown)==null?void 0:p.bottom_five_drivers)==null?void 0:L.block)??[]:((ke=(x=s.rejection_breakdown)==null?void 0:x.bottom_five_drivers)==null?void 0:ke.total)??[]}),pt=V(()=>{var l;return(l=s.line_chart_data)!=null&&l.length?{labels:s.line_chart_data.map(e=>e.date),datasets:[{label:"Acceptance Performance",data:s.line_chart_data.map(e=>e.acceptancePerformance),borderColor:"#3b82f6",backgroundColor:"rgba(59,130,246,0.1)",tension:.3}]}:{labels:[],datasets:[]}});return de(E,l=>{l&&setTimeout(()=>{E.value=""},5e3)}),de(I,l=>{l&&setTimeout(()=>{I.value=""},5e3)}),Je(()=>{const l=e=>e.preventDefault();window.addEventListener("dragover",l),window.addEventListener("drop",l),_t(()=>{window.removeEventListener("dragover",l),window.removeEventListener("drop",l)})}),(l,e)=>(u(),$(ht,{breadcrumbs:ne,tenantSlug:j.tenantSlug,permissions:s.permissions},{default:n(()=>{var S;return[r(a(kt),{title:"Acceptance"}),t("div",ua,[E.value?(u(),$(a(Ve),{key:0,variant:"success"},{default:n(()=>[r(a(Ae),null,{default:n(()=>e[31]||(e[31]=[c("Success")])),_:1}),r(a(Re),null,{default:n(()=>[c(g(E.value),1)]),_:1})]),_:1})):_("",!0),I.value?(u(),$(a(Ve),{key:1,variant:"destructive"},{default:n(()=>[r(a(Ae),null,{default:n(()=>e[32]||(e[32]=[c("Error")])),_:1}),r(a(Re),null,{default:n(()=>[c(g(I.value),1)]),_:1})]),_:1})):_("",!0),t("div",da,[e[36]||(e[36]=t("h1",{class:"text-lg font-bold text-gray-800 dark:text-gray-200 md:text-xl lg:text-2xl"}," Acceptance ",-1)),t("div",ca,[G.value.includes("acceptance.create")?(u(),$(U,{key:0,class:"px-2 py-0 md:px-4 md:py-2",onClick:e[0]||(e[0]=p=>Oe()),variant:"default"},{default:n(()=>[r(H,{name:"plus",class:"mr-1 h-4 w-4 md:mr-2"}),e[33]||(e[33]=c(" Add Rejection "))]),_:1})):_("",!0),B.value.length>0&&G.value.includes("acceptance.delete")?(u(),$(U,{key:1,class:"px-2 py-0 md:px-4 md:py-2",onClick:e[1]||(e[1]=p=>nt()),variant:"destructive"},{default:n(()=>[r(H,{name:"trash",class:"mr-1 h-4 w-4 md:mr-2"}),c(" Delete Selected ("+g(B.value.length)+") ",1)]),_:1})):_("",!0),G.value.includes("acceptance.import")?(u(),$(U,{key:2,variant:"secondary",class:"px-2 py-0 md:px-4 md:py-2 shadow-sm hover:shadow transition-all",onClick:e[2]||(e[2]=p=>b.value=!0)},{default:n(()=>[r(H,{name:"upload",class:"mr-1 h-4 w-4 md:mr-2"}),e[34]||(e[34]=c(" Import CSV "))]),_:1})):_("",!0),G.value.includes("acceptance.export")?(u(),$(U,{key:3,class:"px-2 py-0 md:px-4 md:py-2",onClick:be(dt,["prevent"]),variant:"outline"},{default:n(()=>[r(H,{name:"download",class:"mr-1 h-4 w-4 md:mr-2"}),e[35]||(e[35]=c(" Download CSV "))]),_:1})):_("",!0)])]),t("form",{ref_key:"exportForm",ref:d,action:ut.value,method:"GET",class:"hidden"},null,8,ma),r(a(ge),null,{default:n(()=>[r(a(_e),{class:"p-2 md:p-4 lg:p-6"},{default:n(()=>[t("div",pa,[t("div",fa,[r(U,{onClick:e[3]||(e[3]=p=>ae("yesterday")),variant:"outline",size:"sm",class:K({"border-primary bg-primary/10 text-primary":w.value==="yesterday"})},{default:n(()=>e[37]||(e[37]=[c(" Yesterday ")])),_:1},8,["class"]),r(U,{onClick:e[4]||(e[4]=p=>ae("current-week")),variant:"outline",size:"sm",class:K({"border-primary bg-primary/10 text-primary":w.value==="current-week"})},{default:n(()=>e[38]||(e[38]=[c(" WTD ")])),_:1},8,["class"]),r(U,{onClick:e[5]||(e[5]=p=>ae("6w")),variant:"outline",size:"sm",class:K({"border-primary bg-primary/10 text-primary":w.value==="6w"})},{default:n(()=>e[39]||(e[39]=[c(" T6W ")])),_:1},8,["class"]),r(U,{onClick:e[6]||(e[6]=p=>ae("quarterly")),variant:"outline",size:"sm",class:K({"border-primary bg-primary/10 text-primary":w.value==="quarterly"})},{default:n(()=>e[40]||(e[40]=[c(" Quarterly ")])),_:1},8,["class"])]),s.dateRange?(u(),f("div",va,[w.value==="yesterday"&&s.dateRange.start?(u(),f("span",ba," Showing data from "+g(ie(s.dateRange.start)),1)):s.dateRange.start&&s.dateRange.end?(u(),f("span",ga," Showing data from "+g(ie(s.dateRange.start))+" to "+g(ie(s.dateRange.end)),1)):(u(),f("span",_a,g(s.dateRange.label),1)),Pe.value?(u(),f("span",xa,"("+g(Pe.value)+")",1)):_("",!0)])):_("",!0)])]),_:1})]),_:1}),r(a(ge),{class:"mb-6"},{default:n(()=>[r(a(jt),{class:"p-2 md:p-4 lg:p-6"},{default:n(()=>[t("div",ya,[t("div",ka,[r(a(St),{class:"text-lg md:text-xl lg:text-2xl"},{default:n(()=>e[41]||(e[41]=[c("Filters")])),_:1}),t("div",wa,[t("button",{onClick:e[7]||(e[7]=p=>m("with_reason")),class:K(["rounded-md px-3 py-1 text-xs font-medium transition-all",v.value.rejectionReasonFilter==="with_reason"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"])}," Rejected ",2),t("button",{onClick:e[8]||(e[8]=p=>m("without_reason")),class:K(["rounded-md px-3 py-1 text-xs font-medium transition-all",v.value.rejectionReasonFilter==="without_reason"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"])}," Accepted ",2),t("button",{onClick:e[9]||(e[9]=p=>m("all")),class:K(["rounded-md px-3 py-1 text-xs font-medium transition-all",v.value.rejectionReasonFilter==="all"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"])}," All ",2)]),!o.value&&k.value?(u(),f("div",ja,[v.value.search?(u(),f("span",Sa," Search: "+g(v.value.search),1)):_("",!0),v.value.rejectionType?(u(),f("span",ha," Type: "+g(me(v.value.rejectionType)),1)):_("",!0),v.value.rejectionBucket?(u(),f("span",Ca," Bucket: "+g(xe(v.value.rejectionBucket)),1)):_("",!0),v.value.disputed?(u(),f("span",$a," Disputed: "+g(v.value.disputed),1)):_("",!0),v.value.carrierControllable?(u(),f("span",Da," Carrier: "+g(v.value.carrierControllable==="true"?"Yes":"No"),1)):_("",!0),v.value.driverControllable?(u(),f("span",Va," Driver: "+g(v.value.driverControllable==="true"?"Yes":"No"),1)):_("",!0),v.value.penaltyMin||v.value.penaltyMax?(u(),f("span",Aa," Penalty: "+g(v.value.penaltyMin||"0")+" – "+g(v.value.penaltyMax||"∞"),1)):_("",!0)])):_("",!0)]),r(U,{variant:"ghost",size:"sm",onClick:e[10]||(e[10]=p=>o.value=!o.value)},{default:n(()=>[c(g(o.value?"Hide Filters":"Show Filters")+" ",1),r(H,{name:o.value?"chevron-up":"chevron-down",class:"ml-2 h-4 w-4"},null,8,["name"])]),_:1})])]),_:1}),o.value?(u(),$(a(_e),{key:0,class:"p-2 md:p-4 lg:p-6"},{default:n(()=>[t("div",Ra,[t("div",Ta,[t("div",null,[r(a(R),{for:"search"},{default:n(()=>e[42]||(e[42]=[c("Search")])),_:1}),r(a(Y),{class:"h-9 w-full lg:h-10",id:"search",modelValue:v.value.search,"onUpdate:modelValue":e[11]||(e[11]=p=>v.value.search=p),type:"text",placeholder:"Driver name, Block ID, Load ID..."},null,8,["modelValue"])]),t("div",null,[r(a(R),{for:"rejectionType"},{default:n(()=>e[43]||(e[43]=[c("Rejection Type")])),_:1}),X(t("select",{id:"rejectionType","onUpdate:modelValue":e[12]||(e[12]=p=>v.value.rejectionType=p),class:"select-base",onChange:e[13]||(e[13]=p=>v.value.rejectionBucket="")},e[44]||(e[44]=[t("option",{value:""},"All Types",-1),t("option",{value:"advanced_block"},"Advanced Block",-1),t("option",{value:"block"},"Block",-1),t("option",{value:"load"},"Load",-1)]),544),[[te,v.value.rejectionType]])]),t("div",null,[r(a(R),{for:"rejectionBucket"},{default:n(()=>e[45]||(e[45]=[c("Rejection Bucket")])),_:1}),X(t("select",{id:"rejectionBucket","onUpdate:modelValue":e[14]||(e[14]=p=>v.value.rejectionBucket=p),class:"select-base"},[e[51]||(e[51]=t("option",{value:""},"All Buckets",-1)),v.value.rejectionType==="load"||v.value.rejectionType===""?(u(),f(M,{key:0},[e[46]||(e[46]=t("option",{value:"rejected_after_start_time"},"After Start Time",-1)),e[47]||(e[47]=t("option",{value:"rejected_0_6_hours_before_start_time"}," 0–6 Hours Before ",-1)),e[48]||(e[48]=t("option",{value:"rejected_6_plus_hours_before_start_time"}," 6+ Hours Before ",-1))],64)):_("",!0),v.value.rejectionType==="block"||v.value.rejectionType===""?(u(),f(M,{key:1},[e[49]||(e[49]=t("option",{value:"less_than_24"},"Less Than 24 Hours Before",-1)),e[50]||(e[50]=t("option",{value:"more_than_24"},"24+ Hours Before",-1))],64)):_("",!0)],512),[[te,v.value.rejectionBucket]])])]),t("div",Ba,[t("div",null,[r(a(R),{for:"disputed"},{default:n(()=>e[52]||(e[52]=[c("Disputed")])),_:1}),X(t("select",{id:"disputed","onUpdate:modelValue":e[15]||(e[15]=p=>v.value.disputed=p),class:"select-base"},e[53]||(e[53]=[t("option",{value:""},"All",-1),t("option",{value:"none"},"None",-1),t("option",{value:"pending"},"Pending",-1),t("option",{value:"won"},"Won",-1),t("option",{value:"lost"},"Lost",-1)]),512),[[te,v.value.disputed]])]),t("div",null,[r(a(R),{for:"carrierControllable"},{default:n(()=>e[54]||(e[54]=[c("Carrier Controllable")])),_:1}),X(t("select",{id:"carrierControllable","onUpdate:modelValue":e[16]||(e[16]=p=>v.value.carrierControllable=p),class:"select-base"},e[55]||(e[55]=[t("option",{value:""},"All",-1),t("option",{value:"true"},"Yes",-1),t("option",{value:"false"},"No",-1)]),512),[[te,v.value.carrierControllable]])]),t("div",null,[r(a(R),{for:"driverControllable"},{default:n(()=>e[56]||(e[56]=[c("Driver Controllable")])),_:1}),X(t("select",{id:"driverControllable","onUpdate:modelValue":e[17]||(e[17]=p=>v.value.driverControllable=p),class:"select-base"},e[57]||(e[57]=[t("option",{value:""},"All",-1),t("option",{value:"true"},"Yes",-1),t("option",{value:"false"},"No",-1)]),512),[[te,v.value.driverControllable]])])]),t("div",Na,[t("div",null,[r(a(R),{for:"penaltyMin"},{default:n(()=>e[58]||(e[58]=[c("Penalty Min")])),_:1}),r(a(Y),{class:"h-9 w-full lg:h-10",id:"penaltyMin",modelValue:v.value.penaltyMin,"onUpdate:modelValue":e[18]||(e[18]=p=>v.value.penaltyMin=p),type:"number",min:"0",placeholder:"e.g. 0"},null,8,["modelValue"])]),t("div",null,[r(a(R),{for:"penaltyMax"},{default:n(()=>e[59]||(e[59]=[c("Penalty Max")])),_:1}),r(a(Y),{class:"h-9 w-full lg:h-10",id:"penaltyMax",modelValue:v.value.penaltyMax,"onUpdate:modelValue":e[19]||(e[19]=p=>v.value.penaltyMax=p),type:"number",min:"0",placeholder:"e.g. 100"},null,8,["modelValue"])])]),t("div",Fa,[r(U,{onClick:q,variant:"ghost",size:"sm"},{default:n(()=>[r(H,{name:"rotate_ccw",class:"mr-2 h-4 w-4"}),e[60]||(e[60]=c(" Reset Filters "))]),_:1}),r(U,{onClick:ee,variant:"default",size:"sm"},{default:n(()=>[r(H,{name:"filter",class:"mr-2 h-4 w-4"}),e[61]||(e[61]=c(" Apply Filters "))]),_:1})])])]),_:1})):_("",!0)]),_:1}),s.isSuperAdmin?_("",!0):(u(),$(qt,{key:2,metricsData:ct.value||{},driversData:mt.value||[],chartData:pt.value||{},averageAcceptance:s.average_acceptance||null,currentDateFilter:((S=s.dateRange)==null?void 0:S.label)||"",currentFilters:v.value||{}},null,8,["metricsData","driversData","chartData","averageAcceptance","currentDateFilter","currentFilters"])),r(a(ge),{class:"mx-auto max-w-[95vw] overflow-x-auto md:max-w-[64vw] lg:max-w-full"},{default:n(()=>[r(a(_e),{class:"p-0"},{default:n(()=>[t("div",Ma,[r(a(Ie),{class:"relative h-[500px] overflow-auto"},{default:n(()=>[r(a(Le),null,{default:n(()=>[r(a(ue),{class:"sticky top-0 z-10 border-b bg-background hover:bg-background"},{default:n(()=>[G.value.includes("acceptance.delete")?(u(),$(a(se),{key:0,class:"w-[50px]"},{default:n(()=>[t("div",Ia,[t("input",{type:"checkbox",onChange:rt,checked:at.value,class:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"},null,40,La)])]),_:1})):_("",!0),s.isSuperAdmin?(u(),$(a(se),{key:1,class:"whitespace-nowrap"},{default:n(()=>e[62]||(e[62]=[c("Company")])),_:1})):_("",!0),(u(!0),f(M,null,z(ye.value,p=>(u(),$(a(se),{key:p.key,class:"cursor-pointer whitespace-nowrap",onClick:L=>Ne(p.key)},{default:n(()=>[t("div",Ua,[c(g(p.label)+" ",1),J.value===p.key?(u(),f("span",Ea,[y.value==="asc"?(u(),f("svg",Pa,e[63]||(e[63]=[t("path",{d:"M8 15l4-4 4 4"},null,-1)]))):(u(),f("svg",Oa,e[64]||(e[64]=[t("path",{d:"M16 9l-4 4-4-4"},null,-1)])))])):(u(),f("span",Wa,e[65]||(e[65]=[t("svg",{class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M8 10l4-4 4 4"}),t("path",{d:"M16 14l-4 4-4-4"})],-1)])))])]),_:2},1032,["onClick"]))),128)),G.value.includes("acceptance.update")||G.value.includes("acceptance.delete")?(u(),$(a(se),{key:2},{default:n(()=>e[66]||(e[66]=[c(" Actions ")])),_:1})):_("",!0)]),_:1})]),_:1}),r(a(Ue),null,{default:n(()=>[oe.value.length===0?(u(),$(a(ue),{key:0},{default:n(()=>[r(a(re),{colspan:we.value,class:"py-8 text-center text-primary font-medium"},{default:n(()=>e[67]||(e[67]=[c(" No rejections found matching your criteria ")])),_:1},8,["colspan"])]),_:1})):_("",!0),(u(!0),f(M,null,z(oe.value,p=>(u(),$(a(ue),{key:p.id,class:"hover:bg-muted/50"},{default:n(()=>[G.value.includes("acceptance.delete")?(u(),$(a(re),{key:0,class:"text-center"},{default:n(()=>[X(t("input",{type:"checkbox",value:p.id,"onUpdate:modelValue":e[20]||(e[20]=L=>B.value=L),class:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"},null,8,Ha),[[xt,B.value]])]),_:2},1024)):_("",!0),s.isSuperAdmin?(u(),$(a(re),{key:1,class:"whitespace-nowrap"},{default:n(()=>{var L;return[c(g(((L=p.tenant)==null?void 0:L.name)||"—"),1)]}),_:2},1024)):_("",!0),(u(!0),f(M,null,z(ye.value,L=>(u(),$(a(re),{key:L.key,class:"whitespace-nowrap text-sm"},{default:n(()=>[r(a(Be),{col:L.key,rejection:p},null,8,["col","rejection"])]),_:2},1024))),128)),G.value.includes("acceptance.delete")||G.value.includes("acceptance.update")?(u(),$(a(re),{key:2},{default:n(()=>[t("div",Ya,[G.value.includes("acceptance.update")?(u(),$(U,{key:0,size:"sm",onClick:L=>Oe(p),variant:"warning"},{default:n(()=>[r(H,{name:"pencil",class:"mr-1 h-4 w-4"}),e[68]||(e[68]=c(" Edit "))]),_:2},1032,["onClick"])):_("",!0),G.value.includes("acceptance.delete")?(u(),$(U,{key:1,size:"sm",variant:"destructive",onClick:L=>tt(p.id)},{default:n(()=>[r(H,{name:"trash",class:"mr-1 h-4 w-4"}),e[69]||(e[69]=c(" Delete "))]),_:2},1032,["onClick"])):_("",!0)])]),_:2},1024)):_("",!0)]),_:2},1024))),128))]),_:1})]),_:1})]),s.rejections.links?(u(),f("div",za,[t("div",qa,[t("div",Ga,[t("span",null," Showing "+g(s.rejections.data.length)+" of "+g(s.rejections.total)+" entries ",1),t("div",Ka,[e[70]||(e[70]=t("span",{class:"text-sm"},"Show:",-1)),X(t("select",{"onUpdate:modelValue":e[21]||(e[21]=p=>C.value=p),onChange:A,class:"h-8 rounded-md border border-input bg-background px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-ring"},[(u(),f(M,null,z([10,25,50,100],p=>t("option",{key:p,value:p},g(p),9,Qa)),64))],544),[[te,C.value]])])]),t("div",Xa,[(u(!0),f(M,null,z(s.rejections.links,p=>(u(),$(U,{key:p.label,onClick:L=>ve(p.url),disabled:!p.url,variant:"ghost",size:"sm",class:K(["mx-1",{"border-primary bg-primary/10 text-primary":p.active}])},{default:n(()=>[t("span",{innerHTML:p.label},null,8,Za)]),_:2},1032,["onClick","disabled","class"]))),128))])])])):_("",!0)]),_:1})]),_:1}),r(a(Se),{open:h.value,"onUpdate:open":e[23]||(e[23]=p=>h.value=p)},{default:n(()=>[r(a(Ce),{class:"max-w-[95vw] sm:max-w-[90vw] md:max-w-4xl"},{default:n(()=>[r(a($e),{class:"px-4 sm:px-6"},{default:n(()=>[r(a(De),{class:"text-lg sm:text-xl"},{default:n(()=>[c(g(T.value?"Edit":"Add")+" Rejection ",1)]),_:1}),r(a(he),{class:"text-xs sm:text-sm"},{default:n(()=>[c(" Fill in the details to "+g(T.value?"update":"add")+" a rejection. ",1)]),_:1})]),_:1}),r(ia,{rejection:je.value,tenants:s.tenants,"is-super-admin":s.isSuperAdmin,"tenant-slug":s.tenantSlug,onClose:e[22]||(e[22]=p=>h.value=!1),onSuccess:et,class:"max-h-[75vh] overflow-y-auto p-4 sm:p-6"},null,8,["rejection","tenants","is-super-admin","tenant-slug"])]),_:1})]),_:1},8,["open"]),r(a(Se),{open:D.value,"onUpdate:open":e[26]||(e[26]=p=>D.value=p)},{default:n(()=>[r(a(Ce),{class:"max-w-[95vw] sm:max-w-md"},{default:n(()=>[r(a($e),{class:"px-4 sm:px-6"},{default:n(()=>[r(a(De),{class:"text-lg sm:text-xl"},{default:n(()=>e[71]||(e[71]=[c("Confirm Bulk Deletion")])),_:1}),r(a(he),{class:"text-xs sm:text-sm"},{default:n(()=>[c(" Are you sure you want to delete "+g(B.value.length)+" rejection records? This action cannot be undone. ",1)]),_:1})]),_:1}),r(a(Ze),{class:"px-4 sm:px-6"},{default:n(()=>[r(U,{type:"button",onClick:e[24]||(e[24]=p=>D.value=!1),variant:"outline"},{default:n(()=>e[72]||(e[72]=[c("Cancel")])),_:1}),r(U,{type:"button",onClick:e[25]||(e[25]=p=>ot()),variant:"destructive"},{default:n(()=>e[73]||(e[73]=[c("Delete Selected")])),_:1})]),_:1})]),_:1})]),_:1},8,["open"]),r(a(Se),{open:i.value,"onUpdate:open":e[29]||(e[29]=p=>i.value=p)},{default:n(()=>[r(a(Ce),{class:"max-w-[95vw] sm:max-w-md"},{default:n(()=>[r(a($e),{class:"px-4 sm:px-6"},{default:n(()=>[r(a(De),{class:"text-lg sm:text-xl"},{default:n(()=>e[74]||(e[74]=[c("Confirm Deletion")])),_:1}),r(a(he),{class:"text-xs sm:text-sm"},{default:n(()=>e[75]||(e[75]=[c(" Are you sure you want to delete this rejection record? This action cannot be undone. ")])),_:1})]),_:1}),r(a(Ze),{class:"px-4 sm:px-6"},{default:n(()=>[r(U,{type:"button",onClick:e[27]||(e[27]=p=>i.value=!1),variant:"outline"},{default:n(()=>e[76]||(e[76]=[c("Cancel")])),_:1}),r(U,{type:"button",onClick:e[28]||(e[28]=p=>lt(O.value)),variant:"destructive"},{default:n(()=>e[77]||(e[77]=[c("Delete")])),_:1})]),_:1})]),_:1})]),_:1},8,["open"]),r(Xl,{open:b.value,"onUpdate:open":e[30]||(e[30]=p=>b.value=p),"is-super-admin":s.isSuperAdmin,"tenant-slug":s.tenantSlug,tenants:s.tenants,onSuccess:st,onError:it},null,8,["open","is-super-admin","tenant-slug","tenants"])])]}),_:1},8,["tenantSlug","permissions"]))}},hr=Ee(Ja,[["__scopeId","data-v-d79d83c8"]]);export{hr as default};
