import{r as z,A as U,b as f,e as l,f as n,l as s,X as a,u as t,k as p,S as d,U as u,L as g,P as j,D as N,Y as F,al as I,M as O,N as Y,b2 as q,bI as H}from"./vendor-cgn9wV4E.js";import{x as A,g as L,S as P,W as C}from"./vendor-vue-C6le94gM.js";import{_ as W}from"./AppLayout.vue_vue_type_script_setup_true_lang-DiJRBPRF.js";import{_ as c}from"./Icon.vue_vue_type_script_setup_true_lang-g5QrAIpa.js";import{_ as S}from"./Button.vue_vue_type_script_setup_true_lang-DA-5a5tM.js";import{_}from"./Card.vue_vue_type_script_setup_true_lang-DQTQMX6v.js";import{_ as D}from"./CardHeader.vue_vue_type_script_setup_true_lang-n-Rvhb9V.js";import{_ as M}from"./CardTitle.vue_vue_type_script_setup_true_lang-AShXP1uR.js";import{_ as v}from"./CardContent.vue_vue_type_script_setup_true_lang-DNXZ8J1r.js";import{_ as E}from"./DialogFooter.vue_vue_type_script_setup_true_lang-C4cZ_wVx.js";import{b as G,_ as X,a as J}from"./AlertDescription.vue_vue_type_script_setup_true_lang-BdYx0SaG.js";import{_ as k}from"./Badge.vue_vue_type_script_setup_true_lang-BpieHD20.js";import{_ as K}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vendor-axios-C0Zqfgkc.js";import"./utils-C4uCeQPu.js";import"./vendor-ui-BuPyOEYe.js";import"./useInitials-DzeGKvtI.js";import"./app-CwVxJaic.js";import"./vendor-icons-Bu7C1ObZ.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BM02NuXb.js";const Q={class:"w-[95%] max-w-7xl mx-auto p-6 space-y-6"},Z={class:"flex items-center gap-2"},ee={class:"text-sm text-muted-foreground mt-1 flex items-center gap-1"},te={key:0,class:"flex items-center gap-1 ml-2"},se={key:0,class:"flex-shrink-0"},ae={class:"bg-muted/30 p-4 rounded-md border border-border/50 hover:border-primary/20 transition-colors"},ne={class:"whitespace-pre-line"},oe={class:"flex justify-between items-center mb-4"},re={class:"text-xl font-bold text-gray-800 dark:text-gray-200 flex items-center gap-2"},ie={key:0,class:"bg-muted/20 p-6 rounded-md text-center text-muted-foreground border border-dashed border-border"},le={class:"flex flex-col items-center"},de={class:"space-y-4 mt-4"},ue={class:"flex justify-between items-center mb-2"},ce={class:"flex items-center gap-2"},me={class:"h-8 w-8 rounded-full bg-primary/10 flex items-center justify-center text-primary font-semibold"},fe={class:"font-semibold"},pe={class:"text-xs text-muted-foreground flex items-center gap-1"},ge={class:"bg-background/50 p-3 rounded-md border border-border/50 mt-2 hover:border-primary/20 transition-colors"},be={class:"whitespace-pre-line"},he={key:0,class:"text-xs text-right mt-2 text-muted-foreground"},ke={key:0},xe={key:1},_e={class:"flex flex-col items-center justify-center py-4"},ve={class:"flex justify-center mt-8"},ye={__name:"TicketShow",props:{ticket:Object,tenantSlug:{type:String,default:null},SuperAdmin:Boolean},setup(o){const r=o,x=z(""),V=[{title:r.tenantSlug?"Dashboard":"Admin Dashboard",href:r.tenantSlug?route("dashboard",{tenantSlug:r.tenantSlug}):route("admin.dashboard")},{title:"Customer Support",href:r.tenantSlug?route("support.index",{tenantSlug:r.tenantSlug}):route("support.index.admin")},{title:`Ticket #${r.ticket.id}`,href:""}],b=A({status:r.ticket.status}),h=A({ticket_id:r.ticket.id,message:""});function $(m){switch(m){case"open":return"open";case"in_progress":return"in_progress";case"closed":return"closed";default:return"outline"}}function T(){const m=r.tenantSlug?route("support.update.status",{tenantSlug:r.tenantSlug,ticket:r.ticket.id}):route("support.update.status.admin",r.ticket.id);b.put(m,{onSuccess:()=>{x.value=`Ticket status updated to ${b.status.replace("_"," ")}.`,setTimeout(()=>C.reload(),1500)}})}function B(){b.status="open",T()}function R(){const m=r.tenantSlug?route("support.responses.store",{tenantSlug:r.tenantSlug}):route("support.responses.store.admin");h.post(m,{onSuccess:()=>{x.value="Response added successfully.",setTimeout(()=>C.reload(),1500)}})}function y(m){if(!m)return"N/A";const e=new Date(m),i=String(e.getHours()).padStart(2,"0"),w=String(e.getMinutes()).padStart(2,"0");return`${e.getMonth()+1}-${e.getDate()}-${e.getFullYear()} ${i}:${w}`}return U(()=>{r.ticket.responses&&r.ticket.responses.length>0&&setTimeout(()=>{window.scrollTo({top:document.body.scrollHeight,behavior:"smooth"})},500)}),(m,e)=>(l(),f(W,{breadcrumbs:V,tenantSlug:o.tenantSlug,permissions:r.permissions},{default:n(()=>[s(t(L),{title:`Ticket #${o.ticket.id}`},null,8,["title"]),a("div",Q,[x.value?(l(),f(t(G),{key:0,variant:"success",class:"animate-in fade-in duration-300"},{default:n(()=>[s(t(X),{class:"flex items-center gap-2"},{default:n(()=>[s(c,{name:"check-circle",class:"h-5 w-5 text-green-500"}),e[2]||(e[2]=d(" Success "))]),_:1}),s(t(J),null,{default:n(()=>[d(u(x.value),1)]),_:1})]),_:1})):p("",!0),s(t(_),{class:"shadow-sm hover:shadow transition-all duration-300"},{default:n(()=>[s(t(D),{class:"flex flex-col sm:flex-row justify-between items-start gap-4 pb-3 border-b"},{default:n(()=>[a("div",null,[a("div",Z,[s(c,{name:"ticket",class:"h-5 w-5 text-primary"}),s(t(M),{class:"text-xl"},{default:n(()=>[d(u(o.ticket.subject),1)]),_:1}),o.ticket.status==="open"?(l(),f(t(k),{key:0,variant:$(o.ticket.status),class:"capitalize animate-pulse"},{default:n(()=>[d(u(o.ticket.status.replace("_"," ")),1)]),_:1},8,["variant"])):(l(),f(t(k),{key:1,variant:$(o.ticket.status),class:"capitalize"},{default:n(()=>[d(u(o.ticket.status.replace("_"," ")),1)]),_:1},8,["variant"]))]),a("p",ee,[s(c,{name:"calendar",class:"h-3.5 w-3.5"}),d(" Created: "+u(y(o.ticket.created_at))+" ",1),o.ticket.user?(l(),g("span",te,[s(c,{name:"user",class:"h-3.5 w-3.5"}),d(" by "+u(o.ticket.user.name),1)])):p("",!0)])]),o.SuperAdmin?(l(),g("div",se,[a("form",{onSubmit:j(T,["prevent"]),class:"flex gap-2"},[N(a("select",{"onUpdate:modelValue":e[0]||(e[0]=i=>t(b).status=i),required:"",class:"h-10 rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:ring-2 focus:ring-primary/30 transition-all"},e[3]||(e[3]=[a("option",{value:"open"},"Open",-1),a("option",{value:"in_progress"},"In Progress",-1),a("option",{value:"closed"},"Closed",-1)]),512),[[F,t(b).status]]),s(t(S),{type:"submit",size:"sm",class:"shadow-sm hover:shadow transition-all"},{default:n(()=>[s(c,{name:"save",class:"mr-2 h-4 w-4"}),e[4]||(e[4]=d(" Update Status "))]),_:1})],32)])):p("",!0)]),_:1}),s(t(v),{class:"pt-4"},{default:n(()=>[a("div",ae,[a("p",ne,u(o.ticket.message),1)])]),_:1})]),_:1}),a("div",null,[a("div",oe,[a("h2",re,[s(c,{name:"message-circle",class:"h-5 w-5 text-primary"}),e[5]||(e[5]=d(" Responses "))]),o.ticket.responses.length?(l(),f(t(k),{key:0,variant:"outline",class:"animate-in slide-in-from-right"},{default:n(()=>[d(u(o.ticket.responses.length)+" "+u(o.ticket.responses.length===1?"response":"responses"),1)]),_:1})):p("",!0)]),o.ticket.responses.length?p("",!0):(l(),g("div",ie,[a("div",le,[s(c,{name:"inbox",class:"h-12 w-12 mb-3 opacity-20"}),e[6]||(e[6]=a("p",null,"Thanks for your patience! Our team is reviewing your ticket and will get back to you soon.",-1))])])),a("div",de,[s(I,{name:"list",tag:"div",class:"space-y-4"},{default:n(()=>[(l(!0),g(O,null,Y(o.ticket.responses,(i,w)=>(l(),f(t(_),{key:i.id,class:q([{"border-primary/20 bg-primary/5":i.is_admin,"border-l-4 border-l-primary":i.is_admin&&!i.seen_at},"shadow-sm hover:shadow transition-all duration-300"])},{default:n(()=>[s(t(v),{class:"p-4"},{default:n(()=>[a("div",ue,[a("div",ce,[a("div",me,u(i.user.name.charAt(0).toUpperCase()),1),a("div",null,[a("span",fe,u(i.user.name),1),i.is_admin?(l(),f(t(k),{key:0,variant:"outline",class:"text-xs ml-1"},{default:n(()=>e[7]||(e[7]=[d("Support Specialist")])),_:1})):p("",!0),i.seen_at?p("",!0):(l(),f(t(k),{key:1,variant:"destructive",class:"text-xs ml-1 animate-pulse"},{default:n(()=>e[8]||(e[8]=[d("New")])),_:1}))])]),a("span",pe,[s(c,{name:"clock",class:"h-3.5 w-3.5"}),d(" "+u(y(i.created_at)),1)])]),a("div",ge,[a("p",be,u(i.message),1)]),w===o.ticket.responses.length-1?(l(),g("div",he,[i.seen_at?(l(),g("span",ke,"Seen "+u(y(i.seen_at)),1)):(l(),g("span",xe,"Not seen yet"))])):p("",!0)]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:1})])]),o.ticket.status!=="closed"?(l(),f(t(_),{key:1,class:"shadow-sm hover:shadow transition-all duration-300 border-primary/10"},{default:n(()=>[s(t(D),{class:"pb-2"},{default:n(()=>[s(t(M),{class:"flex items-center gap-2"},{default:n(()=>[s(c,{name:"reply",class:"h-5 w-5 text-primary"}),e[9]||(e[9]=d(" Add Response "))]),_:1})]),_:1}),s(t(v),null,{default:n(()=>[a("form",{onSubmit:j(R,["prevent"]),class:"space-y-4"},[N(a("textarea",{"onUpdate:modelValue":e[1]||(e[1]=i=>t(h).message=i),rows:"4",class:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 transition-all focus:border-primary",placeholder:"Your responseâ€¦",required:""},null,512),[[H,t(h).message]]),s(t(E),{class:"flex justify-end"},{default:n(()=>[s(t(S),{type:"submit",class:"shadow-sm hover:shadow transition-all",disabled:t(h).processing},{default:n(()=>[s(c,{name:"send",class:"mr-2 h-4 w-4"}),d(" "+u(t(h).processing?"Sending...":"Send Response"),1)]),_:1},8,["disabled"])]),_:1})],32)]),_:1})]),_:1})):(l(),f(t(_),{key:2,class:"border-muted bg-muted/10 shadow-sm"},{default:n(()=>[s(t(v),{class:"p-4 text-center"},{default:n(()=>[a("div",_e,[s(c,{name:"check-circle",class:"h-12 w-12 text-muted-foreground mb-2"}),e[11]||(e[11]=a("p",{class:"text-muted-foreground"},"This ticket is closed. No further responses can be added.",-1)),o.SuperAdmin?(l(),f(t(S),{key:0,onClick:B,variant:"outline",size:"sm",class:"mt-4 shadow-sm hover:shadow transition-all"},{default:n(()=>[s(c,{name:"refresh-cw",class:"mr-2 h-4 w-4"}),e[10]||(e[10]=d(" Reopen Ticket "))]),_:1})):p("",!0)])]),_:1})]),_:1})),a("div",ve,[s(t(P),{href:r.tenantSlug?m.route("support.index",{tenantSlug:r.tenantSlug}):m.route("support.index.admin"),class:"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2 shadow-sm hover:shadow transition-all"},{default:n(()=>[s(c,{name:"arrow-left",class:"mr-2 h-4 w-4"}),e[12]||(e[12]=d(" Back to Tickets "))]),_:1},8,["href"])])])]),_:1},8,["tenantSlug","permissions"]))}},He=K(ye,[["__scopeId","data-v-02fdee6d"]]);export{He as default};
