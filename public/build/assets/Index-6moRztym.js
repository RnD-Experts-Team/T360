import{c as V,L as f,e as u,X as t,U as g,b2 as K,M,S as c,N as z,a1 as vt,r as N,A as Je,w as de,bW as bt,b as $,l as r,k as _,f as n,u as l,d as Te,D as X,Y as ee,bH as gt,P as be,h as se,K as _t,bF as yt}from"./vendor-cgn9wV4E.js";import{a as xt,W as Ne,x as Me,g as kt}from"./vendor-vue-C6le94gM.js";import{_ as wt}from"./Badge.vue_vue_type_script_setup_true_lang-BpieHD20.js";import{_ as W}from"./Icon.vue_vue_type_script_setup_true_lang-g5QrAIpa.js";import{_ as U}from"./Button.vue_vue_type_script_setup_true_lang-DA-5a5tM.js";import{b as Ve,_ as Ae,a as Re}from"./AlertDescription.vue_vue_type_script_setup_true_lang-BdYx0SaG.js";import{_ as ge}from"./Card.vue_vue_type_script_setup_true_lang-DQTQMX6v.js";import{_ as _e}from"./CardContent.vue_vue_type_script_setup_true_lang-DNXZ8J1r.js";import{_ as Ie,a as Le,b as ue,c as oe,d as Ue,e as ae}from"./TableRow.vue_vue_type_script_setup_true_lang-58J5Q7id.js";import{b as Se,a as he,_ as Ce}from"./DialogDescription.vue_vue_type_script_setup_true_lang-BDOQqQHy.js";import{_ as $e,a as De}from"./DialogTitle.vue_vue_type_script_setup_true_lang-K_t0Wv0O.js";import{_ as Ee}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as Y}from"./Input.vue_vue_type_script_setup_true_lang-1zH_gJ02.js";import{_ as R}from"./Label.vue_vue_type_script_setup_true_lang-WOFpmVDV.js";import{_ as jt}from"./CardHeader.vue_vue_type_script_setup_true_lang-n-Rvhb9V.js";import{_ as St}from"./CardTitle.vue_vue_type_script_setup_true_lang-AShXP1uR.js";import{_ as Ze}from"./DialogFooter.vue_vue_type_script_setup_true_lang-C4cZ_wVx.js";import{_ as ht}from"./AppLayout.vue_vue_type_script_setup_true_lang-DiJRBPRF.js";import"./vendor-axios-C0Zqfgkc.js";import"./utils-C4uCeQPu.js";import"./vendor-icons-Bu7C1ObZ.js";import"./vendor-ui-BuPyOEYe.js";import"./useInitials-DzeGKvtI.js";import"./app-CwVxJaic.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BM02NuXb.js";const Ct={class:"bg-background rounded-lg border shadow-sm p-2 md:p-4 flex flex-col items-center justify-center"},$t={class:"text-sm font-semibold mb-2 text-foreground"},Dt={__name:"TotalLateStops",props:{title:{type:String,required:!0},value:{type:[Number,String],required:!0}},setup(j){const o=j,S=V(()=>o.value===null||o.value===void 0||o.value===""?"No Data":o.value),T=V(()=>{const I=Number(o.value);return o.title.toLowerCase().includes("total")&&I>0});return(I,E)=>(u(),f("div",Ct,[t("h3",$t,g(j.title),1),t("p",{class:K(["text-2xl font-bold",T.value?"text-red-600":"text-primary"])},g(S.value),3)]))}},Vt={class:"bg-background rounded-lg border shadow-sm p-2 md:p-4"},At={class:"text-base text-center font-semibold mb-4"},Rt={key:0,class:"text-center text-sm py-4 text-primary font-medium"},Tt={class:"space-y-3"},Bt={class:"text-sm"},Ft={__name:"BottomDrivers",props:{title:{type:String,default:"Bottom 5 Drivers"},drivers:{type:Array,default:()=>[]},totalRejections:{type:Number,default:0},rejectionType:{type:String,default:""}},setup(j){const o=j;V(()=>o.rejectionType==="load"?"No load rejections recorded. You're on track for Fantastic+ !":o.rejectionType==="block"?"No block rejections recorded. You're on track for Fantastic+ !":"No rejections recorded. You're on track for Fantastic+ !");const S=T=>{const I=["#ef4444","#f97316","#f59e0b","#84cc16","#10b981"],w=[...o.drivers].sort((h,B)=>B.total_penalty-h.total_penalty).map(h=>h.total_penalty).indexOf(T);return I[w]||"#6b7280"};return(T,I)=>(u(),f("div",Vt,[t("h3",At,g(j.title),1),j.drivers.length===0?(u(),f("div",Rt,[j.totalRejections===0?(u(),f(M,{key:0},[j.rejectionType==="block"?(u(),f(M,{key:0},[c(" No block rejections recorded. You're on track for Fantastic+ ! ")],64)):j.rejectionType==="load"?(u(),f(M,{key:1},[c(" No load rejections recorded. You're on track for Fantastic+ ! ")],64)):(u(),f(M,{key:2},[c(" No rejections recorded. You're on track for Fantastic+ ! ")],64))],64)):(u(),f(M,{key:1},[c(" No delays recorded. You're on track for Fantastic+ ! ")],64))])):(u(),f(M,{key:1},[I[0]||(I[0]=t("div",{class:"flex justify-between items-center mb-2"},[t("span",{class:"text-base mb-2 font-medium"},"Driver Name"),t("span",{class:"text-base mb-2 font-medium"},"Total Penalty")],-1)),t("div",Tt,[(u(!0),f(M,null,z(j.drivers,(E,w)=>(u(),f("div",{key:w,class:"flex justify-between items-center"},[t("span",Bt,g(E.driver_name),1),t("span",{class:"text-sm font-medium",style:vt({color:S(E.total_penalty)})},g(E.total_penalty),5)]))),128))])],64))]))}},Nt={class:"bg-background rounded-lg border shadow-sm p-2 md:p-4"},Mt={class:"text-base text-center font-semibold mb-4"},It={class:"h-64"},Lt={__name:"LineChart",props:{title:{type:String,default:"Acceptance Score"},chartData:{type:Object,default:()=>({labels:[],datasets:[]})},averageAcceptance:{type:Number,default:null}},setup(j){const o=j,S=N(null);let T=null;const I=()=>{if(T&&T.destroy(),!S.value)return;const E=S.value.getContext("2d"),w=[];o.chartData.datasets.forEach(D=>{D.data&&D.data.length&&w.push(...D.data)});const h=w.length>0?Math.min(...w):0,B=w.length>0?Math.max(...w):100;T=new bt(E,{type:"line",data:o.chartData,options:{responsive:!0,maintainAspectRatio:!1,layout:{padding:{left:15,right:15,top:10,bottom:10}},plugins:{legend:{position:!1},tooltip:{callbacks:{label:function(D){const i=D.raw||0,O=o.averageAcceptance||0,d=o.chartData.dateRangeLabel||"selected period",s=Number(O).toFixed(2);return[`Acceptance Score: ${i}`,`Average Score Over ${d}: ${s}`]}}}},scales:{y:{beginAtZero:!(h>10),min:Math.max(Math.floor(h-5),0),max:Math.min(102.5,Math.ceil(B+5)),ticks:{stepSize:2.5,padding:10,font:{size:11},callback:function(D){return D<=100?D:""}},grid:{drawBorder:!0,color:"rgba(200, 200, 200, 0.2)"}},x:{ticks:{padding:10,font:{size:11}},grid:{drawBorder:!0,color:"rgba(200, 200, 200, 0.2)"}}}}})};return Je(()=>{I()}),de(()=>o.chartData,()=>{I()},{deep:!0}),(E,w)=>(u(),f("div",Nt,[t("h3",Mt,g(j.title),1),t("div",It,[t("canvas",{ref_key:"chartCanvas",ref:S},null,512)])]))}},Ut={class:"space-y-2 md:space-y-4 lg:space-y-6 mb-2 md:mb-4 lg:mb-6"},Et={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-2 md:gap-4"},Pt={class:"grid grid-cols-1 lg:grid-cols-4 gap-2 md:gap-4 lg:gap-6"},Ot={key:1,class:"bg-background rounded-lg border shadow-sm p-4 md:p-6 lg:col-span-3 md:col-span-2 transition-all duration-300 hover:shadow-md flex flex-col justify-center"},Ht={class:"flex flex-col sm:flex-row items-center justify-center sm:justify-around gap-3 mb-4"},Wt={class:"text-xs text-muted-foreground text-center mt-2"},Yt={key:2,class:"bg-background rounded-lg border shadow-sm p-4 md:p-6 lg:col-span-3 md:col-span-2 transition-all duration-300 hover:shadow-md flex flex-col justify-center items-center"},zt={class:"flex flex-col items-center justify-center gap-3 mb-4"},qt={__name:"AcceptanceDashboard",props:{metricsData:{type:Object,default:()=>({})},driversData:{type:Array,default:()=>[]},chartData:{type:Object,default:()=>({})},averageAcceptance:{type:Number,default:null},currentDateFilter:{type:String,default:null},currentFilters:{type:Object,default:()=>({})}},setup(j){const o=j,S=V(()=>{var v;if(!o.metricsData||!o.metricsData.totalRejections)return[];const x=(v=o.currentFilters)==null?void 0:v.rejectionType;return!x||x===""?[{title:"Total Rejected Stops",value:o.metricsData.totalRejections||0},{title:"Rejected In Advance",value:o.metricsData.advancedRejectionCount||0},{title:"Rejected +24 Hours Before Start Time",value:o.metricsData.moreThan24Count||0},{title:"Rejected Within 24 Hours Before Start Time",value:o.metricsData.within24Count||0},{title:"Rejected +6 Hours Before Start Time",value:o.metricsData.moreThan6Count||0},{title:"Rejected Within 6 Hours Before Start Time",value:o.metricsData.within6Count||0},{title:"Rejected After Start Time",value:o.metricsData.afterStartCount||0}]:x==="block"?[{title:"Total Block Rejections",value:o.metricsData.totalRejections||0},{title:"Rejected In Advance",value:o.metricsData.advancedRejectionCount||0},{title:"Rejected +24 Hours Before Start Time",value:o.metricsData.moreThan24Count||0},{title:"Rejected Within 24 Hours Before Start Time",value:o.metricsData.within24Count||0},{title:"Rejected After Start Time",value:o.metricsData.afterStartCount||0}]:x==="load"?[{title:"Total Load Rejections",value:o.metricsData.totalRejections||0},{title:"Rejected +6 Hours Before Start Time",value:o.metricsData.moreThan6Count||0},{title:"Rejected Within 6 Hours Before Start Time",value:o.metricsData.within6Count||0},{title:"Rejected After Start Time",value:o.metricsData.afterStartCount||0}]:[]}),T=V(()=>o.driversData&&o.driversData.length?o.driversData:[]),I=V(()=>o.chartData&&Object.keys(o.chartData).length?o.chartData:{}),E=V(()=>{var x;return((x=o.metricsData)==null?void 0:x.totalRejections)||0}),w=V(()=>{var x;return((x=o.currentFilters)==null?void 0:x.rejectionType)||null}),h=V(()=>!o.chartData||!o.chartData.labels?!1:o.chartData.labels.length>1),B=V(()=>{var x,v,re,P;return((P=(re=(v=(x=o.chartData)==null?void 0:x.datasets)==null?void 0:v[0])==null?void 0:re.data)==null?void 0:P.length)>0}),D=V(()=>B.value?o.chartData.datasets[0].data[0]:0),i=V(()=>{const x=D.value;return x>=98?"fantastic_plus":x>=95?"fantastic":x>=90?"good":x>=85?"fair":"poor"}),O=x=>x==null?"0%":`${Math.round(parseFloat(x))}%`,d=x=>{if(!x)return"Not Available";switch(x){case"fantastic_plus":return"Fantastic +";case"fantastic":return"Fantastic";case"good":return"Good";case"fair":return"Fair";case"poor":return"Poor";default:return x}},s=x=>{if(!x)return"outline";switch(x){case"fantastic_plus":return"fantastic-plus";case"fantastic":return"fantastic";case"good":return"good";case"fair":return"fair";case"poor":return"poor";default:return"outline"}},b=x=>{if(!x)return"text-gray-600";switch(x){case"fantastic_plus":return"text-green-600";case"fantastic":return"text-emerald-600";case"good":return"text-blue-600";case"fair":return"text-amber-600";case"poor":return"text-red-600";default:return"text-indigo-600"}},Z=x=>{if(!x)return"";switch(x){case"fantastic_plus":return"Outstanding performance with exceptional acceptance rate";case"fantastic":return"Excellent performance with very high acceptance rate";case"good":return"Solid performance with good acceptance rate";case"fair":return"Acceptable performance with room for improvement";case"poor":return"Performance needs significant improvement";default:return""}};return(x,v)=>(u(),f("div",Ut,[t("div",Et,[(u(!0),f(M,null,z(S.value,(re,P)=>(u(),$(Dt,{key:P,title:re.title,value:re.value,class:"transition-all duration-300 hover:shadow-md"},null,8,["title","value"]))),128))]),t("div",Pt,[r(Ft,{title:"Bottom 5 Drivers",drivers:T.value,"total-rejections":E.value,"rejection-type":w.value,class:K({"lg:col-span-1":h.value,"lg:col-span-1 md:col-span-1":!h.value,"transition-all duration-300 hover:shadow-md":!0})},null,8,["drivers","total-rejections","rejection-type","class"]),o.currentDateFilter!="Yesterday"&&h.value?(u(),$(Lt,{key:0,title:"Acceptance Score",chartData:I.value,averageAcceptance:j.averageAcceptance,class:"lg:col-span-3 md:col-span-2 transition-all duration-300 hover:shadow-md"},null,8,["chartData","averageAcceptance"])):_("",!0),!h.value&&B.value?(u(),f("div",Ot,[v[0]||(v[0]=t("h3",{class:"text-base md:text-lg text-center font-semibold mb-4"},"Acceptance Score",-1)),t("div",Ht,[t("div",{class:K(["text-4xl md:text-5xl font-bold text-center",b(i.value)])},g(O(D.value)),3),r(l(wt),{variant:s(i.value),class:"text-xs md:text-sm px-3 py-1"},{default:n(()=>[c(g(d(i.value)),1)]),_:1},8,["variant"])]),t("p",Wt,g(Z(i.value)),1)])):_("",!0),B.value?_("",!0):(u(),f("div",Yt,[v[3]||(v[3]=t("h3",{class:"text-base md:text-lg text-center font-semibold mb-4"},"Acceptance Score",-1)),t("div",zt,[r(W,{name:"chart_bar",class:"h-16 w-16 text-muted-foreground/50"}),v[1]||(v[1]=t("div",{class:"text-lg font-medium text-center text-primary"}," No data available ",-1)),v[2]||(v[2]=t("p",{class:"text-sm text-primary/70 text-center max-w-md"}," There is no acceptance data available for the selected time period. Try selecting a different date range or check back later. ",-1))])]))])]))}},Gt={class:"flex items-center gap-2"},Kt={class:"flex-1 overflow-y-auto px-4 sm:px-6 py-4 space-y-5"},Qt={key:0,class:"space-y-2"},Xt=["disabled"],Zt=["value"],Jt={key:0,class:"text-xs text-amber-600 dark:text-amber-400 flex items-center gap-1"},el={class:"text-sm font-semibold flex items-center gap-2"},tl={class:"flex h-5 w-5 items-center justify-center rounded-full bg-primary text-[11px] font-bold text-primary-foreground"},ll={class:"grid grid-cols-1 sm:grid-cols-2 gap-3"},al=["value","disabled"],rl={class:"space-y-0.5"},nl={class:"text-sm font-medium"},sl={class:"text-xs text-muted-foreground"},ol={class:"space-y-2"},il={class:"text-sm font-semibold flex items-center gap-2"},ul={class:"flex h-5 w-5 items-center justify-center rounded-full bg-primary text-[11px] font-bold text-primary-foreground"},dl={key:0,class:"rounded-md border p-3 bg-muted/10 space-y-1"},cl={class:"cursor-pointer inline-flex items-center gap-2 text-sm text-primary hover:underline mt-1"},ml=["disabled"],pl={key:1,class:"rounded-md border border-amber-300 bg-amber-50 dark:bg-amber-900/10 p-3 text-xs text-amber-700 dark:text-amber-300"},fl={class:"cursor-pointer mt-3"},vl=["disabled"],bl={key:0,class:"mt-2 text-xs text-muted-foreground"},gl={class:"font-medium text-foreground"},_l={key:1,class:"text-xs text-muted-foreground mt-2"},yl={key:2,class:"flex items-center justify-center gap-2 py-4"},xl={key:0,class:"rounded-md border border-primary/30 bg-primary/5 px-3 py-2 text-xs text-primary flex items-center gap-2"},kl={class:"font-semibold ml-1"},wl={key:1,class:"rounded-lg border p-3"},jl={class:"flex items-center justify-between mb-2"},Sl={class:"text-xs text-muted-foreground"},hl={class:"flex flex-wrap gap-2"},Cl={class:"grid grid-cols-3 gap-4"},$l={class:"text-2xl font-bold"},Dl={class:"text-2xl font-bold text-green-600"},Vl={class:"text-2xl font-bold text-red-600"},Al={key:4},Rl={class:"flex items-center justify-between mb-3"},Tl={class:"text-base font-semibold text-red-600 flex items-center gap-2"},Bl={class:"border rounded-lg overflow-hidden"},Fl={class:"max-h-72 overflow-y-auto"},Nl={class:"flex flex-wrap gap-x-3 gap-y-1"},Ml={class:"font-medium text-foreground"},Il={key:5},Ll={class:"text-base font-semibold text-green-600 flex items-center gap-2 mb-3"},Ul={class:"border rounded-lg overflow-hidden"},El={class:"flex flex-wrap gap-x-3 gap-y-1"},Pl={class:"font-medium"},Ol={class:"flex justify-start"},Hl={class:"border-t px-4 sm:px-6 py-4 flex items-center justify-between gap-3 bg-background"},Wl={class:"text-xs text-muted-foreground"},Yl={key:0},zl={class:"font-medium"},ql={class:"font-medium"},Gl={class:"flex gap-3"},Kl={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"},Ql=Te({__name:"ImportRejectionModal",props:{open:{type:Boolean,default:!1},isSuperAdmin:{type:Boolean,default:!1},tenantSlug:{type:String,default:null},tenants:{type:Array,default:()=>[]}},emits:["update:open","success","error"],setup(j,{emit:o}){const S=j,T=o,I=V({get:()=>S.open,set:k=>T("update:open",k)}),E=[{value:"advanced_block",label:"Advanced Block",description:"Import advanced block rejections from a weekly block schedule CSV."},{value:"block",label:"Block",description:"Import rejected blocks from a block acceptance status CSV."},{value:"load",label:"Load",description:"Import rejected loads from a load status CSV."},{value:"load_with_trips",label:"Load + Trips",description:"Import rejected loads and attach a Trips CSV to auto-fill driver names."},{value:"trips_only",label:"Trips Only",description:"Upload a Trips CSV to update driver names on existing load rejections."}],w=N(null),h=N(""),B=N(null),D=N(null),i=N(null),O=N(!1),d=N(!1),s=N(!1),b=N(null),Z=N(null);let x=0;const v=xt(),re=V(()=>{var k;return((k=E.find(m=>m.value===h.value))==null?void 0:k.label)??""}),P=V(()=>{var k;return!S.isSuperAdmin||!w.value?"":((k=S.tenants.find(m=>m.id===w.value))==null?void 0:k.name)??""});V(()=>"/storage/upload-data-temps/Rejections Template.csv");const Q=V(()=>{var k,m;return!i.value||i.value.header_error||S.isSuperAdmin&&!w.value?!1:i.value.trips_only?!0:(((k=i.value.summary)==null?void 0:k.valid)??0)>0&&(((m=i.value.summary)==null?void 0:m.invalid)??0)===0}),te={advanced_block:{validate:"acceptance.validateAdvancedBlockImport",confirm:"acceptance.confirmAdvancedBlockImport"},block:{validate:"acceptance.validateBlockImport",confirm:"acceptance.confirmBlockImport"},load:{validate:"acceptance.validateLoadImport",confirm:"acceptance.confirmLoadImport"},load_with_trips:{validate:"acceptance.validateLoadImport",confirm:"acceptance.confirmLoadImport"},trips_only:{validate:"acceptance.validateLoadImport",confirm:"acceptance.confirmLoadImport"}};function ce(k){var le;const m=(le=te[h.value])==null?void 0:le[k];if(!m)throw new Error(`No route for type: ${h.value}`);const F=S.isSuperAdmin?`${m}.admin`:m,J=S.isSuperAdmin?{}:{tenantSlug:S.tenantSlug};return route(F,J)}function me(){B.value=null,D.value=null,i.value=null,O.value=!1,s.value=!1,x=0,b.value&&(b.value.value=""),Z.value&&(Z.value.value="")}function ye(k){var F;const m=(F=k.target.files)==null?void 0:F[0];m&&we(m),k.target.value=""}function ie(k){var m;D.value=((m=k.target.files)==null?void 0:m[0])??null}function pe(){x++,s.value=!0}function fe(){s.value=!0}function Be(){x--,x<=0&&(x=0,s.value=!1)}function xe(k){var F,J;x=0,s.value=!1;const m=(J=(F=k.dataTransfer)==null?void 0:F.files)==null?void 0:J[0];m&&we(m)}function we(k){if(!(k.type==="text/csv"||k.name.toLowerCase().endsWith(".csv"))){T("error","Please upload a valid CSV file.");return}B.value=k,O.value=!0;const F=new FormData;S.isSuperAdmin&&w.value&&F.append("tenant_id",String(w.value)),h.value==="trips_only"?F.append("trips_file",k):(F.append("file",k),h.value==="load_with_trips"&&D.value&&F.append("trips_file",D.value)),Ne.post(ce("validate"),F,{forceFormData:!0,preserveScroll:!0,onFinish:()=>{O.value=!1},onError:()=>{O.value=!1,T("error","Failed to validate CSV.")}})}function ne(){d.value=!0;const k={};S.isSuperAdmin&&w.value&&(k.tenant_id=w.value),Ne.post(ce("confirm"),k,{preserveScroll:!0,onSuccess:()=>{var F,J;const m=((J=(F=i.value)==null?void 0:F.summary)==null?void 0:J.valid)??0;T("success",`Successfully imported ${m} rejection(s) for ${P.value||"company"}.`),je()},onError:()=>T("error","Import failed. Please try again."),onFinish:()=>{d.value=!1}})}function Fe(){const k=S.isSuperAdmin?"acceptance.downloadErrorReport.admin":"acceptance.downloadErrorReport",m=S.isSuperAdmin?{}:{tenantSlug:S.tenantSlug};window.location.href=route(k,m)}function je(){I.value=!1}return de(I,k=>{k||(w.value=null,h.value="",B.value=null,D.value=null,i.value=null,O.value=!1,d.value=!1,s.value=!1,x=0)}),de(()=>{var k;return(k=v.props.flash)==null?void 0:k.importValidation},k=>{k&&(O.value=!1,k.results?(i.value={...k.results},k.header_error&&(i.value.header_error=k.header_error),k.trips_only&&(i.value.trips_only=!0)):k.message&&T("error",k.message))},{immediate:!0}),(k,m)=>(u(),$(l(Se),{open:I.value,"onUpdate:open":m[3]||(m[3]=F=>I.value=F)},{default:n(()=>[r(l(Ce),{class:"max-w-[95vw] sm:max-w-[90vw] md:max-w-5xl max-h-[90vh] overflow-hidden flex flex-col"},{default:n(()=>{var F,J,le;return[r(l($e),{class:"px-4 sm:px-6 border-b pb-3"},{default:n(()=>[t("div",Gt,[r(W,{name:"upload",class:"h-5 w-5 text-primary"}),r(l(De),{class:"text-lg sm:text-xl font-semibold"},{default:n(()=>m[4]||(m[4]=[c(" Import Rejections ")])),_:1})]),r(l(he),{class:"text-xs sm:text-sm mt-1 text-muted-foreground"},{default:n(()=>m[5]||(m[5]=[c(" Choose an import type, then upload your CSV file. The file will be validated before import. ")])),_:1})]),_:1}),t("div",Kt,[j.isSuperAdmin?(u(),f("div",Qt,[m[8]||(m[8]=t("p",{class:"text-sm font-semibold flex items-center gap-2"},[t("span",{class:"flex h-5 w-5 items-center justify-center rounded-full bg-primary text-[11px] font-bold text-primary-foreground"},"1"),c(" Select Company ")],-1)),X(t("select",{"onUpdate:modelValue":m[0]||(m[0]=A=>w.value=A),class:"select-base",disabled:O.value||d.value,onChange:me},[m[6]||(m[6]=t("option",{value:null,disabled:""},"— Choose a company —",-1)),(u(!0),f(M,null,z(j.tenants,A=>(u(),f("option",{key:A.id,value:A.id},g(A.name),9,Zt))),128))],40,Xt),[[ee,w.value]]),w.value?_("",!0):(u(),f("p",Jt,[r(W,{name:"alert-triangle",class:"h-3 w-3"}),m[7]||(m[7]=c(" You must select a company before uploading a file. "))]))])):_("",!0),t("div",{class:K(["space-y-2",{"opacity-50 pointer-events-none":j.isSuperAdmin&&!w.value}])},[t("p",el,[t("span",tl,g(j.isSuperAdmin?"2":"1"),1),m[9]||(m[9]=c(" Import Type "))]),t("div",ll,[(u(),f(M,null,z(E,A=>t("label",{key:A.value,class:K(["flex items-start gap-3 rounded-md border p-3 cursor-pointer hover:bg-muted/20 transition-colors",h.value===A.value?"border-primary bg-primary/5":"border-border"])},[X(t("input",{type:"radio",class:"mt-1 accent-primary",value:A.value,"onUpdate:modelValue":m[1]||(m[1]=q=>h.value=q),disabled:O.value||d.value||j.isSuperAdmin&&!w.value,onChange:me},null,40,al),[[gt,h.value]]),t("div",rl,[t("div",nl,g(A.label),1),t("div",sl,g(A.description),1)])],2)),64))])],2),h.value&&!i.value&&(!j.isSuperAdmin||w.value)?(u(),f(M,{key:1},[t("div",ol,[t("p",il,[t("span",ul,g(j.isSuperAdmin?"3":"2"),1),m[10]||(m[10]=c(" Upload File "))])]),h.value==="load_with_trips"?(u(),f("div",dl,[m[11]||(m[11]=t("p",{class:"text-xs font-semibold text-muted-foreground uppercase tracking-wide"},"Optional: Trips file",-1)),m[12]||(m[12]=t("p",{class:"text-xs text-muted-foreground"}," Upload a Trips CSV alongside the Loads CSV to auto-populate driver names. ",-1)),t("label",cl,[r(W,{name:"file-plus",class:"h-4 w-4"}),c(" "+g(D.value?D.value.name:"Attach Trips CSV (optional)")+" ",1),t("input",{ref_key:"tripsFileInput",ref:Z,type:"file",class:"hidden",accept:".csv,text/csv",onChange:ie,disabled:O.value},null,40,ml)]),D.value?(u(),f("button",{key:0,type:"button",onClick:m[2]||(m[2]=A=>D.value=null),class:"ml-2 text-xs text-red-500 hover:underline"}," Remove ")):_("",!0)])):_("",!0),h.value==="trips_only"?(u(),f("div",pl," This will upload a Trips CSV only to update driver names on existing load rejections. No new rejections will be created. ")):_("",!0),t("div",{class:K(["flex flex-col items-center justify-center border-2 border-dashed rounded-lg p-8 bg-muted/10 transition-colors",{"border-primary bg-primary/5":s.value,"opacity-60 pointer-events-none":O.value}]),onDragenter:be(pe,["prevent"]),onDragover:be(fe,["prevent"]),onDragleave:be(Be,["prevent"]),onDrop:be(xe,["prevent"])},[r(W,{name:"file-spreadsheet",class:"h-12 w-12 text-muted-foreground mb-3"}),m[15]||(m[15]=t("div",{class:"text-center"},[t("p",{class:"text-sm font-medium"},[t("span",{class:"text-primary"},"Drag & drop"),c(" your CSV here ")]),t("p",{class:"text-xs text-muted-foreground mt-1"},"or")],-1)),t("label",fl,[m[13]||(m[13]=t("span",{class:"text-sm font-medium text-primary hover:underline"},"Choose CSV file",-1)),t("input",{ref_key:"mainFileInput",ref:b,type:"file",class:"hidden",accept:".csv,text/csv",onChange:ye,disabled:O.value},null,40,vl)]),B.value?(u(),f("p",bl,[m[14]||(m[14]=c(" Selected: ")),t("span",gl,g(B.value.name),1)])):(u(),f("p",_l,"CSV files only"))],34),O.value?(u(),f("div",yl,m[16]||(m[16]=[t("div",{class:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary"},null,-1),t("span",{class:"text-sm text-muted-foreground"},"Validating CSV file...",-1)]))):_("",!0)],64)):_("",!0),i.value?(u(),f(M,{key:2},[j.isSuperAdmin&&w.value?(u(),f("div",xl,[r(W,{name:"building",class:"h-4 w-4 flex-shrink-0"}),m[17]||(m[17]=c(" Importing for: ")),t("span",kl,g(P.value),1)])):_("",!0),(F=i.value.headers)!=null&&F.length?(u(),f("div",wl,[t("div",jl,[m[18]||(m[18]=t("span",{class:"text-sm font-semibold"},"CSV Headers Detected",-1)),t("span",Sl,g(i.value.headers.length)+" columns",1)]),t("div",hl,[(u(!0),f(M,null,z(i.value.headers,A=>(u(),f("span",{key:A,class:"rounded-full bg-muted px-2 py-0.5 text-xs"},g(A),1))),128))])])):_("",!0),i.value.header_error?(u(),$(l(Ve),{key:2,variant:"destructive"},{default:n(()=>[r(l(Ae),null,{default:n(()=>m[19]||(m[19]=[c("Header Error")])),_:1}),r(l(Re),null,{default:n(()=>[c(g(i.value.header_error),1)]),_:1})]),_:1})):_("",!0),t("div",Cl,[r(l(ge),{class:"border-2"},{default:n(()=>[r(l(_e),{class:"p-4 text-center"},{default:n(()=>[t("div",$l,g(i.value.summary.total),1),m[20]||(m[20]=t("div",{class:"text-sm text-muted-foreground"},"Total Rows",-1))]),_:1})]),_:1}),r(l(ge),{class:"border-2 border-green-500/50 bg-green-50 dark:bg-green-900/10"},{default:n(()=>[r(l(_e),{class:"p-4 text-center"},{default:n(()=>[t("div",Dl,g(i.value.summary.valid),1),m[21]||(m[21]=t("div",{class:"text-sm text-muted-foreground"},"Valid",-1))]),_:1})]),_:1}),r(l(ge),{class:"border-2 border-red-500/50 bg-red-50 dark:bg-red-900/10"},{default:n(()=>[r(l(_e),{class:"p-4 text-center"},{default:n(()=>[t("div",Vl,g(i.value.summary.invalid),1),m[22]||(m[22]=t("div",{class:"text-sm text-muted-foreground"},"Invalid",-1))]),_:1})]),_:1})]),i.value.trips_only?(u(),$(l(Ve),{key:3,class:"border-amber-300 bg-amber-50 dark:bg-amber-900/10"},{default:n(()=>[r(l(Ae),{class:"text-amber-700 dark:text-amber-300"},{default:n(()=>m[23]||(m[23]=[c("Trips Only Mode")])),_:1}),r(l(Re),{class:"text-amber-600 dark:text-amber-400"},{default:n(()=>m[24]||(m[24]=[c(" Only driver names will be updated on existing load rejections. No new records will be created. ")])),_:1})]),_:1})):_("",!0),(J=i.value.invalid)!=null&&J.length?(u(),f("div",Al,[t("div",Rl,[t("h3",Tl,[r(W,{name:"alert-triangle",class:"h-5 w-5"}),c(" Validation Errors ("+g(i.value.invalid.length)+") ",1)]),r(U,{onClick:Fe,variant:"outline",size:"sm"},{default:n(()=>[r(W,{name:"download",class:"h-4 w-4 mr-1"}),m[25]||(m[25]=c(" Download Error Report "))]),_:1})]),t("div",Bl,[t("div",Fl,[r(l(Ie),null,{default:n(()=>[r(l(Le),{class:"sticky top-0 bg-background"},{default:n(()=>[r(l(ue),null,{default:n(()=>[r(l(oe),{class:"w-20"},{default:n(()=>m[26]||(m[26]=[c("Row #")])),_:1}),r(l(oe),null,{default:n(()=>m[27]||(m[27]=[c("Preview")])),_:1}),r(l(oe),null,{default:n(()=>m[28]||(m[28]=[c("Errors")])),_:1})]),_:1})]),_:1}),r(l(Ue),null,{default:n(()=>[(u(!0),f(M,null,z(i.value.invalid,A=>(u(),$(l(ue),{key:A.rowNumber},{default:n(()=>[r(l(ae),{class:"font-medium text-sm"},{default:n(()=>[c(g(A.rowNumber),1)]),_:2},1024),r(l(ae),{class:"text-xs text-muted-foreground"},{default:n(()=>[t("div",Nl,[(u(!0),f(M,null,z(A.preview||[],q=>(u(),f("span",{key:q.key,class:"whitespace-nowrap"},[t("span",Ml,g(q.label)+":",1),c(" "+g(q.value),1)]))),128))])]),_:2},1024),r(l(ae),null,{default:n(()=>[(u(!0),f(M,null,z(A.errors||[],(q,ve)=>(u(),f("div",{key:ve,class:"text-xs text-red-600"}," • "+g(q),1))),128))]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])])])):_("",!0),(le=i.value.valid)!=null&&le.length&&!i.value.trips_only?(u(),f("div",Il,[t("h3",Ll,[r(W,{name:"check-circle",class:"h-5 w-5"}),c(" Valid Rows Preview (first 5 of "+g(i.value.valid.length)+") ",1)]),t("div",Ul,[r(l(Ie),null,{default:n(()=>[r(l(Le),null,{default:n(()=>[r(l(ue),null,{default:n(()=>[r(l(oe),{class:"w-20"},{default:n(()=>m[29]||(m[29]=[c("Row #")])),_:1}),r(l(oe),null,{default:n(()=>m[30]||(m[30]=[c("Preview")])),_:1})]),_:1})]),_:1}),r(l(Ue),null,{default:n(()=>[(u(!0),f(M,null,z(i.value.valid.slice(0,5),A=>(u(),$(l(ue),{key:A.rowNumber},{default:n(()=>[r(l(ae),{class:"font-medium text-sm"},{default:n(()=>[c(g(A.rowNumber),1)]),_:2},1024),r(l(ae),{class:"text-xs"},{default:n(()=>[t("div",El,[(u(!0),f(M,null,z(A.preview||[],q=>(u(),f("span",{key:q.key,class:"whitespace-nowrap"},[t("span",Pl,g(q.label)+":",1),c(" "+g(q.value),1)]))),128))])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])])):_("",!0),t("div",Ol,[r(U,{onClick:me,variant:"ghost",size:"sm",class:"text-muted-foreground"},{default:n(()=>[r(W,{name:"rotate_ccw",class:"mr-2 h-4 w-4"}),m[31]||(m[31]=c(" Upload a different file "))]),_:1})])],64)):_("",!0)]),t("div",Hl,[t("div",Wl,[j.isSuperAdmin&&P.value?(u(),f("span",Yl,[m[32]||(m[32]=c(" Company: ")),t("span",zl,g(P.value),1)])):_("",!0),h.value?(u(),f("span",{key:1,class:K({"ml-3":j.isSuperAdmin&&P.value})},[m[33]||(m[33]=c(" Mode: ")),t("span",ql,g(re.value),1)],2)):_("",!0)]),t("div",Gl,[r(U,{onClick:je,variant:"outline",disabled:d.value},{default:n(()=>m[34]||(m[34]=[c("Close")])),_:1},8,["disabled"]),Q.value?(u(),$(U,{key:0,onClick:ne,variant:"default",disabled:d.value},{default:n(()=>{var A,q,ve;return[d.value?(u(),f("div",Kl)):(u(),$(W,{key:1,name:"check",class:"h-4 w-4 mr-1"})),c(" "+g(d.value?"Importing...":(A=i.value)!=null&&A.trips_only?"Update Driver Names":`Import ${((ve=(q=i.value)==null?void 0:q.summary)==null?void 0:ve.valid)??0} Rows`),1)]}),_:1},8,["disabled"])):_("",!0)])])]}),_:1})]),_:1},8,["open"]))}}),Xl=Ee(Ql,[["__scopeId","data-v-4a4fe7fb"]]),Zl={key:0,class:"text-sm text-red-500"},H=Te({__name:"InputError",props:{message:{type:String,default:""}},setup(j){return(o,S)=>j.message?(u(),f("div",Zl,g(j.message),1)):_("",!0)}}),Jl={key:0,class:"col-span-full"},ea=["value"],ta={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},la={class:"flex gap-2 mt-1"},aa={key:1,class:"grid grid-cols-1 sm:grid-cols-2 gap-4 rounded-md border p-4"},ra={key:2,class:"grid grid-cols-1 sm:grid-cols-2 gap-4 rounded-md border p-4"},na={key:3,class:"grid grid-cols-1 sm:grid-cols-2 gap-4 rounded-md border p-4"},sa={class:"flex flex-col space-y-2 sm:space-y-0 sm:flex-row sm:justify-end sm:space-x-2 pt-4 border-t"},oa=Te({__name:"RejectionForm",props:{rejection:{type:Object,default:null},tenants:{type:Array,default:()=>[]},isSuperAdmin:{type:Boolean,default:!1},tenantSlug:{type:String,default:null}},emits:["close","success"],setup(j,{emit:o}){const S=j,T=o,I=[{value:"advanced_block",label:"Advanced Block"},{value:"block",label:"Block"},{value:"load",label:"Load"}];function E(d){return d&&d.type&&["advanced_block","block","load"].includes(d.type)?d.type:"block"}function w(d){return d?d.includes("T")?d.slice(0,16):d.replace(" ","T").slice(0,16):""}function h(d){return d?String(d).split("T")[0].split(" ")[0]:""}function B(d){return d===!0||d===1||d==="1"}function D(d){const s=E(d);return{id:(d==null?void 0:d.id)??null,tenant_id:(d==null?void 0:d.tenant_id)??null,date:h(d==null?void 0:d.date)??"",disputed:(d==null?void 0:d.disputed)??"none",carrier_controllable:B(d==null?void 0:d.carrier_controllable),driver_controllable:B(d==null?void 0:d.driver_controllable),rejection_reason:(d==null?void 0:d.rejection_reason)??"",type:s,advance_block_rejection_id:(d==null?void 0:d.advance_block_rejection_id)??"",week_start:h(d==null?void 0:d.week_start)??"",week_end:h(d==null?void 0:d.week_end)??"",impacted_blocks:(d==null?void 0:d.impacted_blocks)??"",expected_blocks:(d==null?void 0:d.expected_blocks)??"",block_id:(d==null?void 0:d.block_id)??"",block_driver_name:(d==null?void 0:d.block_driver_name)??"",block_start:w(d==null?void 0:d.block_start)??"",block_end:w(d==null?void 0:d.block_end)??"",rejection_datetime:w(d==null?void 0:d.rejection_datetime)??"",load_id:(d==null?void 0:d.load_id)??"",load_driver_name:(d==null?void 0:d.load_driver_name)??"",origin_yard_arrival:w(d==null?void 0:d.origin_yard_arrival)??"",load_rejection_bucket:(d==null?void 0:d.load_rejection_bucket)??""}}const i=Me(D(S.rejection));de(()=>S.rejection,d=>{const s=D(d);Object.keys(s).forEach(b=>{i[b]=s[b]}),i.clearErrors()},{immediate:!0});function O(){const d=!!i.id,s=S.isSuperAdmin?d?"acceptance.update.admin":"acceptance.store.admin":d?"acceptance.update":"acceptance.store",b=S.isSuperAdmin?d?{rejection:i.id}:{}:d?{tenantSlug:S.tenantSlug,rejection:i.id}:{tenantSlug:S.tenantSlug};i[d?"put":"post"](route(s,b),{preserveScroll:!0,onSuccess:()=>{T("success"),T("close")}})}return(d,s)=>(u(),f("form",{onSubmit:be(O,["prevent"]),class:"space-y-6"},[j.isSuperAdmin?(u(),f("div",Jl,[r(R,null,{default:n(()=>s[21]||(s[21]=[c("Company Name")])),_:1}),X(t("select",{"onUpdate:modelValue":s[0]||(s[0]=b=>l(i).tenant_id=b),class:"select-base"},[s[22]||(s[22]=t("option",{value:null,disabled:""},"Select Company",-1)),(u(!0),f(M,null,z(j.tenants,b=>(u(),f("option",{key:b.id,value:b.id},g(b.name),9,ea))),128))],512),[[ee,l(i).tenant_id]]),r(H,{message:l(i).errors.tenant_id},null,8,["message"])])):_("",!0),t("div",null,[r(R,null,{default:n(()=>s[23]||(s[23]=[c("Date")])),_:1}),r(l(Y),{type:"date",modelValue:l(i).date,"onUpdate:modelValue":s[1]||(s[1]=b=>l(i).date=b),class:"w-full"},null,8,["modelValue"]),r(H,{message:l(i).errors.date},null,8,["message"])]),t("div",ta,[t("div",null,[r(R,{for:"disputed"},{default:n(()=>s[24]||(s[24]=[c("Disputed")])),_:1}),X(t("select",{id:"disputed","onUpdate:modelValue":s[2]||(s[2]=b=>l(i).disputed=b),class:"select-base"},s[25]||(s[25]=[t("option",{value:"none"},"None",-1),t("option",{value:"pending"},"Pending",-1),t("option",{value:"won"},"Won",-1),t("option",{value:"lost"},"Lost",-1)]),512),[[ee,l(i).disputed]]),r(H,{message:l(i).errors.disputed},null,8,["message"])]),t("div",null,[r(R,{for:"carrier_controllable"},{default:n(()=>s[26]||(s[26]=[c("Carrier Controllable")])),_:1}),X(t("select",{id:"carrier_controllable","onUpdate:modelValue":s[3]||(s[3]=b=>l(i).carrier_controllable=b),class:"select-base"},s[27]||(s[27]=[t("option",{value:!0},"Yes",-1),t("option",{value:!1},"No",-1)]),512),[[ee,l(i).carrier_controllable]]),r(H,{message:l(i).errors.carrier_controllable},null,8,["message"])]),t("div",null,[r(R,{for:"driver_controllable"},{default:n(()=>s[28]||(s[28]=[c("Driver Controllable")])),_:1}),X(t("select",{id:"driver_controllable","onUpdate:modelValue":s[4]||(s[4]=b=>l(i).driver_controllable=b),class:"select-base"},s[29]||(s[29]=[t("option",{value:!0},"Yes",-1),t("option",{value:!1},"No",-1)]),512),[[ee,l(i).driver_controllable]]),r(H,{message:l(i).errors.driver_controllable},null,8,["message"])]),t("div",null,[r(R,{for:"rejection_reason"},{default:n(()=>s[30]||(s[30]=[c("Rejection Reason")])),_:1}),r(l(Y),{id:"rejection_reason",modelValue:l(i).rejection_reason,"onUpdate:modelValue":s[5]||(s[5]=b=>l(i).rejection_reason=b),placeholder:"Optional reason...",class:"w-full"},null,8,["modelValue"]),r(H,{message:l(i).errors.rejection_reason},null,8,["message"])])]),t("div",null,[r(R,null,{default:n(()=>s[31]||(s[31]=[c("Rejection Type")])),_:1}),t("div",la,[(u(),f(M,null,z(I,b=>r(U,{type:"button",key:b.value,variant:l(i).type===b.value?"default":"outline",size:"sm",onClick:Z=>l(i).type=b.value},{default:n(()=>[c(g(b.label),1)]),_:2},1032,["variant","onClick"])),64))]),r(H,{message:l(i).errors.type},null,8,["message"])]),l(i).type==="advanced_block"?(u(),f("div",aa,[s[37]||(s[37]=t("p",{class:"col-span-full text-sm font-semibold text-muted-foreground"},"Advanced Block Details",-1)),t("div",null,[r(R,null,{default:n(()=>s[32]||(s[32]=[c("Advance Block Rejection ID")])),_:1}),r(l(Y),{modelValue:l(i).advance_block_rejection_id,"onUpdate:modelValue":s[6]||(s[6]=b=>l(i).advance_block_rejection_id=b),class:"w-full"},null,8,["modelValue"]),r(H,{message:l(i).errors.advance_block_rejection_id},null,8,["message"])]),t("div",null,[r(R,null,{default:n(()=>s[33]||(s[33]=[c("Week Start")])),_:1}),r(l(Y),{type:"date",modelValue:l(i).week_start,"onUpdate:modelValue":s[7]||(s[7]=b=>l(i).week_start=b),class:"w-full"},null,8,["modelValue"]),r(H,{message:l(i).errors.week_start},null,8,["message"])]),t("div",null,[r(R,null,{default:n(()=>s[34]||(s[34]=[c("Week End")])),_:1}),r(l(Y),{type:"date",modelValue:l(i).week_end,"onUpdate:modelValue":s[8]||(s[8]=b=>l(i).week_end=b),class:"w-full"},null,8,["modelValue"]),r(H,{message:l(i).errors.week_end},null,8,["message"])]),t("div",null,[r(R,null,{default:n(()=>s[35]||(s[35]=[c("Impacted Blocks")])),_:1}),r(l(Y),{type:"number",min:"0",modelValue:l(i).impacted_blocks,"onUpdate:modelValue":s[9]||(s[9]=b=>l(i).impacted_blocks=b),class:"w-full"},null,8,["modelValue"]),r(H,{message:l(i).errors.impacted_blocks},null,8,["message"])]),t("div",null,[r(R,null,{default:n(()=>s[36]||(s[36]=[c("Expected Blocks")])),_:1}),r(l(Y),{type:"number",min:"0",modelValue:l(i).expected_blocks,"onUpdate:modelValue":s[10]||(s[10]=b=>l(i).expected_blocks=b),class:"w-full"},null,8,["modelValue"]),r(H,{message:l(i).errors.expected_blocks},null,8,["message"])])])):_("",!0),l(i).type==="block"?(u(),f("div",ra,[s[43]||(s[43]=t("p",{class:"col-span-full text-sm font-semibold text-muted-foreground"},"Block Details",-1)),t("div",null,[r(R,null,{default:n(()=>s[38]||(s[38]=[c("Block ID")])),_:1}),r(l(Y),{modelValue:l(i).block_id,"onUpdate:modelValue":s[11]||(s[11]=b=>l(i).block_id=b),class:"w-full"},null,8,["modelValue"]),r(H,{message:l(i).errors.block_id},null,8,["message"])]),t("div",null,[r(R,null,{default:n(()=>s[39]||(s[39]=[c("Driver Name")])),_:1}),r(l(Y),{modelValue:l(i).block_driver_name,"onUpdate:modelValue":s[12]||(s[12]=b=>l(i).block_driver_name=b),class:"w-full"},null,8,["modelValue"]),r(H,{message:l(i).errors.block_driver_name},null,8,["message"])]),t("div",null,[r(R,null,{default:n(()=>s[40]||(s[40]=[c("Block Start")])),_:1}),r(l(Y),{type:"datetime-local",modelValue:l(i).block_start,"onUpdate:modelValue":s[13]||(s[13]=b=>l(i).block_start=b),class:"w-full"},null,8,["modelValue"]),r(H,{message:l(i).errors.block_start},null,8,["message"])]),t("div",null,[r(R,null,{default:n(()=>s[41]||(s[41]=[c("Block End")])),_:1}),r(l(Y),{type:"datetime-local",modelValue:l(i).block_end,"onUpdate:modelValue":s[14]||(s[14]=b=>l(i).block_end=b),class:"w-full"},null,8,["modelValue"]),r(H,{message:l(i).errors.block_end},null,8,["message"])]),t("div",null,[r(R,null,{default:n(()=>s[42]||(s[42]=[c("Rejection Date/Time")])),_:1}),r(l(Y),{type:"datetime-local",modelValue:l(i).rejection_datetime,"onUpdate:modelValue":s[15]||(s[15]=b=>l(i).rejection_datetime=b),class:"w-full"},null,8,["modelValue"]),r(H,{message:l(i).errors.rejection_datetime},null,8,["message"])])])):_("",!0),l(i).type==="load"?(u(),f("div",na,[s[49]||(s[49]=t("p",{class:"col-span-full text-sm font-semibold text-muted-foreground"},"Load Details",-1)),t("div",null,[r(R,null,{default:n(()=>s[44]||(s[44]=[c("Load ID")])),_:1}),r(l(Y),{modelValue:l(i).load_id,"onUpdate:modelValue":s[16]||(s[16]=b=>l(i).load_id=b),class:"w-full"},null,8,["modelValue"]),r(H,{message:l(i).errors.load_id},null,8,["message"])]),t("div",null,[r(R,null,{default:n(()=>s[45]||(s[45]=[c("Driver Name")])),_:1}),r(l(Y),{modelValue:l(i).load_driver_name,"onUpdate:modelValue":s[17]||(s[17]=b=>l(i).load_driver_name=b),class:"w-full"},null,8,["modelValue"]),r(H,{message:l(i).errors.load_driver_name},null,8,["message"])]),t("div",null,[r(R,null,{default:n(()=>s[46]||(s[46]=[c("Origin Yard Arrival")])),_:1}),r(l(Y),{type:"datetime-local",modelValue:l(i).origin_yard_arrival,"onUpdate:modelValue":s[18]||(s[18]=b=>l(i).origin_yard_arrival=b),class:"w-full"},null,8,["modelValue"]),r(H,{message:l(i).errors.origin_yard_arrival},null,8,["message"])]),t("div",null,[r(R,null,{default:n(()=>s[47]||(s[47]=[c("Load Rejection Bucket")])),_:1}),X(t("select",{"onUpdate:modelValue":s[19]||(s[19]=b=>l(i).load_rejection_bucket=b),class:"select-base"},s[48]||(s[48]=[t("option",{value:""},"— Select —",-1),t("option",{value:"rejected_after_start_time"},"After Start Time",-1),t("option",{value:"rejected_0_6_hours_before_start_time"},"0–6 Hours Before Start",-1),t("option",{value:"rejected_6_plus_hours_before_start_time"},"6+ Hours Before Start",-1)]),512),[[ee,l(i).load_rejection_bucket]]),r(H,{message:l(i).errors.load_rejection_bucket},null,8,["message"])])])):_("",!0),t("div",sa,[r(U,{type:"button",onClick:s[20]||(s[20]=b=>T("close")),variant:"outline",class:"w-full sm:w-auto"},{default:n(()=>s[50]||(s[50]=[c(" Cancel ")])),_:1}),r(U,{type:"submit",disabled:l(i).processing,class:"w-full sm:w-auto"},{default:n(()=>[c(g(l(i).id?"Update":"Create"),1)]),_:1},8,["disabled"])])],32))}}),ia=Ee(oa,[["__scopeId","data-v-bf916ea7"]]),ua={class:"w-full md:max-w-2xl lg:max-w-3xl xl:max-w-6xl lg:mx-auto m-0 p-2 md:p-4 lg:p-6 space-y-2 md:space-y-4 lg:space-y-6"},da={class:"mb-2 flex flex-col items-center justify-between px-2 sm:flex-row md:mb-4 lg:mb-6"},ca={class:"flex flex-wrap gap-3 ml-3"},ma=["action"],pa={class:"flex flex-col items-center gap-2 md:items-start"},fa={class:"flex flex-wrap gap-1 md:gap-2"},va={key:0,class:"text-sm text-muted-foreground"},ba={key:0},ga={key:1},_a={key:2},ya={key:3,class:"ml-1"},xa={class:"flex items-center justify-between"},ka={class:"flex items-center gap-3 flex-wrap"},wa={class:"flex items-center rounded-lg border border-input bg-muted p-0.5 gap-0.5"},ja={key:0,class:"flex flex-wrap gap-2"},Sa={key:0,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold"},ha={key:1,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold"},Ca={key:2,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold"},$a={key:3,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold capitalize"},Da={key:4,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold"},Va={key:5,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold"},Aa={key:6,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold"},Ra={class:"flex flex-col gap-3 md:gap-4"},Ta={class:"grid w-full grid-cols-1 gap-3 sm:grid-cols-3 md:gap-4"},Ba={class:"grid w-full grid-cols-1 gap-3 sm:grid-cols-3 md:gap-4"},Fa={class:"grid w-full grid-cols-1 gap-3 sm:grid-cols-2 md:gap-4"},Na={class:"flex justify-end space-x-2"},Ma={class:"overflow-x-auto"},Ia={class:"flex items-center justify-center"},La=["checked"],Ua={class:"flex items-center gap-1"},Ea={key:0},Pa={key:0,class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Oa={key:1,class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Ha={key:1,class:"opacity-40"},Wa=["value"],Ya={class:"flex space-x-2"},za={key:0,class:"border-t bg-muted/20 px-4 py-3"},qa={class:"flex flex-col items-center justify-between gap-2 sm:flex-row"},Ga={class:"flex items-center gap-4 text-sm text-muted-foreground"},Ka={class:"flex items-center gap-2"},Qa=["value"],Xa={class:"flex flex-wrap"},Za=["innerHTML"],Ja={__name:"Index",props:{rejections:{type:Object,default:()=>({data:[],links:[],total:0})},tenantSlug:{type:String,default:null},tenants:{type:Array,default:()=>[]},isSuperAdmin:{type:Boolean,default:!1},dateFilter:{type:String,default:"yesterday"},dateRange:{type:Object,default:()=>({})},perPage:{type:Number,default:10},weekNumber:{type:Number,default:null},startWeekNumber:{type:Number,default:null},endWeekNumber:{type:Number,default:null},year:{type:Number,default:null},rejection_breakdown:{type:Object,default:null},line_chart_data:{type:Array,default:()=>[]},average_acceptance:{type:Number,default:null},filters:{type:Object,default:()=>({search:"",rejectionType:"",rejectionBucket:"",disputed:"",carrierControllable:"",driverControllable:"",penaltyMin:"",penaltyMax:"",rejectionReasonFilter:"with_reason"})},permissions:{type:Array,default:()=>[]}},setup(j){var He,We,Ye,ze,qe,Ge,Ke,Qe,Xe;const o=j,S=N(!1),T=N(null),I=N(""),E=N(""),w=N(o.dateFilter||"quarterly"),h=N(o.perPage||10),B=N([]),D=N(!1),i=N(!1),O=N(null),d=N(null),s=N(!1),b=N(!1),Z=N("date"),x=N("desc"),v=N({search:((He=o.filters)==null?void 0:He.search)??"",rejectionType:((We=o.filters)==null?void 0:We.rejectionType)??"",rejectionBucket:((Ye=o.filters)==null?void 0:Ye.rejectionBucket)??"",disputed:((ze=o.filters)==null?void 0:ze.disputed)??"",carrierControllable:((qe=o.filters)==null?void 0:qe.carrierControllable)??"",driverControllable:((Ge=o.filters)==null?void 0:Ge.driverControllable)??"",penaltyMin:((Ke=o.filters)==null?void 0:Ke.penaltyMin)??"",penaltyMax:((Qe=o.filters)==null?void 0:Qe.penaltyMax)??"",rejectionReasonFilter:((Xe=o.filters)==null?void 0:Xe.rejectionReasonFilter)??"with_reason"}),re=[{title:o.tenantSlug?"Dashboard":"Admin Dashboard",href:o.tenantSlug?route("dashboard",{tenantSlug:o.tenantSlug}):route("admin.dashboard")},{title:"Acceptance",href:o.tenantSlug?route("acceptance.index",{tenantSlug:o.tenantSlug}):route("acceptance.index.admin")}];function P(a){var e;return((e=a.advanced_rejected_block)==null?void 0:e[0])??null}function Q(a){var e;return((e=a.rejected_block)==null?void 0:e[0])??null}function te(a){var e;return((e=a.rejected_load)==null?void 0:e[0])??null}function ce(a){return P(a)?"advanced_block":te(a)?"load":Q(a)?"block":"unknown"}function me(a){return{advanced_block:"Advanced Block",block:"Block",load:"Load",unknown:"—"}[a]??a}function ye(a){return{more_than_24:"24+ hours before start",less_than_24:"Less than 24 hours before start",rejected_after_start_time:"Rejected after start time",rejected_0_6_hours_before_start_time:"Rejected 0–6 hours before start",rejected_6_plus_hours_before_start_time:"Rejected 6+ hours before start"}[a]??a??"—"}function ie(a){if(!a)return"—";const e=String(a).split(" ")[0],[C,p,L]=e.split("-");return!C||!p||!L?a:`${Number(p)}/${Number(L)}/${C}`}function pe(a){if(!a)return"—";try{return new Date(a).toLocaleString("en-US",{month:"numeric",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{return a}}const fe=[{key:"date",label:"Date",shared:!0,getValue:a=>ie(a.date)},{key:"type",label:"Type",shared:!0,getValue:a=>ce(a),render:a=>{const e=ce(a),C={advanced_block:"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300",block:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300",load:"bg-amber-100 text-amber-700 dark:bg-amber-900/30 dark:text-amber-300",unknown:"bg-muted text-muted-foreground"}[e]??"bg-muted text-muted-foreground";return se("span",{class:`inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium ${C}`},me(e))}},{key:"penalty",label:"Penalty",shared:!0,getValue:a=>a.penalty!=null?`${Number(a.penalty).toFixed(2)}`:null,render:a=>a.penalty!=null?se("span",{class:"font-mono text-xs"},`${Number(a.penalty).toFixed(2)}`):se("span",{class:"text-muted-foreground"},"—")},{key:"disputed",label:"Disputed",shared:!0,getValue:a=>a.disputed||null,render:a=>{const e={none:"bg-muted text-muted-foreground",pending:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-300",won:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300",lost:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300"}[a.disputed]??"bg-muted text-muted-foreground";return se("span",{class:`inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium capitalize ${e}`},a.disputed||"none")}},{key:"carrier_controllable",label:"Carrier Ctrl.",shared:!0,getValue:a=>a.carrier_controllable!=null?a.carrier_controllable?"Yes":"No":null},{key:"driver_controllable",label:"Driver Ctrl.",shared:!0,getValue:a=>a.driver_controllable!=null?a.driver_controllable?"Yes":"No":null},{key:"rejection_reason",label:"Reason",shared:!0,getValue:a=>a.rejection_reason||null,render:a=>a.rejection_reason?se("span",{class:"block max-w-[180px] truncate",title:a.rejection_reason},a.rejection_reason):se("span",{class:"text-muted-foreground"},"—")},{key:"ab_rejection_id",label:"Adv. Rejection ID",shared:!1,getValue:a=>{var e;return((e=P(a))==null?void 0:e.advance_block_rejection_id)??null}},{key:"ab_week_start",label:"Week Start",shared:!1,getValue:a=>{var e;return(e=P(a))!=null&&e.week_start?ie(P(a).week_start):null}},{key:"ab_week_end",label:"Week End",shared:!1,getValue:a=>{var e;return(e=P(a))!=null&&e.week_end?ie(P(a).week_end):null}},{key:"ab_impacted_blocks",label:"Impacted Blocks",shared:!1,getValue:a=>{var e;return((e=P(a))==null?void 0:e.impacted_blocks)!=null?String(P(a).impacted_blocks):null}},{key:"ab_expected_blocks",label:"Expected Blocks",shared:!1,getValue:a=>{var e;return((e=P(a))==null?void 0:e.expected_blocks)!=null?String(P(a).expected_blocks):null}},{key:"b_block_id",label:"Block ID",shared:!1,getValue:a=>{var e;return((e=Q(a))==null?void 0:e.block_id)??null}},{key:"b_driver_name",label:"Driver Name",shared:!1,getValue:a=>{var e;return((e=Q(a))==null?void 0:e.driver_name)??null}},{key:"b_block_start",label:"Block Start",shared:!1,getValue:a=>{var e;return(e=Q(a))!=null&&e.block_start?pe(Q(a).block_start):null}},{key:"b_block_end",label:"Block End",shared:!1,getValue:a=>{var e;return(e=Q(a))!=null&&e.block_end?pe(Q(a).block_end):null}},{key:"b_rejection_datetime",label:"Rejection Time",shared:!1,getValue:a=>{var e;return(e=Q(a))!=null&&e.rejection_datetime?pe(Q(a).rejection_datetime):null}},{key:"b_rejection_bucket",label:"Bucket",shared:!1,getValue:a=>{var e;return(e=Q(a))!=null&&e.rejection_bucket?ye(Q(a).rejection_bucket):null}},{key:"l_load_id",label:"Load ID",shared:!1,getValue:a=>{var e;return((e=te(a))==null?void 0:e.load_id)??null}},{key:"l_driver_name",label:"Driver Name",shared:!1,getValue:a=>{var e;return((e=te(a))==null?void 0:e.driver_name)??null}},{key:"l_origin_yard_arrival",label:"Yard Arrival",shared:!1,getValue:a=>{var e;return(e=te(a))!=null&&e.origin_yard_arrival?pe(te(a).origin_yard_arrival):null}},{key:"l_rejection_bucket",label:"Bucket",shared:!1,getValue:a=>{var e;return(e=te(a))!=null&&e.rejection_bucket?ye(te(a).rejection_bucket):null}}],Be=Te({props:{col:String,rejection:Object},setup(a){return()=>{const e=fe.find(p=>p.key===a.col);if(!e)return se("span",{class:"text-muted-foreground"},"—");if(e.render)return e.render(a.rejection);const C=e.getValue(a.rejection);return C?se("span",{},C):se("span",{class:"text-muted-foreground"},"—")}}}),xe=V(()=>{const a=ne.value;return a.length?fe.filter(e=>e.shared?!0:a.some(C=>{const p=e.getValue(C);return p!==null&&p!==""&&p!=="—"})):fe.filter(e=>e.shared)}),we=V(()=>{let a=xe.value.length;return o.isSuperAdmin&&(a+=1),G.value.includes("acceptance.delete")&&(a+=1),(G.value.includes("acceptance.update")||G.value.includes("acceptance.delete"))&&(a+=1),a}),ne=V(()=>[...o.rejections.data??[]].sort((e,C)=>{const p=fe.find(ft=>ft.key===Z.value),L=p?p.getValue(e)??"":"",y=p?p.getValue(C)??"":"";if(L==="—"||L==="")return 1;if(y==="—"||y==="")return-1;const ke=String(L).toLowerCase()<String(y).toLowerCase()?-1:String(L).toLowerCase()>String(y).toLowerCase()?1:0;return x.value==="asc"?ke:-ke}));function Fe(a){Z.value===a?x.value=x.value==="asc"?"desc":"asc":(Z.value=a,x.value="asc")}const je=V(()=>{var p,L;if(!T.value)return null;const a=T.value,e=ce(a),C={id:a.id,tenant_id:a.tenant_id,date:a.date,disputed:a.disputed??"none",carrier_controllable:a.carrier_controllable,driver_controllable:a.driver_controllable,rejection_reason:a.rejection_reason??"",penalty:a.penalty,type:e};if(e==="advanced_block"){const y=P(a);return{...C,advance_block_rejection_id:(y==null?void 0:y.advance_block_rejection_id)??"",week_start:((p=y==null?void 0:y.week_start)==null?void 0:p.split(" ")[0])??"",week_end:((L=y==null?void 0:y.week_end)==null?void 0:L.split(" ")[0])??"",impacted_blocks:(y==null?void 0:y.impacted_blocks)??"",expected_blocks:(y==null?void 0:y.expected_blocks)??""}}if(e==="block"){const y=Q(a);return{...C,block_id:(y==null?void 0:y.block_id)??"",block_driver_name:(y==null?void 0:y.driver_name)??"",block_start:(y==null?void 0:y.block_start)??"",block_end:(y==null?void 0:y.block_end)??"",rejection_datetime:(y==null?void 0:y.rejection_datetime)??""}}if(e==="load"){const y=te(a);return{...C,load_id:(y==null?void 0:y.load_id)??"",load_driver_name:(y==null?void 0:y.driver_name)??"",origin_yard_arrival:(y==null?void 0:y.origin_yard_arrival)??"",load_rejection_bucket:(y==null?void 0:y.rejection_bucket)??""}}return C}),k=V(()=>!!v.value.search||!!v.value.rejectionType||!!v.value.rejectionBucket||!!v.value.disputed||!!v.value.carrierControllable||!!v.value.driverControllable||!!v.value.penaltyMin||!!v.value.penaltyMax||v.value.rejectionReasonFilter!=="with_reason");V(()=>{const a=v.value.rejectionType,e=[{value:"rejected_after_start_time",label:"After Start Time"},{value:"rejected_0_6_hours_before_start_time",label:"0–6 Hours Before"},{value:"rejected_6_plus_hours_before_start_time",label:"6+ Hours Before"}],C=[{value:"less_than_24",label:"Less Than 24 Hours Before"},{value:"more_than_24",label:"24+ Hours Before"}];return a==="load"?e:a==="block"?C:[...e,...C]}),de(()=>v.value.rejectionType,()=>{v.value.rejectionBucket=""});function m(a){v.value.rejectionReasonFilter=a,F()}function F(a={}){const e=o.tenantSlug?"acceptance.index":"acceptance.index.admin",C=o.tenantSlug?{tenantSlug:o.tenantSlug}:{};return Ne.get(route(e,C),{...v.value,perPage:h.value,dateFilter:w.value,...a},{preserveState:!0,preserveScroll:!0})}function J(){F()}function le(a){w.value=a,F({dateFilter:a})}function A(){F()}function q(){v.value={search:"",rejectionType:"",rejectionBucket:"",disputed:"",carrierControllable:"",driverControllable:"",penaltyMin:"",penaltyMax:"",rejectionReasonFilter:"with_reason"},F()}function ve(a){if(!a)return;const e=new URL(a);F({page:e.searchParams.get("page")||1})}const Pe=V(()=>["yesterday","current-week"].includes(w.value)&&o.weekNumber&&o.year?`Week ${o.weekNumber}, ${o.year}`:["6w","quarterly"].includes(w.value)&&o.startWeekNumber&&o.endWeekNumber&&o.year?`Weeks ${o.startWeekNumber}–${o.endWeekNumber}, ${o.year}`:""),G=V(()=>o.permissions.map(a=>a.name));function Oe(a=null){T.value=a,S.value=!0}function et(){S.value=!1,E.value=T.value?"Rejection updated successfully.":"Rejection created successfully."}function tt(a){O.value=a,i.value=!0}function lt(a){const e=Me({}),C=o.isSuperAdmin?"acceptance.destroy.admin":"acceptance.destroy",p=o.isSuperAdmin?{rejection:a}:{tenantSlug:o.tenantSlug,rejection:a};e.delete(route(C,p),{preserveScroll:!0,onSuccess:()=>{E.value="Rejection deleted successfully.",i.value=!1}})}const at=V(()=>ne.value.length>0&&B.value.length===ne.value.length);function rt(a){B.value=a.target.checked?ne.value.map(e=>e.id):[]}function nt(){B.value.length>0&&(D.value=!0)}function st(){const a=Me({ids:B.value}),e=o.isSuperAdmin?"acceptance.destroyBulk.admin":"acceptance.destroyBulk",C=o.isSuperAdmin?{}:{tenantSlug:o.tenantSlug};a.delete(route(e,C),{preserveScroll:!0,onSuccess:()=>{E.value=`${B.value.length} records deleted.`,B.value=[],D.value=!1}})}function ot(a){E.value=a}function it(a){I.value=a}const ut=V(()=>o.tenantSlug?route("acceptance.export",{tenantSlug:o.tenantSlug}):route("acceptance.export.admin"));function dt(){if(!ne.value.length){I.value="No data to export.";return}d.value&&d.value.submit()}const ct=V(()=>{var e;const a=(e=o.rejection_breakdown)==null?void 0:e.by_category;return a?{totalRejections:a.total_rejections??0,afterStartCount:a.after_start_count??0,moreThan24Count:a.more_than_24_count??0,within24Count:a.within_24_count??0,advancedRejectionCount:a.advanced_rejection_count??0,moreThan6Count:a.more_than_6_count??0,within6Count:a.within_6_count??0}:null}),mt=V(()=>{var e,C,p,L,y,ke;const a=v.value.rejectionType;return a==="load"?((C=(e=o.rejection_breakdown)==null?void 0:e.bottom_five_drivers)==null?void 0:C.load)??[]:a==="block"?((L=(p=o.rejection_breakdown)==null?void 0:p.bottom_five_drivers)==null?void 0:L.block)??[]:((ke=(y=o.rejection_breakdown)==null?void 0:y.bottom_five_drivers)==null?void 0:ke.total)??[]}),pt=V(()=>{var a;return(a=o.line_chart_data)!=null&&a.length?{labels:o.line_chart_data.map(e=>e.date),datasets:[{label:"Acceptance Performance",data:o.line_chart_data.map(e=>e.acceptancePerformance),borderColor:"#3b82f6",backgroundColor:"rgba(59,130,246,0.1)",tension:.3}]}:{labels:[],datasets:[]}});return de(E,a=>{a&&setTimeout(()=>{E.value=""},5e3)}),de(I,a=>{a&&setTimeout(()=>{I.value=""},5e3)}),Je(()=>{const a=e=>e.preventDefault();window.addEventListener("dragover",a),window.addEventListener("drop",a),_t(()=>{window.removeEventListener("dragover",a),window.removeEventListener("drop",a)})}),(a,e)=>(u(),$(ht,{breadcrumbs:re,tenantSlug:j.tenantSlug,permissions:o.permissions},{default:n(()=>{var C;return[r(l(kt),{title:"Acceptance"}),t("div",ua,[E.value?(u(),$(l(Ve),{key:0,variant:"success"},{default:n(()=>[r(l(Ae),null,{default:n(()=>e[31]||(e[31]=[c("Success")])),_:1}),r(l(Re),null,{default:n(()=>[c(g(E.value),1)]),_:1})]),_:1})):_("",!0),I.value?(u(),$(l(Ve),{key:1,variant:"destructive"},{default:n(()=>[r(l(Ae),null,{default:n(()=>e[32]||(e[32]=[c("Error")])),_:1}),r(l(Re),null,{default:n(()=>[c(g(I.value),1)]),_:1})]),_:1})):_("",!0),t("div",da,[e[36]||(e[36]=t("h1",{class:"text-lg font-bold text-gray-800 dark:text-gray-200 md:text-xl lg:text-2xl"}," Acceptance ",-1)),t("div",ca,[G.value.includes("acceptance.create")?(u(),$(U,{key:0,class:"px-2 py-0 md:px-4 md:py-2",onClick:e[0]||(e[0]=p=>Oe()),variant:"default"},{default:n(()=>[r(W,{name:"plus",class:"mr-1 h-4 w-4 md:mr-2"}),e[33]||(e[33]=c(" Add Rejection "))]),_:1})):_("",!0),B.value.length>0&&G.value.includes("acceptance.delete")?(u(),$(U,{key:1,class:"px-2 py-0 md:px-4 md:py-2",onClick:e[1]||(e[1]=p=>nt()),variant:"destructive"},{default:n(()=>[r(W,{name:"trash",class:"mr-1 h-4 w-4 md:mr-2"}),c(" Delete Selected ("+g(B.value.length)+") ",1)]),_:1})):_("",!0),G.value.includes("acceptance.import")?(u(),$(U,{key:2,variant:"secondary",class:"px-2 py-0 md:px-4 md:py-2 shadow-sm hover:shadow transition-all",onClick:e[2]||(e[2]=p=>b.value=!0)},{default:n(()=>[r(W,{name:"upload",class:"mr-1 h-4 w-4 md:mr-2"}),e[34]||(e[34]=c(" Import CSV "))]),_:1})):_("",!0),G.value.includes("acceptance.export")?(u(),$(U,{key:3,class:"px-2 py-0 md:px-4 md:py-2",onClick:be(dt,["prevent"]),variant:"outline"},{default:n(()=>[r(W,{name:"download",class:"mr-1 h-4 w-4 md:mr-2"}),e[35]||(e[35]=c(" Download CSV "))]),_:1})):_("",!0)])]),t("form",{ref_key:"exportForm",ref:d,action:ut.value,method:"GET",class:"hidden"},null,8,ma),r(l(ge),null,{default:n(()=>[r(l(_e),{class:"p-2 md:p-4 lg:p-6"},{default:n(()=>[t("div",pa,[t("div",fa,[r(U,{onClick:e[3]||(e[3]=p=>le("yesterday")),variant:"outline",size:"sm",class:K({"border-primary bg-primary/10 text-primary":w.value==="yesterday"})},{default:n(()=>e[37]||(e[37]=[c(" Yesterday ")])),_:1},8,["class"]),r(U,{onClick:e[4]||(e[4]=p=>le("current-week")),variant:"outline",size:"sm",class:K({"border-primary bg-primary/10 text-primary":w.value==="current-week"})},{default:n(()=>e[38]||(e[38]=[c(" WTD ")])),_:1},8,["class"]),r(U,{onClick:e[5]||(e[5]=p=>le("6w")),variant:"outline",size:"sm",class:K({"border-primary bg-primary/10 text-primary":w.value==="6w"})},{default:n(()=>e[39]||(e[39]=[c(" T6W ")])),_:1},8,["class"]),r(U,{onClick:e[6]||(e[6]=p=>le("quarterly")),variant:"outline",size:"sm",class:K({"border-primary bg-primary/10 text-primary":w.value==="quarterly"})},{default:n(()=>e[40]||(e[40]=[c(" Quarterly ")])),_:1},8,["class"])]),o.dateRange?(u(),f("div",va,[w.value==="yesterday"&&o.dateRange.start?(u(),f("span",ba," Showing data from "+g(ie(o.dateRange.start)),1)):o.dateRange.start&&o.dateRange.end?(u(),f("span",ga," Showing data from "+g(ie(o.dateRange.start))+" to "+g(ie(o.dateRange.end)),1)):(u(),f("span",_a,g(o.dateRange.label),1)),Pe.value?(u(),f("span",ya,"("+g(Pe.value)+")",1)):_("",!0)])):_("",!0)])]),_:1})]),_:1}),r(l(ge),{class:"mb-6"},{default:n(()=>[r(l(jt),{class:"p-2 md:p-4 lg:p-6"},{default:n(()=>[t("div",xa,[t("div",ka,[r(l(St),{class:"text-lg md:text-xl lg:text-2xl"},{default:n(()=>e[41]||(e[41]=[c("Filters")])),_:1}),t("div",wa,[t("button",{onClick:e[7]||(e[7]=p=>m("with_reason")),class:K(["rounded-md px-3 py-1 text-xs font-medium transition-all",v.value.rejectionReasonFilter==="with_reason"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"])}," Rejected ",2),t("button",{onClick:e[8]||(e[8]=p=>m("without_reason")),class:K(["rounded-md px-3 py-1 text-xs font-medium transition-all",v.value.rejectionReasonFilter==="without_reason"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"])}," Accepted ",2),t("button",{onClick:e[9]||(e[9]=p=>m("all")),class:K(["rounded-md px-3 py-1 text-xs font-medium transition-all",v.value.rejectionReasonFilter==="all"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"])}," All ",2)]),!s.value&&k.value?(u(),f("div",ja,[v.value.search?(u(),f("span",Sa," Search: "+g(v.value.search),1)):_("",!0),v.value.rejectionType?(u(),f("span",ha," Type: "+g(me(v.value.rejectionType)),1)):_("",!0),v.value.rejectionBucket?(u(),f("span",Ca," Bucket: "+g(ye(v.value.rejectionBucket)),1)):_("",!0),v.value.disputed?(u(),f("span",$a," Disputed: "+g(v.value.disputed),1)):_("",!0),v.value.carrierControllable?(u(),f("span",Da," Carrier: "+g(v.value.carrierControllable==="true"?"Yes":"No"),1)):_("",!0),v.value.driverControllable?(u(),f("span",Va," Driver: "+g(v.value.driverControllable==="true"?"Yes":"No"),1)):_("",!0),v.value.penaltyMin||v.value.penaltyMax?(u(),f("span",Aa," Penalty: "+g(v.value.penaltyMin||"0")+" – "+g(v.value.penaltyMax||"∞"),1)):_("",!0)])):_("",!0)]),r(U,{variant:"ghost",size:"sm",onClick:e[10]||(e[10]=p=>s.value=!s.value)},{default:n(()=>[c(g(s.value?"Hide Filters":"Show Filters")+" ",1),r(W,{name:s.value?"chevron-up":"chevron-down",class:"ml-2 h-4 w-4"},null,8,["name"])]),_:1})])]),_:1}),s.value?(u(),$(l(_e),{key:0,class:"p-2 md:p-4 lg:p-6"},{default:n(()=>[t("div",Ra,[t("div",Ta,[t("div",null,[r(l(R),{for:"search"},{default:n(()=>e[42]||(e[42]=[c("Search")])),_:1}),r(l(Y),{class:"h-9 w-full lg:h-10",id:"search",modelValue:v.value.search,"onUpdate:modelValue":e[11]||(e[11]=p=>v.value.search=p),type:"text",placeholder:"Driver name, Block ID, Load ID..."},null,8,["modelValue"])]),t("div",null,[r(l(R),{for:"rejectionType"},{default:n(()=>e[43]||(e[43]=[c("Rejection Type")])),_:1}),X(t("select",{id:"rejectionType","onUpdate:modelValue":e[12]||(e[12]=p=>v.value.rejectionType=p),class:"select-base",onChange:e[13]||(e[13]=p=>v.value.rejectionBucket="")},e[44]||(e[44]=[t("option",{value:""},"All Types",-1),t("option",{value:"advanced_block"},"Advanced Block",-1),t("option",{value:"block"},"Block",-1),t("option",{value:"load"},"Load",-1)]),544),[[ee,v.value.rejectionType]])]),t("div",null,[r(l(R),{for:"rejectionBucket"},{default:n(()=>e[45]||(e[45]=[c("Rejection Bucket")])),_:1}),X(t("select",{id:"rejectionBucket","onUpdate:modelValue":e[14]||(e[14]=p=>v.value.rejectionBucket=p),class:"select-base"},[e[51]||(e[51]=t("option",{value:""},"All Buckets",-1)),v.value.rejectionType==="load"||v.value.rejectionType===""?(u(),f(M,{key:0},[e[46]||(e[46]=t("option",{value:"rejected_after_start_time"},"After Start Time",-1)),e[47]||(e[47]=t("option",{value:"rejected_0_6_hours_before_start_time"},"0–6 Hours Before",-1)),e[48]||(e[48]=t("option",{value:"rejected_6_plus_hours_before_start_time"},"6+ Hours Before",-1))],64)):_("",!0),v.value.rejectionType==="block"||v.value.rejectionType===""?(u(),f(M,{key:1},[e[49]||(e[49]=t("option",{value:"less_than_24"},"Less Than 24 Hours Before",-1)),e[50]||(e[50]=t("option",{value:"more_than_24"},"24+ Hours Before",-1))],64)):_("",!0)],512),[[ee,v.value.rejectionBucket]])])]),t("div",Ba,[t("div",null,[r(l(R),{for:"disputed"},{default:n(()=>e[52]||(e[52]=[c("Disputed")])),_:1}),X(t("select",{id:"disputed","onUpdate:modelValue":e[15]||(e[15]=p=>v.value.disputed=p),class:"select-base"},e[53]||(e[53]=[t("option",{value:""},"All",-1),t("option",{value:"none"},"None",-1),t("option",{value:"pending"},"Pending",-1),t("option",{value:"won"},"Won",-1),t("option",{value:"lost"},"Lost",-1)]),512),[[ee,v.value.disputed]])]),t("div",null,[r(l(R),{for:"carrierControllable"},{default:n(()=>e[54]||(e[54]=[c("Carrier Controllable")])),_:1}),X(t("select",{id:"carrierControllable","onUpdate:modelValue":e[16]||(e[16]=p=>v.value.carrierControllable=p),class:"select-base"},e[55]||(e[55]=[t("option",{value:""},"All",-1),t("option",{value:"true"},"Yes",-1),t("option",{value:"false"},"No",-1)]),512),[[ee,v.value.carrierControllable]])]),t("div",null,[r(l(R),{for:"driverControllable"},{default:n(()=>e[56]||(e[56]=[c("Driver Controllable")])),_:1}),X(t("select",{id:"driverControllable","onUpdate:modelValue":e[17]||(e[17]=p=>v.value.driverControllable=p),class:"select-base"},e[57]||(e[57]=[t("option",{value:""},"All",-1),t("option",{value:"true"},"Yes",-1),t("option",{value:"false"},"No",-1)]),512),[[ee,v.value.driverControllable]])])]),t("div",Fa,[t("div",null,[r(l(R),{for:"penaltyMin"},{default:n(()=>e[58]||(e[58]=[c("Penalty Min")])),_:1}),r(l(Y),{class:"h-9 w-full lg:h-10",id:"penaltyMin",modelValue:v.value.penaltyMin,"onUpdate:modelValue":e[18]||(e[18]=p=>v.value.penaltyMin=p),type:"number",min:"0",placeholder:"e.g. 0"},null,8,["modelValue"])]),t("div",null,[r(l(R),{for:"penaltyMax"},{default:n(()=>e[59]||(e[59]=[c("Penalty Max")])),_:1}),r(l(Y),{class:"h-9 w-full lg:h-10",id:"penaltyMax",modelValue:v.value.penaltyMax,"onUpdate:modelValue":e[19]||(e[19]=p=>v.value.penaltyMax=p),type:"number",min:"0",placeholder:"e.g. 100"},null,8,["modelValue"])])]),t("div",Na,[r(U,{onClick:q,variant:"ghost",size:"sm"},{default:n(()=>[r(W,{name:"rotate_ccw",class:"mr-2 h-4 w-4"}),e[60]||(e[60]=c(" Reset Filters "))]),_:1}),r(U,{onClick:J,variant:"default",size:"sm"},{default:n(()=>[r(W,{name:"filter",class:"mr-2 h-4 w-4"}),e[61]||(e[61]=c(" Apply Filters "))]),_:1})])])]),_:1})):_("",!0)]),_:1}),o.isSuperAdmin?_("",!0):(u(),$(qt,{key:2,metricsData:ct.value||{},driversData:mt.value||[],chartData:pt.value||{},averageAcceptance:o.average_acceptance||null,currentDateFilter:((C=o.dateRange)==null?void 0:C.label)||"",currentFilters:v.value||{}},null,8,["metricsData","driversData","chartData","averageAcceptance","currentDateFilter","currentFilters"])),r(l(ge),{class:"mx-auto max-w-[95vw] overflow-x-auto md:max-w-[64vw] lg:max-w-full"},{default:n(()=>[r(l(_e),{class:"p-0"},{default:n(()=>[t("div",Ma,[r(l(Ie),{class:"relative h-[500px] overflow-auto"},{default:n(()=>[r(l(Le),null,{default:n(()=>[r(l(ue),{class:"sticky top-0 z-10 border-b bg-background hover:bg-background"},{default:n(()=>[G.value.includes("acceptance.delete")?(u(),$(l(oe),{key:0,class:"w-[50px]"},{default:n(()=>[t("div",Ia,[t("input",{type:"checkbox",onChange:rt,checked:at.value,class:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"},null,40,La)])]),_:1})):_("",!0),o.isSuperAdmin?(u(),$(l(oe),{key:1,class:"whitespace-nowrap"},{default:n(()=>e[62]||(e[62]=[c("Company")])),_:1})):_("",!0),(u(!0),f(M,null,z(xe.value,p=>(u(),$(l(oe),{key:p.key,class:"cursor-pointer whitespace-nowrap",onClick:L=>Fe(p.key)},{default:n(()=>[t("div",Ua,[c(g(p.label)+" ",1),Z.value===p.key?(u(),f("span",Ea,[x.value==="asc"?(u(),f("svg",Pa,e[63]||(e[63]=[t("path",{d:"M8 15l4-4 4 4"},null,-1)]))):(u(),f("svg",Oa,e[64]||(e[64]=[t("path",{d:"M16 9l-4 4-4-4"},null,-1)])))])):(u(),f("span",Ha,e[65]||(e[65]=[t("svg",{class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M8 10l4-4 4 4"}),t("path",{d:"M16 14l-4 4-4-4"})],-1)])))])]),_:2},1032,["onClick"]))),128)),G.value.includes("acceptance.update")||G.value.includes("acceptance.delete")?(u(),$(l(oe),{key:2},{default:n(()=>e[66]||(e[66]=[c(" Actions ")])),_:1})):_("",!0)]),_:1})]),_:1}),r(l(Ue),null,{default:n(()=>[ne.value.length===0?(u(),$(l(ue),{key:0},{default:n(()=>[r(l(ae),{colspan:we.value,class:"py-8 text-center text-primary font-medium"},{default:n(()=>e[67]||(e[67]=[c(" No rejections found matching your criteria ")])),_:1},8,["colspan"])]),_:1})):_("",!0),(u(!0),f(M,null,z(ne.value,p=>(u(),$(l(ue),{key:p.id,class:"hover:bg-muted/50"},{default:n(()=>[G.value.includes("acceptance.delete")?(u(),$(l(ae),{key:0,class:"text-center"},{default:n(()=>[X(t("input",{type:"checkbox",value:p.id,"onUpdate:modelValue":e[20]||(e[20]=L=>B.value=L),class:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"},null,8,Wa),[[yt,B.value]])]),_:2},1024)):_("",!0),o.isSuperAdmin?(u(),$(l(ae),{key:1,class:"whitespace-nowrap"},{default:n(()=>{var L;return[c(g(((L=p.tenant)==null?void 0:L.name)||"—"),1)]}),_:2},1024)):_("",!0),(u(!0),f(M,null,z(xe.value,L=>(u(),$(l(ae),{key:L.key,class:"whitespace-nowrap text-sm"},{default:n(()=>[r(l(Be),{col:L.key,rejection:p},null,8,["col","rejection"])]),_:2},1024))),128)),G.value.includes("acceptance.delete")||G.value.includes("acceptance.update")?(u(),$(l(ae),{key:2},{default:n(()=>[t("div",Ya,[G.value.includes("acceptance.update")?(u(),$(U,{key:0,size:"sm",onClick:L=>Oe(p),variant:"warning"},{default:n(()=>[r(W,{name:"pencil",class:"mr-1 h-4 w-4"}),e[68]||(e[68]=c(" Edit "))]),_:2},1032,["onClick"])):_("",!0),G.value.includes("acceptance.delete")?(u(),$(U,{key:1,size:"sm",variant:"destructive",onClick:L=>tt(p.id)},{default:n(()=>[r(W,{name:"trash",class:"mr-1 h-4 w-4"}),e[69]||(e[69]=c(" Delete "))]),_:2},1032,["onClick"])):_("",!0)])]),_:2},1024)):_("",!0)]),_:2},1024))),128))]),_:1})]),_:1})]),o.rejections.links?(u(),f("div",za,[t("div",qa,[t("div",Ga,[t("span",null," Showing "+g(o.rejections.data.length)+" of "+g(o.rejections.total)+" entries ",1),t("div",Ka,[e[70]||(e[70]=t("span",{class:"text-sm"},"Show:",-1)),X(t("select",{"onUpdate:modelValue":e[21]||(e[21]=p=>h.value=p),onChange:A,class:"h-8 rounded-md border border-input bg-background px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-ring"},[(u(),f(M,null,z([10,25,50,100],p=>t("option",{key:p,value:p},g(p),9,Qa)),64))],544),[[ee,h.value]])])]),t("div",Xa,[(u(!0),f(M,null,z(o.rejections.links,p=>(u(),$(U,{key:p.label,onClick:L=>ve(p.url),disabled:!p.url,variant:"ghost",size:"sm",class:K(["mx-1",{"border-primary bg-primary/10 text-primary":p.active}])},{default:n(()=>[t("span",{innerHTML:p.label},null,8,Za)]),_:2},1032,["onClick","disabled","class"]))),128))])])])):_("",!0)]),_:1})]),_:1}),r(l(Se),{open:S.value,"onUpdate:open":e[23]||(e[23]=p=>S.value=p)},{default:n(()=>[r(l(Ce),{class:"max-w-[95vw] sm:max-w-[90vw] md:max-w-4xl"},{default:n(()=>[r(l($e),{class:"px-4 sm:px-6"},{default:n(()=>[r(l(De),{class:"text-lg sm:text-xl"},{default:n(()=>[c(g(T.value?"Edit":"Add")+" Rejection ",1)]),_:1}),r(l(he),{class:"text-xs sm:text-sm"},{default:n(()=>[c(" Fill in the details to "+g(T.value?"update":"add")+" a rejection. ",1)]),_:1})]),_:1}),r(ia,{rejection:je.value,tenants:o.tenants,"is-super-admin":o.isSuperAdmin,"tenant-slug":o.tenantSlug,onClose:e[22]||(e[22]=p=>S.value=!1),onSuccess:et,class:"max-h-[75vh] overflow-y-auto p-4 sm:p-6"},null,8,["rejection","tenants","is-super-admin","tenant-slug"])]),_:1})]),_:1},8,["open"]),r(l(Se),{open:D.value,"onUpdate:open":e[26]||(e[26]=p=>D.value=p)},{default:n(()=>[r(l(Ce),{class:"max-w-[95vw] sm:max-w-md"},{default:n(()=>[r(l($e),{class:"px-4 sm:px-6"},{default:n(()=>[r(l(De),{class:"text-lg sm:text-xl"},{default:n(()=>e[71]||(e[71]=[c("Confirm Bulk Deletion")])),_:1}),r(l(he),{class:"text-xs sm:text-sm"},{default:n(()=>[c(" Are you sure you want to delete "+g(B.value.length)+" rejection records? This action cannot be undone. ",1)]),_:1})]),_:1}),r(l(Ze),{class:"px-4 sm:px-6"},{default:n(()=>[r(U,{type:"button",onClick:e[24]||(e[24]=p=>D.value=!1),variant:"outline"},{default:n(()=>e[72]||(e[72]=[c("Cancel")])),_:1}),r(U,{type:"button",onClick:e[25]||(e[25]=p=>st()),variant:"destructive"},{default:n(()=>e[73]||(e[73]=[c("Delete Selected")])),_:1})]),_:1})]),_:1})]),_:1},8,["open"]),r(l(Se),{open:i.value,"onUpdate:open":e[29]||(e[29]=p=>i.value=p)},{default:n(()=>[r(l(Ce),{class:"max-w-[95vw] sm:max-w-md"},{default:n(()=>[r(l($e),{class:"px-4 sm:px-6"},{default:n(()=>[r(l(De),{class:"text-lg sm:text-xl"},{default:n(()=>e[74]||(e[74]=[c("Confirm Deletion")])),_:1}),r(l(he),{class:"text-xs sm:text-sm"},{default:n(()=>e[75]||(e[75]=[c(" Are you sure you want to delete this rejection record? This action cannot be undone. ")])),_:1})]),_:1}),r(l(Ze),{class:"px-4 sm:px-6"},{default:n(()=>[r(U,{type:"button",onClick:e[27]||(e[27]=p=>i.value=!1),variant:"outline"},{default:n(()=>e[76]||(e[76]=[c("Cancel")])),_:1}),r(U,{type:"button",onClick:e[28]||(e[28]=p=>lt(O.value)),variant:"destructive"},{default:n(()=>e[77]||(e[77]=[c("Delete")])),_:1})]),_:1})]),_:1})]),_:1},8,["open"]),r(Xl,{open:b.value,"onUpdate:open":e[30]||(e[30]=p=>b.value=p),"is-super-admin":o.isSuperAdmin,"tenant-slug":o.tenantSlug,tenants:o.tenants,onSuccess:ot,onError:it},null,8,["open","is-super-admin","tenant-slug","tenants"])])]}),_:1},8,["tenantSlug","permissions"]))}},hr=Ee(Ja,[["__scopeId","data-v-a5de867f"]]);export{hr as default};
