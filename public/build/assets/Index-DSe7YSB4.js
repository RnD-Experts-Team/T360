import{d as Ct,w as De,L as u,e as o,X as t,k as v,l,f as a,S as i,D as H,Y as Q,u as s,M as k,N as R,U as c,P as _e,c as A,b2 as te,a1 as Dt,r as S,A as qe,bW as St,b as C,K as $t,bF as Nt}from"./vendor-cgn9wV4E.js";import{x as we,a as Tt,g as At,W as q}from"./vendor-vue-C6le94gM.js";import{_ as Se}from"./Input.vue_vue_type_script_setup_true_lang-1zH_gJ02.js";import{_ as w}from"./Button.vue_vue_type_script_setup_true_lang-DA-5a5tM.js";import{_ as Ft}from"./Checkbox.vue_vue_type_script_setup_true_lang-ChpZyGGS.js";import{_ as E}from"./Label.vue_vue_type_script_setup_true_lang-WOFpmVDV.js";import{_ as N}from"./Icon.vue_vue_type_script_setup_true_lang-g5QrAIpa.js";import{_ as Vt}from"./Badge.vue_vue_type_script_setup_true_lang-BpieHD20.js";import{_ as Ve,a as Me,b as oe,c as ee,d as je,e as X}from"./TableRow.vue_vue_type_script_setup_true_lang-58J5Q7id.js";import{_ as fe}from"./Card.vue_vue_type_script_setup_true_lang-DQTQMX6v.js";import{_ as Mt}from"./CardHeader.vue_vue_type_script_setup_true_lang-n-Rvhb9V.js";import{_ as jt}from"./CardTitle.vue_vue_type_script_setup_true_lang-AShXP1uR.js";import{_ as pe}from"./CardContent.vue_vue_type_script_setup_true_lang-DNXZ8J1r.js";import{b as ve,_ as ye,a as ge}from"./DialogDescription.vue_vue_type_script_setup_true_lang-BDOQqQHy.js";import{_ as xe,a as be}from"./DialogTitle.vue_vue_type_script_setup_true_lang-K_t0Wv0O.js";import{_ as Ae}from"./DialogFooter.vue_vue_type_script_setup_true_lang-C4cZ_wVx.js";import{b as Oe,_ as Ee,a as Ue}from"./AlertDescription.vue_vue_type_script_setup_true_lang-BdYx0SaG.js";import{_ as Ot}from"./AppLayout.vue_vue_type_script_setup_true_lang-BeAMINRz.js";import"./vendor-axios-C0Zqfgkc.js";import"./utils-C4uCeQPu.js";import"./vendor-ui-BuPyOEYe.js";import"./vendor-icons-Bu7C1ObZ.js";import"./useInitials-DzeGKvtI.js";import"./app-8KAEFqwr.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BM02NuXb.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Et={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},Ut={key:0,class:"col-span-full"},zt={class:"relative"},Pt=["value"],Rt={class:"col-span-full"},Bt={class:"relative"},Lt={class:"relative"},It={class:"relative"},Wt=["value"],Yt={class:"relative"},qt={class:"flex items-center space-x-2"},Ht={class:"flex-col space-y-2 sm:space-y-0 sm:flex-row sm:justify-end sm:space-x-2 pt-4 border-t flex"},Gt=Ct({__name:"DelayForm",props:{delay:{type:Object,default:null},delayCodes:{type:Array,default:()=>[]},tenants:{type:Array,default:()=>[]},isSuperAdmin:{type:Boolean,default:!1},tenantSlug:{type:String,default:null}},emits:["close"],setup(p,{emit:d}){var M,U,I,z,G,le,K;const h=p,V=d,f=we({id:(M=h.delay)==null?void 0:M.id,tenant_id:h.isSuperAdmin?(U=h.delay)==null?void 0:U.tenant_id:null,date:((I=h.delay)==null?void 0:I.date)||"",driver_name:((z=h.delay)==null?void 0:z.driver_name)||"",delay_type:((G=h.delay)==null?void 0:G.delay_type)||"origin",delay_category:((le=h.delay)==null?void 0:le.delay_category)||"1_60",delay_code_id:((K=h.delay)==null?void 0:K.delay_code_id)||null,disputed:h.delay&&h.delay.disputed!==null?parseInt(h.delay.disputed)===1:!1,driver_controllable:h.delay&&h.delay.driver_controllable!==null?parseInt(h.delay.driver_controllable)===1:null});De(()=>h.delay,D=>{D?(f.id=D.id,f.tenant_id=D.tenant_id,f.date=D.date,f.driver_name=D.driver_name,f.delay_type=D.delay_type,f.delay_category=D.delay_category,f.delay_code_id=D.delay_code_id,f.disputed=D.disputed!==null?parseInt(D.disputed)===1:!1,f.driver_controllable=D.driver_controllable!==null?parseInt(D.driver_controllable)===1:null):f.reset()},{immediate:!0});const F=()=>{const D=!!f.id,m=h.isSuperAdmin?D?"ontime.update.admin":"ontime.store.admin":D?"ontime.update":"ontime.store",x=h.isSuperAdmin?D?{delay:f.id}:{}:D?{tenantSlug:h.tenantSlug,delay:f.id}:{tenantSlug:h.tenantSlug};f[D?"put":"post"](route(m,x),{onSuccess:()=>V("close")})};return(D,m)=>(o(),u("form",{onSubmit:_e(F,["prevent"]),class:"space-y-6"},[t("div",Et,[p.isSuperAdmin?(o(),u("div",Ut,[l(E,null,{default:a(()=>m[9]||(m[9]=[i("Company Name")])),_:1}),t("div",zt,[H(t("select",{"onUpdate:modelValue":m[0]||(m[0]=x=>s(f).tenant_id=x),class:"flex h-10 w-full items-center rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 appearance-none"},[m[10]||(m[10]=t("option",{value:null,disabled:""},"Select Company",-1)),(o(!0),u(k,null,R(p.tenants,x=>(o(),u("option",{key:x.id,value:x.id},c(x.name),9,Pt))),128))],512),[[Q,s(f).tenant_id]]),m[11]||(m[11]=t("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"},[t("svg",{class:"h-4 w-4 opacity-50",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})])],-1))])])):v("",!0),t("div",Rt,[l(E,null,{default:a(()=>m[12]||(m[12]=[i("Date")])),_:1}),l(Se,{type:"date",modelValue:s(f).date,"onUpdate:modelValue":m[1]||(m[1]=x=>s(f).date=x),class:"w-full"},null,8,["modelValue"])]),t("div",null,[l(E,null,{default:a(()=>m[13]||(m[13]=[i("Driver Name")])),_:1}),l(Se,{modelValue:s(f).driver_name,"onUpdate:modelValue":m[2]||(m[2]=x=>s(f).driver_name=x),class:"w-full"},null,8,["modelValue"])]),t("div",null,[l(E,null,{default:a(()=>m[14]||(m[14]=[i("Delay Type")])),_:1}),t("div",Bt,[H(t("select",{"onUpdate:modelValue":m[3]||(m[3]=x=>s(f).delay_type=x),class:"flex h-10 w-full items-center rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 appearance-none"},m[15]||(m[15]=[t("option",{value:"origin"},"Origin",-1),t("option",{value:"destination"},"Destination",-1)]),512),[[Q,s(f).delay_type]]),m[16]||(m[16]=t("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"},[t("svg",{class:"h-4 w-4 opacity-50",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})])],-1))])]),t("div",null,[l(E,null,{default:a(()=>m[17]||(m[17]=[i("Delay Category")])),_:1}),t("div",Lt,[H(t("select",{"onUpdate:modelValue":m[4]||(m[4]=x=>s(f).delay_category=x),class:"flex h-10 w-full items-center rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 appearance-none"},m[18]||(m[18]=[t("option",{value:"1_60"},"1–60 min",-1),t("option",{value:"61_240"},"61–240 min",-1),t("option",{value:"241_600"},"241–600 min",-1),t("option",{value:"601_plus"},"601+ min",-1)]),512),[[Q,s(f).delay_category]]),m[19]||(m[19]=t("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"},[t("svg",{class:"h-4 w-4 opacity-50",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})])],-1))])]),t("div",null,[l(E,null,{default:a(()=>m[20]||(m[20]=[i("Delay Code")])),_:1}),t("div",It,[H(t("select",{"onUpdate:modelValue":m[5]||(m[5]=x=>s(f).delay_code_id=x),class:"flex h-10 w-full items-center rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 appearance-none"},[(o(!0),u(k,null,R(p.delayCodes,x=>(o(),u("option",{key:x.id,value:x.id},c(x.code),9,Wt))),128))],512),[[Q,s(f).delay_code_id]]),m[21]||(m[21]=t("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"},[t("svg",{class:"h-4 w-4 opacity-50",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})])],-1))])]),t("div",null,[l(E,null,{default:a(()=>m[22]||(m[22]=[i("Driver Controllable")])),_:1}),t("div",Yt,[H(t("select",{"onUpdate:modelValue":m[6]||(m[6]=x=>s(f).driver_controllable=x),class:"flex h-10 w-full items-center rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 appearance-none"},m[23]||(m[23]=[t("option",{value:null},"N/A",-1),t("option",{value:!0},"Yes",-1),t("option",{value:!1},"No",-1)]),512),[[Q,s(f).driver_controllable]]),m[24]||(m[24]=t("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"},[t("svg",{class:"h-4 w-4 opacity-50",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})])],-1))])]),t("div",qt,[l(Ft,{modelValue:s(f).disputed,"onUpdate:modelValue":m[7]||(m[7]=x=>s(f).disputed=x),id:"disputed"},null,8,["modelValue"]),l(E,{for:"disputed"},{default:a(()=>m[25]||(m[25]=[i("Disputed")])),_:1})])]),t("div",Ht,[l(w,{type:"button",onClick:m[8]||(m[8]=x=>V("close")),variant:"outline",class:"w-full sm:w-auto"},{default:a(()=>m[26]||(m[26]=[i(" Cancel ")])),_:1}),l(w,{type:"submit",disabled:s(f).processing,class:"w-full sm:w-auto"},{default:a(()=>[i(c(s(f).id?"Update":"Create"),1)]),_:1},8,["disabled"])])],32))}}),Kt={class:"bg-background rounded-lg border shadow-sm p-2 md:p-4 lg:p-6 flex flex-col items-center justify-center"},Qt={class:"text-base font-semibold mb-2 text-foreground"},Xt={__name:"TotalLateStops",props:{title:{type:String,required:!0},value:{type:[Number,String],required:!0}},setup(p){const d=p,h=A(()=>d.value===null||d.value===void 0||d.value===""?"No Data":d.value),V=A(()=>{const f=Number(d.value);return d.title.toLowerCase().includes("total")&&f>0});return(f,F)=>(o(),u("div",Kt,[t("h3",Qt,c(p.title),1),t("p",{class:te(["text-2xl font-bold",V.value?"text-red-600":"text-primary"])},c(h.value),3)]))}},Zt={class:"bg-background rounded-lg border shadow-sm p-2 md:p-4"},Jt={class:"text-base text-center font-semibold mb-2 md:mb-4"},el={key:0,class:"text-center text-sm py-4 text-primary font-medium"},tl={class:"space-y-3"},ll={class:"text-sm"},al={__name:"BottomDrivers",props:{title:{type:String,default:"Bottom 5 Drivers"},drivers:{type:Array,default:()=>[]},delayType:{type:String,default:""},totalDelays:{type:Number,default:-1}},setup(p){const d=p,h=V=>{const f=["#ef4444","#f97316","#f59e0b","#84cc16","#10b981"],M=[...d.drivers].sort((U,I)=>I.total_penalty-U.total_penalty).map(U=>U.total_penalty).indexOf(V);return f[M]||"#6b7280"};return(V,f)=>(o(),u("div",Zt,[t("h3",Jt,c(p.title),1),p.drivers.length===0?(o(),u("div",el,[p.totalDelays===0?(o(),u(k,{key:0},[p.delayType==="origin"?(o(),u(k,{key:0},[i(" No origin delays recorded. You're on track for Fantastic+ ! ")],64)):p.delayType==="destination"?(o(),u(k,{key:1},[i(" No destination delays recorded. You're on track for Fantastic+ ! ")],64)):(o(),u(k,{key:2},[i(" No delays recorded. You're on track for Fantastic+ ! ")],64))],64)):(o(),u(k,{key:1},[i(" No delays recorded. You're on track for Fantastic+ ! ")],64))])):(o(),u(k,{key:1},[f[0]||(f[0]=t("div",{class:"flex justify-between items-center mb-2"},[t("span",{class:"text-base mb-2 font-medium"},"Driver Name"),t("span",{class:"text-base mb-2 font-medium"},"Total Penalty")],-1)),t("div",tl,[(o(!0),u(k,null,R(p.drivers,(F,M)=>(o(),u("div",{key:M,class:"flex justify-between items-center"},[t("span",ll,c(F.driver_name),1),t("span",{class:"text-sm font-medium",style:Dt({color:h(F.total_penalty)})},c(F.total_penalty),5)]))),128))])],64))]))}},sl={class:"bg-background rounded-lg border shadow-sm p-2 md:p-4"},nl={class:"text-base text-center font-semibold mb-2 md:mb-4"},ol={class:"h-64"},rl={__name:"LineChart",props:{title:{type:String,default:"On-Time Score"},chartData:{type:Object,default:()=>({labels:[],datasets:[]})},averageOntime:{type:Number,default:null}},setup(p){const d=p,h=S(null);let V=null;const f=()=>{if(V&&V.destroy(),!h.value)return;const F=h.value.getContext("2d"),M=[];d.chartData.datasets.forEach(z=>{z.data&&z.data.length&&M.push(...z.data)});const U=M.length>0?Math.min(...M):0,I=M.length>0?Math.max(...M):100;V=new St(F,{type:"line",data:d.chartData,options:{responsive:!0,maintainAspectRatio:!1,layout:{padding:{left:15,right:15,top:10,bottom:10}},plugins:{legend:{position:!1},tooltip:{callbacks:{label:function(z){const G=z.raw||0,le=d.averageOntime||0,K=d.chartData.dateRangeLabel||"selected period",D=Number(le).toFixed(2);return[`On-Time Score: ${G}`,`Average Score Over ${K}: ${D}`]}}}},scales:{y:{beginAtZero:!(U>10),min:Math.max(Math.floor(U-5),0),max:Math.min(102,Math.ceil(I+5)),ticks:{stepSize:2.5,padding:10,font:{size:11},callback:function(z){return z<=100?z:""}},grid:{drawBorder:!0,color:"rgba(200, 200, 200, 0.2)"}},x:{ticks:{padding:10,font:{size:11}},grid:{drawBorder:!0,color:"rgba(200, 200, 200, 0.2)"}}}}})};return qe(()=>{f()}),De(()=>d.chartData,()=>{f()},{deep:!0}),(F,M)=>(o(),u("div",sl,[t("h3",nl,c(p.title),1),t("div",ol,[t("canvas",{ref_key:"chartCanvas",ref:h},null,512)])]))}},dl={class:"space-y-2 md:space-y-4 lg:space-y-6 mb-2 md:mb-4 lg:mb-6"},il={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-2 md:gap-4"},ul={class:"grid grid-cols-1 lg:grid-cols-4 gap-2 md:gap-4 lg:gap-6"},ml={key:1,class:"bg-background rounded-lg border shadow-sm p-4 md:p-6 lg:col-span-3 md:col-span-2 transition-all duration-300 hover:shadow-md flex flex-col justify-center"},cl={class:"flex flex-col sm:flex-row items-center justify-center sm:justify-around gap-3 mb-4"},fl={class:"text-xs text-muted-foreground text-center mt-2"},pl={key:2,class:"bg-background rounded-lg border shadow-sm p-4 md:p-6 lg:col-span-3 md:col-span-2 transition-all duration-300 hover:shadow-md flex flex-col justify-center items-center"},vl={class:"flex flex-col items-center justify-center gap-3 mb-4"},yl={__name:"OnTimeDashboard",props:{metricsData:{type:Object,default:()=>({})},driversData:{type:Array,default:()=>[]},chartData:{type:Object,default:()=>({})},averageOntime:{type:Number,default:null},currentDateFilter:{type:String,default:null},delayType:{type:String,default:"all"}},setup(p){const d=p,h=A(()=>d.metricsData&&d.metricsData.by_category?[{title:"Total Delayed Stops",value:d.metricsData.totalDelays},{title:"Delayed for 1-60 Minutes",value:d.metricsData.between1_60Count},{title:"Delayed for 61-240 Minutes",value:d.metricsData.between61_240Count},{title:"Delayed for 241-600 Minutes",value:d.metricsData.between241_600Count},{title:"Delayed for +601 Minutes",value:d.metricsData.moreThan601Count}]:[]),V=A(()=>d.metricsData&&Object.keys(d.metricsData).length>0&&d.metricsData.totalDelays>0),f=A(()=>d.driversData&&d.driversData.length?d.driversData:[]),F=A(()=>d.chartData&&Object.keys(d.chartData).length?d.chartData:{}),M=A(()=>{var y;return((y=d.metricsData)==null?void 0:y.totalDelays)||0}),U=A(()=>!d.chartData||!d.chartData.labels?!1:d.chartData.labels.length>1),I=A(()=>{var y,j,Z,O;return((O=(Z=(j=(y=d.chartData)==null?void 0:y.datasets)==null?void 0:j[0])==null?void 0:Z.data)==null?void 0:O.length)>0}),z=A(()=>I.value?d.chartData.datasets[0].data[0]:0),G=A(()=>{const y=z.value;return y>=98?"fantastic_plus":y>=95?"fantastic":y>=90?"good":y>=85?"fair":"poor"}),le=y=>y==null?"0%":`${Math.round(parseFloat(y))}%`,K=y=>{if(!y)return"Not Available";switch(y){case"fantastic_plus":return"Fantastic +";case"fantastic":return"Fantastic";case"good":return"Good";case"fair":return"Fair";case"poor":return"Poor";default:return y}},D=y=>{if(!y)return"outline";switch(y){case"fantastic_plus":return"fantastic-plus";case"fantastic":return"fantastic";case"good":return"good";case"fair":return"fair";case"poor":return"poor";default:return"outline"}},m=y=>{if(!y)return"text-gray-600";switch(y){case"fantastic_plus":return"text-green-600";case"fantastic":return"text-emerald-600";case"good":return"text-blue-600";case"fair":return"text-amber-600";case"poor":return"text-red-600";default:return"text-indigo-600"}},x=y=>{if(!y)return"";switch(y){case"fantastic_plus":return"Outstanding performance with exceptional on-time rate";case"fantastic":return"Excellent performance with very high on-time rate";case"good":return"Solid performance with good on-time rate";case"fair":return"Acceptable performance with room for improvement";case"poor":return"Performance needs significant improvement";default:return""}};return(y,j)=>(o(),u("div",dl,[t("div",il,[V.value?(o(!0),u(k,{key:0},R(h.value,(Z,O)=>(o(),C(Xt,{key:O,title:Z.title,value:Z.value,class:"transition-all duration-300 hover:shadow-md"},null,8,["title","value"]))),128)):v("",!0)]),t("div",ul,[l(al,{title:"Bottom 5 Drivers",drivers:f.value,delayType:p.delayType,totalDelays:M.value,class:te({"lg:col-span-1":U.value,"lg:col-span-1 md:col-span-1":!U.value,"transition-all duration-300 hover:shadow-md":!0})},null,8,["drivers","delayType","totalDelays","class"]),d.currentDateFilter!="Yesterday"&&U.value?(o(),C(rl,{key:0,title:"On-Time Score",chartData:F.value,averageOntime:p.averageOntime,class:"lg:col-span-3 md:col-span-2 transition-all duration-300 hover:shadow-md"},null,8,["chartData","averageOntime"])):v("",!0),!U.value&&I.value?(o(),u("div",ml,[j[0]||(j[0]=t("h3",{class:"text-base md:text-lg text-center font-semibold mb-4"},"On-Time Score",-1)),t("div",cl,[t("div",{class:te(["text-4xl md:text-5xl font-bold text-center",m(G.value)])},c(le(z.value)),3),l(s(Vt),{variant:D(G.value),class:"text-xs md:text-sm px-3 py-1"},{default:a(()=>[i(c(K(G.value)),1)]),_:1},8,["variant"])]),t("p",fl,c(x(G.value)),1)])):v("",!0),I.value?v("",!0):(o(),u("div",pl,[j[3]||(j[3]=t("h3",{class:"text-base md:text-lg text-center font-semibold mb-4"},"On-Time Score",-1)),t("div",vl,[l(N,{name:"chart_bar",class:"h-16 w-16 text-muted-foreground/50"}),j[1]||(j[1]=t("div",{class:"text-lg font-medium text-center text-primary"}," No data available ",-1)),j[2]||(j[2]=t("p",{class:"text-sm text-primary/70 text-center max-w-md"}," There is no on-time data available for the selected time period. Try selecting a different date range or check back later. ",-1))])]))])]))}},gl={class:"w-full md:max-w-2xl lg:max-w-3xl xl:max-w-6xl lg:mx-auto m-0 p-2 md:p-4 lg:p-6 space-y-2 md:space-y-4 lg:space-y-6"},xl={class:"mb-2 flex flex-col items-center justify-between px-2 sm:flex-row md:mb-4 lg:mb-6"},bl={class:"flex flex-wrap gap-3 ml-3"},_l=["action"],wl={class:"flex flex-col items-center gap-2 md:items-start"},kl={class:"flex flex-wrap gap-1 md:gap-2"},hl={key:0,class:"text-sm text-muted-foreground"},Cl={key:0},Dl={key:1},Sl={key:2},$l={key:3,class:"ml-1"},Nl={class:"flex items-center justify-between"},Tl={class:"flex items-center gap-2"},Al={key:0,class:"ml-4 flex flex-wrap gap-2"},Fl={key:0,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold"},Vl={key:1,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold"},Ml={key:2,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold"},jl={key:3,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold"},Ol={key:4,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold"},El={key:5,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold"},Ul={class:"flex flex-col justify-between gap-1 md:gap-4"},zl={class:"grid w-full grid-cols-1 gap-1 sm:grid-cols-3 md:gap-4"},Pl=["value"],Rl={class:"flex justify-end space-x-2"},Bl={class:"overflow-x-auto"},Ll={class:"flex items-center justify-center"},Il=["checked"],Wl={class:"flex items-center"},Yl={key:2,class:"ml-2"},ql={key:0,class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Hl={key:1,class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Gl={key:3,class:"ml-2 opacity-50"},Kl=["value"],Ql={key:0,class:"ml-1 text-xs text-red-500"},Xl={class:"flex justify-end space-x-2"},Zl={key:0,class:"border-t bg-muted/20 px-4 py-3"},Jl={class:"flex flex-col items-center justify-between gap-2 sm:flex-row"},ea={class:"text-sm text-muted-foreground"},ta={class:"flex w-full flex-col items-center gap-2 sm:w-auto sm:flex-row sm:gap-4"},la={class:"flex items-center gap-2"},aa={class:"flex flex-wrap"},sa=["innerHTML"],na={class:"max-h-[75vh] space-y-4 overflow-y-auto p-4 sm:p-6"},oa={class:"flex items-center justify-between"},ra={class:"max-h-[400px] overflow-y-auto rounded-md border"},da={key:0,class:"rounded-md border py-8 text-center text-xs text-muted-foreground sm:text-sm"},ia={key:1,class:"divide-y"},ua=["onClick"],ma={class:"text-xs font-medium sm:text-sm"},ca={key:0,class:"ml-2 text-[0.65rem] text-red-500 sm:text-xs"},fa={key:0,class:"mt-1 text-xs text-muted-foreground sm:text-sm"},pa={class:"flex space-x-1 opacity-0 transition-opacity group-hover:opacity-100"},va={key:0,class:"space-y-4 rounded-md border p-4"},ya={class:"text-sm font-medium sm:text-base"},ga={class:"space-y-3"},xa={class:"flex justify-end space-x-2"},ba={class:"flex items-center gap-2"},_a={class:"flex-1 overflow-y-auto px-4 sm:px-6 py-4"},wa={key:0},ka={class:"space-y-4"},ha={class:"cursor-pointer mt-3"},Ca=["disabled"],Da={key:0,class:"mt-3 text-xs text-primary font-medium"},Sa={class:"flex items-center gap-2 text-sm text-muted-foreground"},$a=["href"],Na={key:0,class:"flex items-center justify-center gap-2 p-4"},Ta={key:1,class:"space-y-4"},Aa={key:0,class:"rounded-lg border p-3"},Fa={class:"flex items-center justify-between"},Va={class:"text-xs text-muted-foreground"},Ma={class:"mt-2 flex flex-wrap gap-2"},ja={class:"grid grid-cols-3 gap-4"},Oa={class:"text-2xl font-bold"},Ea={class:"text-2xl font-bold text-green-600"},Ua={class:"text-2xl font-bold text-red-600"},za={key:2},Pa={class:"flex items-center justify-between mb-3"},Ra={class:"text-lg font-semibold text-red-600 flex items-center gap-2"},Ba={class:"border rounded-lg overflow-hidden"},La={class:"max-h-96 overflow-y-auto"},Ia={class:"flex flex-wrap gap-x-3 gap-y-1"},Wa={class:"font-medium text-foreground"},Ya={key:0,class:"italic text-muted-foreground"},qa={class:"space-y-1"},Ha={key:0,class:"text-xs text-muted-foreground"},Ga={key:3},Ka={class:"text-lg font-semibold text-green-600 flex items-center gap-2 mb-3"},Qa={class:"border rounded-lg overflow-hidden"},Xa={class:"flex flex-wrap gap-x-3 gap-y-1"},Za={class:"font-medium"},Ja={key:0,class:"italic text-muted-foreground"},es={class:"border-t p-4 flex justify-end gap-3"},ts={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"},Ns={__name:"Index",props:{delays:{type:Object,default:()=>({data:[],links:[]})},tenantSlug:{type:String,default:null},delay_codes:{type:Array,default:()=>[]},tenants:{type:Array,default:()=>[]},isSuperAdmin:{type:Boolean,default:!1},dateRange:{type:Object,default:null},dateFilter:{type:String,default:"yesterday"},weekNumber:{type:Number,default:null},startWeekNumber:{type:Number,default:null},endWeekNumber:{type:Number,default:null},year:{type:Number,default:null},delay_breakdown:{type:Object,default:null},line_chart_data:{type:Array,default:()=>[]},average_ontime:{type:Number,default:null},filters:{type:Object,default:()=>({search:"",delayCode:"",delayCategory:"",delayType:"",disputed:"",controllable:""})},permissions:Array},setup(p){var Ye;const d=p,h=Tt();qe(()=>{const n=e=>e.preventDefault();window.addEventListener("dragover",n),window.addEventListener("drop",n),$t(()=>{window.removeEventListener("dragover",n),window.removeEventListener("drop",n)})});const V=S(null),f=S(!1);let F=0;function M(){F+=1,f.value=!0}function U(){f.value=!0}function I(){F-=1,F<=0&&(F=0,f.value=!1)}function z(n){var _,r;F=0,f.value=!1;const e=(r=(_=n.dataTransfer)==null?void 0:_.files)==null?void 0:r[0];e&&Ie(e)}function G(n){var _;const e=(_=n.target.files)==null?void 0:_[0];e&&(Ie(e),n.target.value="")}const le=[{title:d.tenantSlug?"Dashboard":"Admin Dashboard",href:d.tenantSlug?route("dashboard",{tenantSlug:d.tenantSlug}):route("admin.dashboard")},{title:"On-Time",href:d.tenantSlug?route("ontime.index",{tenantSlug:d.tenantSlug}):route("ontime.index.admin")}],K=S(!1),D=S(!1),m=S(null),x=S(""),y=S(""),j=S(!1),Z=S(null),O=S([]),ke=S(!1),ze=S(null),he=S(!1),$=S(null),se=S(!1),ne=S(!1),re=S(!1),de=S(!1),W=S(null),ae=S({code:"",description:""}),Ce=S(!1),Fe=S(null),ie=S("date"),ue=S("desc"),b=S({...d.filters}),me=S(((Ye=d.delays)==null?void 0:Ye.per_page)||10),L=S(d.dateFilter||"full"),Pe=A(()=>(L.value==="yesterday"||L.value==="current-week")&&d.weekNumber&&d.year?`Week ${d.weekNumber}, ${d.year}`:(L.value==="6w"||L.value==="quarterly")&&d.startWeekNumber&&d.endWeekNumber&&d.year?`Weeks ${d.startWeekNumber}-${d.endWeekNumber}, ${d.year}`:""),$e=["date","delay_type","driver_name","delay_category","delay_code","disputed","driver_controllable"],Y=A(()=>d.permissions.map(n=>n.name)),He=A(()=>b.value.search||b.value.delayCode||b.value.delayCategory||b.value.disputed||b.value.delayType||b.value.controllable),Ge=n=>{if(!n)return"";const e=typeof n=="string"?parseInt(n,10):n,_=d.delay_codes.find(r=>r.id===e);return _?_.code:""},ce=A(()=>{var e;let n=[...((e=d.delays)==null?void 0:e.data)||[]];return n.sort((_,r)=>{var T,B;let g,P;return ie.value==="delay_code"?(g=((T=_.delay_code)==null?void 0:T.code)||"",P=((B=r.delay_code)==null?void 0:B.code)||""):(g=_[ie.value],P=r[ie.value]),g===null?1:P===null?-1:(typeof g=="string"&&(g=g.toLowerCase(),P=P.toLowerCase()),g<P?ue.value==="asc"?-1:1:g>P?ue.value==="asc"?1:-1:0)}),n}),Ke=A(()=>(d.delay_codes||[]).filter(n=>!n.deleted_at));function Qe(n){ie.value===n?ue.value=ue.value==="asc"?"desc":"asc":(ie.value=n,ue.value="asc")}function Ne(n){if(!n)return"";const e=n.split("-");if(e.length!==3)return n;const[_,r,g]=e;return`${Number(r)}/${Number(g)}/${_}`}function Re(n){if(!n)return"—";switch(n){case"1_120":return"1-120 mins";case"121_600":return"121-600 mins";case"601_plus":return"601+ mins";case"1_60":return"1-60 mins";case"61_240":return"61-240 mins";case"241_600":return"241-600 mins";default:return n}}function Be(){const n=d.tenantSlug?route("ontime.index",{tenantSlug:d.tenantSlug}):route("ontime.index.admin");q.get(n,{...b.value,perPage:me.value,dateFilter:L.value})}function Xe(){b.value={search:"",delayCode:"",delayCategory:"",delayType:"",disputed:"",controllable:""},Be()}function Ze(){const n=d.tenantSlug?route("ontime.index",{tenantSlug:d.tenantSlug}):route("ontime.index.admin");q.get(n,{...b.value,perPage:me.value,dateFilter:L.value})}function Te(n){L.value=n;const e=d.tenantSlug?route("ontime.index",{tenantSlug:d.tenantSlug}):route("ontime.index.admin");q.get(e,{...b.value,perPage:me.value,dateFilter:n})}function Je(n){if(!n)return;const e=new URL(n),_=e.origin+e.pathname;q.get(_,{...b.value,perPage:me.value,dateFilter:L.value,page:e.searchParams.get("page")||1})}const Le=(n=null)=>{m.value=n,K.value=!0},et=n=>{Z.value=n,j.value=!0},tt=n=>{const e=we({}),_=d.isSuperAdmin?"ontime.destroy.admin":"ontime.destroy",r=d.isSuperAdmin?{delay:n}:{tenantSlug:d.tenantSlug,delay:n};e.delete(route(_,r),{preserveScroll:!0,onSuccess:()=>{x.value="Delay record deleted successfully.",j.value=!1,Z.value=null},onError:()=>{y.value="Failed to delete delay record."}})},lt=A(()=>ce.value.length>0&&O.value.length===ce.value.length);function at(n){n.target.checked?O.value=ce.value.map(e=>e.id):O.value=[]}function st(){O.value.length>0&&(ke.value=!0)}function nt(){const n=we({ids:O.value}),e=d.isSuperAdmin?"ontime.destroyBulk.admin":"ontime.destroyBulk",_=d.isSuperAdmin?{}:{tenantSlug:d.tenantSlug};n.delete(route(e,_),{preserveScroll:!0,onSuccess:()=>{x.value=`${O.value.length} delay records deleted successfully.`,O.value=[],ke.value=!1,q.reload()},onError:()=>{y.value="Failed to delete selected delays."}})}function ot(){var n,e;if((((n=d.delays)==null?void 0:n.data)||[]).length===0){y.value="No delay data found to export.";return}(e=ze.value)==null||e.submit()}const rt=A(()=>d.tenantSlug?route("ontime.export",{tenantSlug:d.tenantSlug}):route("ontime.export.admin")),dt=A(()=>"/storage/upload-data-temps/Delays Template.csv");function Ie(n){if(!n)return;if(!(n.type==="text/csv"||n.name.toLowerCase().endsWith(".csv")||n.type==="")){y.value="Please upload a valid CSV file.",setTimeout(()=>y.value="",4e3);return}se.value=!0;const _=new FormData;_.append("file",n);const r=d.isSuperAdmin?route("ontime.validateImport.admin"):route("ontime.validateImport",{tenantSlug:d.tenantSlug});q.post(r,_,{forceFormData:!0,preserveScroll:!0,only:["flash"],onFinish:()=>{se.value=!1},onError:()=>{se.value=!1,y.value="Failed to validate CSV file"}})}function it(){var e;if(!$.value||$.value.header_error||(((e=$.value.summary)==null?void 0:e.invalid)??0)>0)return;ne.value=!0;const n=d.isSuperAdmin?route("ontime.confirmImport.admin"):route("ontime.confirmImport",{tenantSlug:d.tenantSlug});q.post(n,{},{preserveScroll:!0,onSuccess:()=>{var _;x.value=`Successfully imported ${((_=$.value.summary)==null?void 0:_.valid)??0} delays`,We()},onError:()=>{y.value="Failed to import delays"},onFinish:()=>{ne.value=!1}})}function ut(){const n=d.isSuperAdmin?route("ontime.downloadErrorReport.admin"):route("ontime.downloadErrorReport",{tenantSlug:d.tenantSlug});window.location.href=n}function We(){he.value=!1,$.value=null,se.value=!1,ne.value=!1,f.value=!1,F=0,V.value&&(V.value.value="")}De(()=>{var n;return(n=h.props.flash)==null?void 0:n.importValidation},n=>{if(n){if(n.results){$.value=n.results,n.header_error&&($.value.header_error=n.header_error),he.value=!0;return}n.message&&(y.value=n.message)}},{immediate:!0});const mt=()=>{D.value=!0,de.value=!1,W.value=null},ct=()=>{ae.value={code:"",description:""},W.value=null,de.value=!0},ft=n=>{ae.value={code:n.code,description:n.description||""},W.value=n.id,de.value=!0},pt=()=>{de.value=!1,W.value=null},vt=n=>{Fe.value=n,Ce.value=!0},yt=n=>{n&&q.delete(route("delay_codes.destroy.admin",n),{onSuccess:()=>{Ce.value=!1,Fe.value=null,x.value="Delay code deleted successfully",q.reload({only:["delay_codes"]})},onError:()=>{y.value="Failed to delete delay code."}})},gt=()=>{const n=we({code:ae.value.code,description:ae.value.description}),e=W.value?d.isSuperAdmin?"delay_codes.update.admin":"delay_codes.update":d.isSuperAdmin?"delay_codes.store.admin":"delay_codes.store",_=W.value?d.isSuperAdmin?{id:W.value}:{tenantSlug:d.tenantSlug,id:W.value}:d.isSuperAdmin?{}:{tenantSlug:d.tenantSlug};(W.value?n.put:n.post).call(n,route(e,_),{onSuccess:()=>{x.value=W.value?"Delay code updated successfully.":"Delay code created successfully.",de.value=!1,W.value=null,q.reload({only:["delay_codes"]})},onError:()=>{y.value="Failed to save delay code."}})},xt=n=>{we({}).post(route(d.isSuperAdmin?"delay_codes.restore.admin":"delay_codes.restore",{id:n}),{onSuccess:()=>{x.value="Delay code restored successfully.",q.reload({only:["delay_codes"]})},onError:()=>{y.value="Failed to restore delay code."}})},bt=n=>{we({}).delete(route(d.isSuperAdmin?"delay_codes.forceDelete.admin":"delay_codes.forceDelete",{id:n}),{onSuccess:()=>{x.value="Delay code permanently deleted successfully.",q.reload({only:["delay_codes"]})},onError:()=>{y.value="Failed to permanently delete delay code."}})},_t=A(()=>{var _,r;if(!((_=d.delay_breakdown)!=null&&_.by_category))return null;const n=d.delay_breakdown.by_category,e=(r=d.filters)==null?void 0:r.delayType;return e?{moreThan601Count:n[`category_601_plus_${e}_count`]||"0",between1_60Count:n[`category_1_60_${e}_count`]||"0",between61_240Count:n[`category_61_240_${e}_count`]||"0",between241_600Count:n[`category_241_600_${e}_count`]||"0",totalDelays:n[`total_${e}_delays`]||"0",by_category:!0}:{between1_120Count:n.category_1_120_count||"0",between121_600Count:n.category_121_600_count||"0",moreThan601Count:n.category_601_plus_count||"0",between1_60Count:n.category_1_60_count||"0",between61_240Count:n.category_61_240_count||"0",between241_600Count:n.category_241_600_count||"0",totalDelays:n.total_delays||"0",by_category:!0}}),wt=A(()=>{var n,e,_,r,g,P,T,B;return((n=d.filters)==null?void 0:n.delayType)==="origin"?((_=(e=d.delay_breakdown)==null?void 0:e.bottom_five_drivers)==null?void 0:_.origin)||[]:((r=d.filters)==null?void 0:r.delayType)==="destination"?((P=(g=d.delay_breakdown)==null?void 0:g.bottom_five_drivers)==null?void 0:P.destination)||[]:((B=(T=d.delay_breakdown)==null?void 0:T.bottom_five_drivers)==null?void 0:B.total)||[]}),kt=A(()=>!d.line_chart_data||d.line_chart_data.length===0?{labels:[],datasets:[{label:"On-Time Performance",data:[],borderColor:"#3b82f6",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.3,fill:!1}]}:{labels:d.line_chart_data.map(n=>n.date),datasets:[{label:"On-Time Performance",data:d.line_chart_data.map(n=>n.onTimePerformance),borderColor:"#3b82f6",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.3,fill:!1}]});return De(x,n=>{n&&setTimeout(()=>x.value="",5e3)}),De(y,n=>{n&&setTimeout(()=>y.value="",5e3)}),(n,e)=>(o(),C(Ot,{breadcrumbs:le,tenantSlug:p.tenantSlug,permissions:d.permissions},{default:a(()=>{var _;return[l(s(At),{title:"On-Time"}),t("div",gl,[x.value?(o(),C(s(Oe),{key:0,variant:"success"},{default:a(()=>[l(s(Ee),null,{default:a(()=>e[33]||(e[33]=[i("Success")])),_:1}),l(s(Ue),null,{default:a(()=>[i(c(x.value),1)]),_:1})]),_:1})):v("",!0),y.value?(o(),C(s(Oe),{key:1,variant:"destructive"},{default:a(()=>[l(s(Ee),null,{default:a(()=>e[34]||(e[34]=[i("Error")])),_:1}),l(s(Ue),null,{default:a(()=>[i(c(y.value),1)]),_:1})]),_:1})):v("",!0),t("div",xl,[e[39]||(e[39]=t("h1",{class:"text-lg font-bold text-gray-800 dark:text-gray-200 md:text-xl lg:text-2xl"}," On-Time Management ",-1)),t("div",bl,[Y.value.includes("delays.create")?(o(),C(w,{key:0,class:"px-2 py-0 md:px-4 md:py-2",onClick:e[0]||(e[0]=r=>Le()),variant:"default"},{default:a(()=>[l(N,{name:"plus",class:"mr-1 h-4 w-4 md:mr-2"}),e[35]||(e[35]=i(" Add Delay "))]),_:1})):v("",!0),O.value.length>0&&Y.value.includes("delays.delete")?(o(),C(w,{key:1,class:"px-2 py-0 md:px-4 md:py-2",onClick:e[1]||(e[1]=r=>st()),variant:"destructive"},{default:a(()=>[l(N,{name:"trash",class:"mr-1 h-4 w-4 md:mr-2"}),i(" Delete Selected ("+c(O.value.length)+") ",1)]),_:1})):v("",!0),Y.value.includes("delays.import")?(o(),C(w,{key:2,onClick:e[2]||(e[2]=r=>he.value=!0),variant:"secondary",class:"px-2 py-0 md:px-4 md:py-2 shadow-sm hover:shadow transition-all"},{default:a(()=>[l(N,{name:"upload",class:"mr-1 h-4 w-4 md:mr-2"}),e[36]||(e[36]=i(" Import CSV "))]),_:1})):v("",!0),Y.value.includes("delays.export")?(o(),C(w,{key:3,class:"px-2 py-0 md:px-4 md:py-2",onClick:_e(ot,["prevent"]),variant:"outline"},{default:a(()=>[l(N,{name:"download",class:"mr-1 h-4 w-4 md:mr-2"}),e[37]||(e[37]=i(" Download CSV "))]),_:1})):v("",!0),p.isSuperAdmin?(o(),C(w,{key:4,class:"px-2 py-0 md:px-4 md:py-2",onClick:e[3]||(e[3]=r=>mt()),variant:"outline"},{default:a(()=>[l(N,{name:"settings",class:"mr-1 h-4 w-4 md:mr-2"}),e[38]||(e[38]=i(" Manage Delay Codes "))]),_:1})):v("",!0)])]),t("form",{ref_key:"exportForm",ref:ze,action:rt.value,method:"GET",class:"hidden"},null,8,_l),l(s(fe),null,{default:a(()=>[l(s(pe),{class:"p-2 md:p-4 lg:p-6"},{default:a(()=>[t("div",wl,[t("div",kl,[l(w,{onClick:e[4]||(e[4]=r=>Te("yesterday")),variant:"outline",size:"sm",class:te({"border-primary bg-primary/10 text-primary":L.value==="yesterday"})},{default:a(()=>e[40]||(e[40]=[i(" Yesterday ")])),_:1},8,["class"]),l(w,{onClick:e[5]||(e[5]=r=>Te("current-week")),variant:"outline",size:"sm",class:te({"border-primary bg-primary/10 text-primary":L.value==="current-week"})},{default:a(()=>e[41]||(e[41]=[i(" WTD ")])),_:1},8,["class"]),l(w,{onClick:e[6]||(e[6]=r=>Te("6w")),variant:"outline",size:"sm",class:te({"border-primary bg-primary/10 text-primary":L.value==="6w"})},{default:a(()=>e[42]||(e[42]=[i(" T6W ")])),_:1},8,["class"]),l(w,{onClick:e[7]||(e[7]=r=>Te("quarterly")),variant:"outline",size:"sm",class:te({"border-primary bg-primary/10 text-primary":L.value==="quarterly"})},{default:a(()=>e[43]||(e[43]=[i(" Quarterly ")])),_:1},8,["class"])]),p.dateRange?(o(),u("div",hl,[L.value==="yesterday"&&p.dateRange.start?(o(),u("span",Cl," Showing data from "+c(Ne(p.dateRange.start)),1)):p.dateRange.start&&p.dateRange.end?(o(),u("span",Dl," Showing data from "+c(Ne(p.dateRange.start))+" to "+c(Ne(p.dateRange.end)),1)):(o(),u("span",Sl,c(p.dateRange.label),1)),Pe.value?(o(),u("span",$l,"("+c(Pe.value)+")",1)):v("",!0)])):v("",!0)])]),_:1})]),_:1}),l(s(fe),null,{default:a(()=>[l(s(Mt),{class:"p-2 md:p-4 lg:p-6"},{default:a(()=>[t("div",Nl,[t("div",Tl,[l(s(jt),{class:"text-lg md:text-xl lg:text-2xl"},{default:a(()=>e[44]||(e[44]=[i("Filters")])),_:1}),!re.value&&He.value?(o(),u("div",Al,[b.value.search?(o(),u("div",Fl," Search: "+c(b.value.search),1)):v("",!0),b.value.delayCode?(o(),u("div",Vl," Code: "+c(Ge(b.value.delayCode)),1)):v("",!0),b.value.delayCategory?(o(),u("div",Ml," Category: "+c(Re(b.value.delayCategory)),1)):v("",!0),b.value.delayType?(o(),u("div",jl," Type: "+c(b.value.delayType==="origin"?"Origin":"Destination"),1)):v("",!0),b.value.disputed?(o(),u("div",Ol," Disputed: "+c(b.value.disputed==="true"?"Yes":"No"),1)):v("",!0),b.value.controllable?(o(),u("div",El," Driver Controllable: "+c(b.value.controllable==="true"?"Yes":b.value.controllable==="false"?"No":"N/A"),1)):v("",!0)])):v("",!0)]),l(w,{variant:"ghost",size:"sm",onClick:e[8]||(e[8]=r=>re.value=!re.value)},{default:a(()=>[i(c(re.value?"Hide Filters":"Show Filters")+" ",1),l(N,{name:re.value?"chevron-up":"chevron-down",class:"ml-2 h-4 w-4"},null,8,["name"])]),_:1})])]),_:1}),re.value?(o(),C(s(pe),{key:0,class:"p-2 md:p-4 lg:p-6"},{default:a(()=>[t("div",Ul,[t("div",zl,[t("div",null,[l(s(E),{for:"search"},{default:a(()=>e[45]||(e[45]=[i("Search")])),_:1}),l(s(Se),{class:"h-9 px-1 py-1 md:px-2 md:py-1 lg:h-10 lg:px-3 lg:py-2",id:"search",modelValue:b.value.search,"onUpdate:modelValue":e[9]||(e[9]=r=>b.value.search=r),type:"text",placeholder:"Search by driver..."},null,8,["modelValue"])]),t("div",null,[l(s(E),{for:"delayCode"},{default:a(()=>e[46]||(e[46]=[i("Delay Code")])),_:1}),H(t("select",{id:"delayCode","onUpdate:modelValue":e[10]||(e[10]=r=>b.value.delayCode=r),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},[e[47]||(e[47]=t("option",{value:""},"All Codes",-1)),(o(!0),u(k,null,R(p.delay_codes,r=>(o(),u("option",{key:r.id,value:r.id},c(r.code),9,Pl))),128))],512),[[Q,b.value.delayCode]])]),t("div",null,[l(s(E),{for:"delayCategory"},{default:a(()=>e[48]||(e[48]=[i("Delay Category")])),_:1}),H(t("select",{id:"delayCategory","onUpdate:modelValue":e[11]||(e[11]=r=>b.value.delayCategory=r),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},e[49]||(e[49]=[t("option",{value:""},"All Categories",-1),t("option",{value:"1_60"},"1-60 mins",-1),t("option",{value:"61_240"},"61-240 mins",-1),t("option",{value:"241_600"},"241-600 mins",-1),t("option",{value:"601_plus"},"601+ mins",-1)]),512),[[Q,b.value.delayCategory]])]),t("div",null,[l(s(E),{for:"delayType"},{default:a(()=>e[50]||(e[50]=[i("Delay Type")])),_:1}),H(t("select",{id:"delayType","onUpdate:modelValue":e[12]||(e[12]=r=>b.value.delayType=r),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},e[51]||(e[51]=[t("option",{value:""},"All Types",-1),t("option",{value:"origin"},"Origin",-1),t("option",{value:"destination"},"Destination",-1)]),512),[[Q,b.value.delayType]])]),t("div",null,[l(s(E),{for:"disputed"},{default:a(()=>e[52]||(e[52]=[i("Disputed Status")])),_:1}),H(t("select",{id:"disputed","onUpdate:modelValue":e[13]||(e[13]=r=>b.value.disputed=r),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},e[53]||(e[53]=[t("option",{value:""},"All",-1),t("option",{value:"true"},"Disputed",-1),t("option",{value:"false"},"Not Disputed",-1)]),512),[[Q,b.value.disputed]])]),t("div",null,[l(s(E),{for:"controllable"},{default:a(()=>e[54]||(e[54]=[i("Driver Controllable")])),_:1}),H(t("select",{id:"controllable","onUpdate:modelValue":e[14]||(e[14]=r=>b.value.controllable=r),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},e[55]||(e[55]=[t("option",{value:""},"All",-1),t("option",{value:"true"},"Yes",-1),t("option",{value:"false"},"No",-1),t("option",{value:"NA"},"N/A",-1)]),512),[[Q,b.value.controllable]])])]),t("div",Rl,[l(w,{onClick:Xe,variant:"ghost",size:"sm"},{default:a(()=>[l(N,{name:"rotate_ccw",class:"mr-2 h-4 w-4"}),e[56]||(e[56]=i(" Reset Filters "))]),_:1}),l(w,{onClick:Be,variant:"default",size:"sm"},{default:a(()=>[l(N,{name:"filter",class:"mr-2 h-4 w-4"}),e[57]||(e[57]=i(" Apply Filters "))]),_:1})])])]),_:1})):v("",!0)]),_:1}),p.isSuperAdmin?v("",!0):(o(),C(yl,{key:2,metricsData:_t.value,driversData:wt.value,chartData:kt.value,averageOntime:p.average_ontime,currentDateFilter:(_=d.dateRange)==null?void 0:_.label,delayType:b.value.delayType},null,8,["metricsData","driversData","chartData","averageOntime","currentDateFilter","delayType"])),l(s(fe),{class:"mx-auto max-w-[95vw] overflow-x-auto md:max-w-[64vw] lg:max-w-full"},{default:a(()=>[l(s(pe),{class:"p-0"},{default:a(()=>[t("div",Bl,[l(s(Ve),{class:"relative h-[500px] overflow-auto"},{default:a(()=>[l(s(Me),null,{default:a(()=>[l(s(oe),{class:"sticky top-0 z-10 border-b bg-background hover:bg-background"},{default:a(()=>[Y.value.includes("delays.delete")?(o(),C(s(ee),{key:0,class:"w-[50px]"},{default:a(()=>[t("div",Ll,[t("input",{type:"checkbox",onChange:at,checked:lt.value,class:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"},null,40,Il)])]),_:1})):v("",!0),p.isSuperAdmin?(o(),C(s(ee),{key:1},{default:a(()=>e[58]||(e[58]=[i("Company Name")])),_:1})):v("",!0),(o(),u(k,null,R($e,r=>l(s(ee),{key:r,class:"cursor-pointer",onClick:g=>Qe(r)},{default:a(()=>[t("div",Wl,[r==="delay_category"?(o(),u(k,{key:0},[i(" Delay ")],64)):(o(),u(k,{key:1},[i(c(r.replace(/_/g," ").split(" ").map(g=>g.charAt(0).toUpperCase()+g.slice(1)).join(" ")),1)],64)),ie.value===r?(o(),u("div",Yl,[ue.value==="asc"?(o(),u("svg",ql,e[59]||(e[59]=[t("path",{d:"M8 15l4-4 4 4"},null,-1)]))):(o(),u("svg",Hl,e[60]||(e[60]=[t("path",{d:"M16 9l-4 4-4-4"},null,-1)])))])):(o(),u("div",Gl,e[61]||(e[61]=[t("svg",{class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M8 10l4-4 4 4"}),t("path",{d:"M16 14l-4 4-4-4"})],-1)])))])]),_:2},1032,["onClick"])),64)),Y.value.includes("delays.delete")||Y.value.includes("delays.update")?(o(),C(s(ee),{key:2,class:"text-right"},{default:a(()=>e[62]||(e[62]=[i("Actions")])),_:1})):v("",!0)]),_:1})]),_:1}),l(s(je),null,{default:a(()=>[ce.value.length===0?(o(),C(s(oe),{key:0},{default:a(()=>[l(s(X),{colspan:p.isSuperAdmin?$e.length+3:$e.length+2,class:"py-8 text-center text-primary font-medium"},{default:a(()=>e[63]||(e[63]=[i(" No delays found matching your criteria ")])),_:1},8,["colspan"])]),_:1})):v("",!0),(o(!0),u(k,null,R(ce.value,r=>(o(),C(s(oe),{key:r.id,class:"hover:bg-muted/50"},{default:a(()=>[Y.value.includes("delays.delete")?(o(),C(s(X),{key:0,class:"text-center"},{default:a(()=>[H(t("input",{type:"checkbox",value:r.id,"onUpdate:modelValue":e[15]||(e[15]=g=>O.value=g),class:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"},null,8,Kl),[[Nt,O.value]])]),_:2},1024)):v("",!0),p.isSuperAdmin?(o(),C(s(X),{key:1},{default:a(()=>{var g;return[i(c(((g=r.tenant)==null?void 0:g.name)||"—"),1)]}),_:2},1024)):v("",!0),(o(),u(k,null,R($e,g=>l(s(X),{key:g,class:"whitespace-nowrap"},{default:a(()=>{var P,T;return[g==="date"?(o(),u(k,{key:0},[i(c(Ne(r[g])),1)],64)):g==="disputed"?(o(),u(k,{key:1},[i(c(r[g]?"Yes":"No"),1)],64)):g==="driver_controllable"?(o(),u(k,{key:2},[i(c(r[g]===null?"N/A":r[g]?"Yes":"No"),1)],64)):g==="delay_code"?(o(),u(k,{key:3},[i(c(((P=r.delay_code)==null?void 0:P.code)||"—")+" ",1),(T=r.delay_code)!=null&&T.deleted_at?(o(),u("span",Ql,"(Deleted Code)")):v("",!0)],64)):g==="delay_category"?(o(),u(k,{key:4},[i(c(Re(r.delay_category)),1)],64)):(o(),u(k,{key:5},[i(c(r[g]),1)],64))]}),_:2},1024)),64)),Y.value.includes("delays.update")||Y.value.includes("delays.delete")?(o(),C(s(X),{key:2,class:"text-right"},{default:a(()=>[t("div",Xl,[Y.value.includes("delays.update")?(o(),C(w,{key:0,onClick:g=>Le(r),variant:"warning",size:"sm"},{default:a(()=>[l(N,{name:"pencil",class:"mr-1 h-4 w-4"}),e[64]||(e[64]=i(" Edit "))]),_:2},1032,["onClick"])):v("",!0),Y.value.includes("delays.delete")?(o(),C(w,{key:1,onClick:g=>et(r.id),variant:"destructive",size:"sm"},{default:a(()=>[l(N,{name:"trash",class:"mr-1 h-4 w-4"}),e[65]||(e[65]=i(" Delete "))]),_:2},1032,["onClick"])):v("",!0)])]),_:2},1024)):v("",!0)]),_:2},1024))),128))]),_:1})]),_:1})]),p.delays.links?(o(),u("div",Zl,[t("div",Jl,[t("div",ea," Showing "+c(ce.value.length)+" of "+c(p.delays.data.length)+" entries ",1),t("div",ta,[t("div",la,[l(s(E),{for:"perPage",class:"text-sm"},{default:a(()=>e[66]||(e[66]=[i("Per page:")])),_:1}),H(t("select",{id:"perPage","onUpdate:modelValue":e[16]||(e[16]=r=>me.value=r),onChange:Ze,class:"h-8 rounded-md border border-input bg-background px-2 py-1 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"},e[67]||(e[67]=[t("option",{value:"10"},"10",-1),t("option",{value:"25"},"25",-1),t("option",{value:"50"},"50",-1),t("option",{value:"100"},"100",-1)]),544),[[Q,me.value]])]),t("div",aa,[(o(!0),u(k,null,R(p.delays.links,r=>(o(),C(w,{key:r.label,onClick:g=>Je(r.url),disabled:!r.url,variant:"ghost",size:"sm",class:te(["mx-1",{"border-primary bg-primary/10 text-primary":r.active}])},{default:a(()=>[t("span",{innerHTML:r.label},null,8,sa)]),_:2},1032,["onClick","disabled","class"]))),128))])])])])):v("",!0)]),_:1})]),_:1}),l(s(ve),{open:K.value,"onUpdate:open":e[18]||(e[18]=r=>K.value=r)},{default:a(()=>[l(s(ye),{class:"max-w-[95vw] sm:max-w-[90vw] md:max-w-4xl"},{default:a(()=>[l(s(xe),{class:"px-4 sm:px-6"},{default:a(()=>[l(s(be),{class:"text-lg sm:text-xl"},{default:a(()=>[i(c(m.value?"Edit":"Add")+" Delay",1)]),_:1}),l(s(ge),{class:"text-xs sm:text-sm"},{default:a(()=>[i(" Fill in the details to "+c(m.value?"update":"create")+" a delay record. ",1)]),_:1})]),_:1}),l(Gt,{delay:m.value,"delay-codes":Ke.value,tenants:p.tenants,"is-super-admin":p.isSuperAdmin,"tenant-slug":p.tenantSlug,onClose:e[17]||(e[17]=r=>K.value=!1),class:"max-h-[75vh] overflow-y-auto p-4 sm:p-6"},null,8,["delay","delay-codes","tenants","is-super-admin","tenant-slug"])]),_:1})]),_:1},8,["open"]),l(s(ve),{open:D.value,"onUpdate:open":e[22]||(e[22]=r=>D.value=r)},{default:a(()=>[l(s(ye),{class:"max-w-[95vw] sm:max-w-[90vw] md:max-w-2xl"},{default:a(()=>[l(s(xe),{class:"px-4 sm:px-6"},{default:a(()=>[l(s(be),{class:"text-lg sm:text-xl"},{default:a(()=>e[68]||(e[68]=[i("Manage Delay Codes")])),_:1}),l(s(ge),{class:"text-xs sm:text-sm"},{default:a(()=>e[69]||(e[69]=[i(" Create and manage delay codes for your organization. ")])),_:1})]),_:1}),t("div",na,[t("div",oa,[e[71]||(e[71]=t("h3",{class:"text-sm font-medium sm:text-base"},"Current Delay Codes",-1)),l(w,{onClick:ct,size:"sm",variant:"outline",class:"h-8 px-3 text-xs sm:h-9 sm:px-4 sm:text-sm"},{default:a(()=>[l(N,{name:"plus",class:"mr-1 h-3 w-3 sm:h-3.5 sm:w-3.5"}),e[70]||(e[70]=i(" Add New Code "))]),_:1})]),t("div",ra,[!p.delay_codes||p.delay_codes.length===0?(o(),u("div",da," No delay codes found ")):(o(),u("div",ia,[(o(!0),u(k,null,R(p.delay_codes,r=>(o(),u("div",{key:r.id,class:"group flex items-center justify-between p-3 hover:bg-muted/50"},[t("div",{class:"flex-1 cursor-pointer",onClick:g=>ft(r)},[t("div",ma,[i(c(r.code)+" ",1),r.deleted_at?(o(),u("span",ca,"(Deleted)")):v("",!0)]),r.description?(o(),u("div",fa,c(r.description),1)):v("",!0)],8,ua),t("div",pa,[p.isSuperAdmin?(o(),u(k,{key:0},[r.deleted_at?(o(),u(k,{key:0},[l(w,{onClick:g=>xt(r.id),size:"sm",variant:"outline",class:"h-8 px-2 text-xs sm:h-9 sm:px-3 sm:text-sm"},{default:a(()=>[l(N,{name:"refresh",class:"mr-1 h-3 w-3 sm:h-3 sm:w-3"}),e[72]||(e[72]=i(" Restore "))]),_:2},1032,["onClick"]),l(w,{onClick:g=>bt(r.id),size:"sm",variant:"destructive",class:"h-8 px-2 text-xs sm:h-9 sm:px-3 sm:text-sm"},{default:a(()=>[l(N,{name:"trash",class:"mr-1 h-3 w-3 sm:h-3 sm:w-3"}),e[73]||(e[73]=i(" Delete "))]),_:2},1032,["onClick"])],64)):(o(),C(w,{key:1,onClick:g=>vt(r.id),size:"sm",variant:"destructive",class:"h-8 px-2 text-xs sm:h-9 sm:px-3 sm:text-sm"},{default:a(()=>[l(N,{name:"trash",class:"mr-1 h-3 w-3 sm:h-3 sm:w-3"}),e[74]||(e[74]=i(" Delete "))]),_:2},1032,["onClick"]))],64)):v("",!0)])]))),128))]))]),de.value?(o(),u("div",va,[t("h3",ya,c(W.value?"Edit":"Add")+" Delay Code ",1),t("div",ga,[t("div",null,[l(s(E),{for:"code",class:"text-xs sm:text-sm"},{default:a(()=>e[75]||(e[75]=[i("Code")])),_:1}),l(s(Se),{id:"code",modelValue:ae.value.code,"onUpdate:modelValue":e[19]||(e[19]=r=>ae.value.code=r),placeholder:"Enter code",class:"h-9 text-xs sm:h-10 sm:text-sm"},null,8,["modelValue"])]),t("div",null,[l(s(E),{for:"description",class:"text-xs sm:text-sm"},{default:a(()=>e[76]||(e[76]=[i("Description")])),_:1}),l(s(Se),{id:"description",modelValue:ae.value.description,"onUpdate:modelValue":e[20]||(e[20]=r=>ae.value.description=r),placeholder:"Enter description",class:"h-9 text-xs sm:h-10 sm:text-sm"},null,8,["modelValue"])]),t("div",xa,[l(w,{onClick:pt,variant:"ghost",size:"sm",class:"h-8 px-3 text-xs sm:h-9 sm:px-4 sm:text-sm"},{default:a(()=>e[77]||(e[77]=[i("Cancel")])),_:1}),l(w,{onClick:gt,variant:"default",size:"sm",class:"h-8 px-3 text-xs sm:h-9 sm:px-4 sm:text-sm"},{default:a(()=>e[78]||(e[78]=[i("Save")])),_:1})])])])):v("",!0)]),l(s(Ae),{class:"px-4 sm:px-6"},{default:a(()=>[l(w,{onClick:e[21]||(e[21]=r=>D.value=!1),variant:"outline",class:"h-9 px-4 py-1 text-xs sm:h-10 sm:text-sm"},{default:a(()=>e[79]||(e[79]=[i("Close")])),_:1})]),_:1})]),_:1})]),_:1},8,["open"]),l(s(ve),{open:Ce.value,"onUpdate:open":e[25]||(e[25]=r=>Ce.value=r)},{default:a(()=>[l(s(ye),{class:"max-w-[95vw] sm:max-w-md"},{default:a(()=>[l(s(xe),{class:"px-4 sm:px-6"},{default:a(()=>[l(s(be),{class:"text-lg sm:text-xl"},{default:a(()=>e[80]||(e[80]=[i("Confirm Deletion")])),_:1}),l(s(ge),{class:"text-xs sm:text-sm"},{default:a(()=>e[81]||(e[81]=[i(" Are you sure you want to delete this delay code? This action cannot be undone. ")])),_:1})]),_:1}),l(s(Ae),{class:"px-4 sm:px-6"},{default:a(()=>[l(w,{type:"button",onClick:e[23]||(e[23]=r=>Ce.value=!1),variant:"outline",class:"h-9 px-4 py-1 text-xs sm:h-10 sm:text-sm"},{default:a(()=>e[82]||(e[82]=[i(" Cancel ")])),_:1}),l(w,{type:"button",onClick:e[24]||(e[24]=r=>yt(Fe.value)),variant:"destructive",class:"h-9 px-4 py-1 text-xs sm:h-10 sm:text-sm"},{default:a(()=>e[83]||(e[83]=[i(" Delete ")])),_:1})]),_:1})]),_:1})]),_:1},8,["open"]),l(s(ve),{open:j.value,"onUpdate:open":e[28]||(e[28]=r=>j.value=r)},{default:a(()=>[l(s(ye),{class:"max-w-[95vw] sm:max-w-md"},{default:a(()=>[l(s(xe),{class:"px-4 sm:px-6"},{default:a(()=>[l(s(be),{class:"text-lg sm:text-xl"},{default:a(()=>e[84]||(e[84]=[i("Confirm Deletion")])),_:1}),l(s(ge),{class:"text-xs sm:text-sm"},{default:a(()=>e[85]||(e[85]=[i(" Are you sure you want to delete this delay record? This action cannot be undone. ")])),_:1})]),_:1}),l(s(Ae),{class:"px-4 sm:px-6"},{default:a(()=>[l(w,{type:"button",onClick:e[26]||(e[26]=r=>j.value=!1),variant:"outline",class:"h-9 px-4 py-1 text-xs sm:h-10 sm:text-sm"},{default:a(()=>e[86]||(e[86]=[i(" Cancel ")])),_:1}),l(w,{type:"button",onClick:e[27]||(e[27]=r=>tt(Z.value)),variant:"destructive",class:"h-9 px-4 py-1 text-xs sm:h-10 sm:text-sm"},{default:a(()=>e[87]||(e[87]=[i(" Delete ")])),_:1})]),_:1})]),_:1})]),_:1},8,["open"]),l(s(ve),{open:ke.value,"onUpdate:open":e[31]||(e[31]=r=>ke.value=r)},{default:a(()=>[l(s(ye),{class:"max-w-[95vw] sm:max-w-md"},{default:a(()=>[l(s(xe),{class:"px-4 sm:px-6"},{default:a(()=>[l(s(be),{class:"text-lg sm:text-xl"},{default:a(()=>e[88]||(e[88]=[i("Confirm Bulk Deletion")])),_:1}),l(s(ge),{class:"text-xs sm:text-sm"},{default:a(()=>[i(" Are you sure you want to delete "+c(O.value.length)+" delay records? This action cannot be undone. ",1)]),_:1})]),_:1}),l(s(Ae),{class:"px-4 sm:px-6"},{default:a(()=>[l(w,{type:"button",onClick:e[29]||(e[29]=r=>ke.value=!1),variant:"outline",class:"h-9 px-4 py-1 text-xs sm:h-10 sm:text-sm"},{default:a(()=>e[89]||(e[89]=[i(" Cancel ")])),_:1}),l(w,{type:"button",onClick:e[30]||(e[30]=r=>nt()),variant:"destructive",class:"h-9 px-4 py-1 text-xs sm:h-10 sm:text-sm"},{default:a(()=>e[90]||(e[90]=[i(" Delete Selected ")])),_:1})]),_:1})]),_:1})]),_:1},8,["open"])]),l(s(ve),{open:he.value,"onUpdate:open":e[32]||(e[32]=r=>he.value=r)},{default:a(()=>[l(s(ye),{class:"max-w-[95vw] sm:max-w-[90vw] md:max-w-5xl max-h-[90vh] overflow-hidden flex flex-col"},{default:a(()=>{var r,g,P;return[l(s(xe),{class:"px-4 sm:px-6 border-b pb-3"},{default:a(()=>[t("div",ba,[l(N,{name:"upload",class:"h-5 w-5 text-primary"}),l(s(be),{class:"text-lg sm:text-xl font-semibold"},{default:a(()=>e[91]||(e[91]=[i(" Import Delays ")])),_:1})]),l(s(ge),{class:"text-xs sm:text-sm mt-1 text-muted-foreground"},{default:a(()=>e[92]||(e[92]=[i(" Upload a CSV file to import delays. The file will be validated before import. ")])),_:1})]),_:1}),t("div",_a,[$.value?(o(),u("div",Ta,[(r=$.value.headers)!=null&&r.length?(o(),u("div",Aa,[t("div",Fa,[e[97]||(e[97]=t("div",{class:"text-sm font-semibold"},"CSV Headers",-1)),t("div",Va,c($.value.headers.length)+" columns ",1)]),t("div",Ma,[(o(!0),u(k,null,R($.value.headers,T=>(o(),u("span",{key:T,class:"rounded-full bg-muted px-2 py-0.5 text-xs"},c(T),1))),128))])])):v("",!0),t("div",ja,[l(s(fe),{class:"border-2"},{default:a(()=>[l(s(pe),{class:"p-4 text-center"},{default:a(()=>[t("div",Oa,c($.value.summary.total),1),e[98]||(e[98]=t("div",{class:"text-sm text-muted-foreground"},"Total Rows",-1))]),_:1})]),_:1}),l(s(fe),{class:"border-2 border-green-500/50 bg-green-50 dark:bg-green-900/10"},{default:a(()=>[l(s(pe),{class:"p-4 text-center"},{default:a(()=>[t("div",Ea,c($.value.summary.valid),1),e[99]||(e[99]=t("div",{class:"text-sm text-muted-foreground"},"Valid",-1))]),_:1})]),_:1}),l(s(fe),{class:"border-2 border-red-500/50 bg-red-50 dark:bg-red-900/10"},{default:a(()=>[l(s(pe),{class:"p-4 text-center"},{default:a(()=>[t("div",Ua,c($.value.summary.invalid),1),e[100]||(e[100]=t("div",{class:"text-sm text-muted-foreground"},"Invalid",-1))]),_:1})]),_:1})]),$.value.header_error?(o(),C(s(Oe),{key:1,variant:"destructive"},{default:a(()=>[l(s(Ee),{class:"flex items-center gap-2"},{default:a(()=>[l(N,{name:"alert_circle",class:"h-5 w-5"}),e[101]||(e[101]=i(" Header Error "))]),_:1}),l(s(Ue),null,{default:a(()=>[i(c($.value.header_error),1)]),_:1})]),_:1})):v("",!0),(g=$.value.invalid)!=null&&g.length?(o(),u("div",za,[t("div",Pa,[t("h3",Ra,[l(N,{name:"alert-triangle",class:"h-5 w-5"}),i(" Validation Errors ("+c($.value.invalid.length)+") ",1)]),l(w,{onClick:ut,variant:"outline",size:"sm",class:"flex items-center gap-2"},{default:a(()=>[l(N,{name:"download",class:"h-4 w-4"}),e[102]||(e[102]=i(" Download Error Report "))]),_:1})]),t("div",Ba,[t("div",La,[l(s(Ve),null,{default:a(()=>[l(s(Me),{class:"sticky top-0 bg-background"},{default:a(()=>[l(s(oe),null,{default:a(()=>[l(s(ee),{class:"w-20"},{default:a(()=>e[103]||(e[103]=[i("Row #")])),_:1}),l(s(ee),null,{default:a(()=>e[104]||(e[104]=[i("Preview")])),_:1}),l(s(ee),null,{default:a(()=>e[105]||(e[105]=[i("Errors")])),_:1})]),_:1})]),_:1}),l(s(je),null,{default:a(()=>[(o(!0),u(k,null,R($.value.invalid,T=>(o(),C(s(oe),{key:T.rowNumber,class:"hover:bg-muted/50"},{default:a(()=>[l(s(X),{class:"font-medium"},{default:a(()=>[i(c(T.rowNumber),1)]),_:2},1024),l(s(X),{class:"text-sm text-muted-foreground"},{default:a(()=>{var B;return[t("div",Ia,[(o(!0),u(k,null,R(T.preview||[],J=>(o(),u("span",{key:J.key,class:"whitespace-nowrap"},[t("span",Wa,c(J.label)+":",1),i(" "+c(J.value),1)]))),128)),(B=T.preview)!=null&&B.length?v("",!0):(o(),u("span",Ya,"—"))])]}),_:2},1024),l(s(X),null,{default:a(()=>{var B;return[t("div",qa,[(o(!0),u(k,null,R(T.errors||[],(J,ht)=>(o(),u("div",{key:ht,class:"text-xs text-red-600 flex items-start gap-1"},[l(N,{name:"x-circle",class:"h-3 w-3 mt-0.5 flex-shrink-0"}),t("span",null,c(J),1)]))),128)),(B=T.errors)!=null&&B.length?v("",!0):(o(),u("div",Ha," — "))])]}),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])])])):v("",!0),(P=$.value.valid)!=null&&P.length?(o(),u("div",Ga,[t("h3",Ka,[l(N,{name:"check-circle",class:"h-5 w-5"}),i(" Valid Rows ("+c($.value.valid.length)+") ",1)]),e[108]||(e[108]=t("div",{class:"text-sm text-muted-foreground mb-2"}," Showing first 5 valid rows ",-1)),t("div",Qa,[l(s(Ve),null,{default:a(()=>[l(s(Me),null,{default:a(()=>[l(s(oe),null,{default:a(()=>[l(s(ee),null,{default:a(()=>e[106]||(e[106]=[i("Row #")])),_:1}),l(s(ee),null,{default:a(()=>e[107]||(e[107]=[i("Preview")])),_:1})]),_:1})]),_:1}),l(s(je),null,{default:a(()=>[(o(!0),u(k,null,R($.value.valid.slice(0,5),T=>(o(),C(s(oe),{key:T.rowNumber},{default:a(()=>[l(s(X),{class:"font-medium"},{default:a(()=>[i(c(T.rowNumber),1)]),_:2},1024),l(s(X),{class:"text-sm"},{default:a(()=>{var B;return[t("div",Xa,[(o(!0),u(k,null,R(T.preview||[],J=>(o(),u("span",{key:J.key,class:"whitespace-nowrap"},[t("span",Za,c(J.label)+":",1),i(" "+c(J.value),1)]))),128)),(B=T.preview)!=null&&B.length?v("",!0):(o(),u("span",Ja,"—"))])]}),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])])):v("",!0)])):(o(),u("div",wa,[t("div",ka,[t("div",{class:te(["flex flex-col items-center justify-center border-2 border-dashed rounded-lg p-8 bg-muted/20 transition-colors",{"border-primary bg-primary/5":f.value,"opacity-60 pointer-events-none":se.value}]),onDragenter:_e(M,["prevent"]),onDragover:_e(U,["prevent"]),onDragleave:_e(I,["prevent"]),onDrop:_e(z,["prevent"])},[l(N,{name:"file-spreadsheet",class:"h-12 w-12 text-muted-foreground mb-3"}),e[94]||(e[94]=t("div",{class:"text-center"},[t("div",{class:"text-sm font-medium"},[t("span",{class:"text-primary"},"Drag & drop"),i(" your CSV here ")]),t("p",{class:"text-xs text-muted-foreground mt-1"},"or")],-1)),t("label",ha,[e[93]||(e[93]=t("span",{class:"text-sm font-medium text-primary hover:underline"}," Choose CSV file ",-1)),t("input",{ref_key:"importFileInput",ref:V,type:"file",class:"hidden",onChange:G,accept:".csv,text/csv",disabled:se.value},null,40,Ca)]),e[95]||(e[95]=t("p",{class:"text-xs text-muted-foreground mt-2"},"CSV only",-1)),f.value?(o(),u("div",Da," Drop file to validate ")):v("",!0)],34),t("div",Sa,[l(N,{name:"info",class:"h-4 w-4"}),t("a",{href:dt.value,download:"",class:"text-primary hover:underline"}," Download CSV Template ",8,$a)]),se.value?(o(),u("div",Na,e[96]||(e[96]=[t("div",{class:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary"},null,-1),t("span",{class:"text-sm text-muted-foreground"},"Validating CSV file...",-1)]))):v("",!0)])]))]),t("div",es,[l(w,{onClick:We,variant:"outline",disabled:ne.value},{default:a(()=>e[109]||(e[109]=[i(" Close ")])),_:1},8,["disabled"]),$.value&&$.value.summary.valid>0?(o(),C(w,{key:0,onClick:it,variant:"default",disabled:ne.value||$.value.summary.invalid>0||!!$.value.header_error,class:"flex items-center gap-2"},{default:a(()=>[ne.value?(o(),u("div",ts)):(o(),C(N,{key:1,name:"check",class:"h-4 w-4"})),i(" "+c(ne.value?"Importing...":`Import ${$.value.summary.valid} Rows`),1)]),_:1},8,["disabled"])):v("",!0)])]}),_:1})]),_:1},8,["open"])]}),_:1},8,["tenantSlug","permissions"]))}};export{Ns as default};
