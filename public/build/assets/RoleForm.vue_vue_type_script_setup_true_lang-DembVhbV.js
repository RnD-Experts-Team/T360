import{_ as b}from"./Button.vue_vue_type_script_setup_true_lang-DA-5a5tM.js";import{S as pe,W as Z,x as ee}from"./vendor-vue-C6le94gM.js";import{c as O,L as c,e as i,X as s,k as $,M as z,N as P,U as _,b as T,f as a,S as f,u as e,l as t,r as F,d as se,w as te,b2 as G,D as ue,Y as me,P as le}from"./vendor-cgn9wV4E.js";import{_ as I}from"./Badge.vue_vue_type_script_setup_true_lang-BpieHD20.js";import{j as ne,af as re,q as fe,a9 as ve,am as ge,E as xe,a as ye,s as Y,X as q,Q,a3 as be,o as ie}from"./vendor-icons-Bu7C1ObZ.js";import{_ as D}from"./Input.vue_vue_type_script_setup_true_lang-1zH_gJ02.js";import{_ as U}from"./Label.vue_vue_type_script_setup_true_lang-WOFpmVDV.js";import{_ as J}from"./Checkbox.vue_vue_type_script_setup_true_lang-ChpZyGGS.js";import{_ as ae}from"./DialogFooter.vue_vue_type_script_setup_true_lang-C4cZ_wVx.js";import{a as oe,_ as de}from"./DialogTitle.vue_vue_type_script_setup_true_lang-K_t0Wv0O.js";import{_ as M}from"./InputError.vue_vue_type_script_setup_true_lang-B3W--yJp.js";const _e={class:"w-full overflow-x-auto"},he={class:"rounded-md border"},ke={class:"w-full caption-bottom text-sm"},$e={class:"[&_tr]:border-b"},we={class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},Se={key:0,class:"h-12 px-4 text-right align-middle font-medium text-muted-foreground"},Ce={class:"[&_tr:last-child]:border-0"},Ae={class:"p-4 align-middle font-medium"},Te={class:"p-4 align-middle"},ze={key:0,class:"p-4 align-middle text-right"},Pe={class:"flex justify-end space-x-2"},Ee={key:0,class:"mt-6 flex justify-center"},Ve={class:"flex flex-wrap items-center gap-1 justify-center"},mt={__name:"UserList",props:{users:Object,isSuperAdmin:{type:Boolean,default:!1},permissions:Array},setup(h){const j=h,u=O(()=>j.permissions.map(w=>w.name)),x=w=>{w&&Z.get(w,{},{only:["users"]})};return(w,n)=>(i(),c("div",_e,[s("div",he,[s("table",ke,[s("thead",$e,[s("tr",we,[n[0]||(n[0]=s("th",{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},"Name",-1)),n[1]||(n[1]=s("th",{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},"Email",-1)),u.value.includes("users.update")||u.value.includes("users.delete")?(i(),c("th",Se,"Actions")):$("",!0)])]),s("tbody",Ce,[(i(!0),c(z,null,P(h.users.data,v=>(i(),c("tr",{key:v.id,class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},[s("td",Ae,_(v.name),1),s("td",Te,_(v.email),1),u.value.includes("users.update")||u.value.includes("users.delete")?(i(),c("td",ze,[s("div",Pe,[u.value.includes("users.update")?(i(),T(e(b),{key:0,onClick:r=>w.$emit("edit",v),variant:"outline",size:"sm"},{default:a(()=>n[2]||(n[2]=[f(" Edit ")])),_:2},1032,["onClick"])):$("",!0),u.value.includes("users.delete")?(i(),T(e(b),{key:1,onClick:r=>w.$emit("delete",v),variant:"destructive",size:"sm"},{default:a(()=>n[3]||(n[3]=[f(" Delete ")])),_:2},1032,["onClick"])):$("",!0),h.isSuperAdmin?(i(),T(e(pe),{key:2,href:w.route("impersonate.start",v.id),as:"button"},{default:a(()=>[t(e(b),{variant:"secondary",size:"sm"},{default:a(()=>n[4]||(n[4]=[f(" Impersonate ")])),_:1})]),_:2},1032,["href"])):$("",!0)])])):$("",!0)]))),128))])])]),h.users.links?(i(),c("div",Ee,[s("nav",Ve,[(i(!0),c(z,null,P(h.users.links,v=>(i(),T(e(b),{key:v.label,onClick:r=>x(v.url),disabled:!v.url,variant:v.active?"default":"outline",size:"sm",class:"min-w-[40px]",innerHTML:v.label},null,8,["onClick","disabled","variant","innerHTML"]))),128))])])):$("",!0)]))}},Ue={class:"w-full overflow-x-auto"},je={class:"rounded-md border"},Le={class:"w-full caption-bottom text-sm"},Me={class:"[&_tr]:border-b bg-muted/50"},Ne={class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},Re={key:0,class:"h-12 px-4 text-right align-middle font-medium text-muted-foreground"},De={class:"[&_tr:last-child]:border-0"},Oe={class:"p-4 align-middle font-medium"},He={class:"flex items-center"},Ge={class:"p-4 align-middle"},Ie={class:"flex flex-wrap gap-1"},Be={class:"mb-2 w-full"},Fe={key:0,class:"w-full"},We={class:"text-xs font-semibold text-muted-foreground mb-1 flex items-center"},Ke={class:"flex flex-wrap gap-1 ml-4"},Xe={key:0,class:"p-4 align-middle text-right"},Ye={class:"flex justify-end space-x-2"},qe={key:0,class:"mt-6 flex justify-center"},Qe={class:"flex flex-wrap items-center gap-1 justify-center"},ct={__name:"RoleList",props:{roles:Object,permissions:Array},setup(h){const j=h,u=O(()=>j.permissions.map(g=>g.name)),x=F([]),w=g=>{const S=x.value.indexOf(g);S===-1?x.value.push(g):x.value.splice(S,1)},n=g=>g.length,v=g=>{g&&Z.get(g,{},{only:["roles"]})},r=g=>{const S={};return g.forEach(k=>{const N=k.name.split(".")[0];S[N]||(S[N]=[]),S[N].push(k)}),S},m=g=>g==="tenant-settings"?"Tenant Settings":g==="repair-orders"?"Repair Orders":g==="safety-data"?"Safety Data":g==="miles-driven"?"Miles Driven":g==="support-tickets"?"Support Tickets":g==="sms-coaching"?"SMS Coaching":g==="support-responses"?"Support Responses":g.charAt(0).toUpperCase()+g.slice(1),A=g=>{const S=g.split(".");return S.length>1?S[1].charAt(0).toUpperCase()+S[1].slice(1).replace(/-/g," "):g};return(g,S)=>(i(),c("div",Ue,[s("div",je,[s("table",Le,[s("thead",Me,[s("tr",Ne,[S[0]||(S[0]=s("th",{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},"Role Name",-1)),S[1]||(S[1]=s("th",{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},"Permissions",-1)),u.value.includes("roles.update")||u.value.includes("roles.delete")?(i(),c("th",Re,"Actions")):$("",!0)])]),s("tbody",De,[(i(!0),c(z,null,P(h.roles.data,k=>(i(),c("tr",{key:k.id,class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},[s("td",Oe,[s("div",He,[t(e(ne),{class:"h-4 w-4 mr-2 text-primary"}),f(" "+_(k.name),1)])]),s("td",Ge,[s("div",Ie,[s("div",Be,[t(e(I),{variant:"outline",class:"mr-2"},{default:a(()=>[f(_(n(k.permissions))+" permissions ",1)]),_:2},1024),t(e(b),{variant:"ghost",size:"sm",onClick:L=>w(k.id),class:"text-xs"},{default:a(()=>[f(_(x.value.includes(k.id)?"Hide details":"Show details"),1)]),_:2},1032,["onClick"])]),x.value.includes(k.id)?(i(),c("div",Fe,[(i(!0),c(z,null,P(r(k.permissions),(L,N)=>(i(),c("span",{key:N,class:"inline-flex flex-col mb-2 w-full"},[s("span",We,[t(e(re),{class:"h-3 w-3 mr-1"}),f(" "+_(m(N))+" ",1),t(e(I),{variant:"secondary",class:"ml-2"},{default:a(()=>[f(_(L.length),1)]),_:2},1024)]),s("div",Ke,[(i(!0),c(z,null,P(L,B=>(i(),c("span",{key:B.id,class:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-muted text-muted-foreground"},_(A(B.name)),1))),128))])]))),128))])):$("",!0)])]),u.value.includes("roles.update")||u.value.includes("roles.delete")?(i(),c("td",Xe,[s("div",Ye,[u.value.includes("roles.update")?(i(),T(e(b),{key:0,onClick:L=>g.$emit("edit",k),variant:"outline",size:"sm",class:"flex items-center"},{default:a(()=>[t(e(fe),{class:"h-3.5 w-3.5 mr-1"}),S[2]||(S[2]=f(" Edit "))]),_:2},1032,["onClick"])):$("",!0),u.value.includes("roles.delete")?(i(),T(e(b),{key:1,onClick:L=>g.$emit("delete",k),variant:"destructive",size:"sm",class:"flex items-center"},{default:a(()=>[t(e(ve),{class:"h-3.5 w-3.5 mr-1"}),S[3]||(S[3]=f(" Delete "))]),_:2},1032,["onClick"])):$("",!0)])])):$("",!0)]))),128))])])]),h.roles.links?(i(),c("div",qe,[s("nav",Qe,[(i(!0),c(z,null,P(h.roles.links,k=>(i(),T(e(b),{key:k.label,onClick:L=>v(k.url),disabled:!k.url,variant:k.active?"default":"outline",size:"sm",class:"min-w-[40px]",innerHTML:k.label},null,8,["onClick","disabled","variant","innerHTML"]))),128))])])):$("",!0)]))}},Je={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ze={class:"space-y-2"},es={class:"space-y-2"},ss={class:"space-y-2 md:col-span-2"},ts={key:0,class:"text-destructive ml-1"},ls={class:"relative"},ns={key:0,class:"space-y-2 md:col-span-2"},rs=["value"],is={class:"grid grid-cols-1 md:grid-cols-2 gap-4 pt-2"},as={class:"space-y-2"},os={class:"flex items-center justify-between min-h-[32px]"},ds={class:"flex space-x-2 opacity-0 pointer-events-none"},us={class:"relative"},ms={class:"flex items-center space-x-2"},cs={class:"relative w-full"},ps={class:"h-60 border rounded-md p-2 overflow-y-auto"},fs={key:0,class:"flex flex-col items-center justify-center h-full text-muted-foreground"},vs={class:"space-y-2"},gs={class:"flex items-center justify-between min-h-[32px]"},xs={class:"flex space-x-2"},ys={class:"relative"},bs={class:"flex items-center space-x-2"},_s={class:"relative w-full"},hs={class:"h-60 border rounded-md p-2 overflow-y-auto"},ks={class:"flex items-center justify-between mb-1"},$s={class:"font-medium text-sm text-foreground flex items-center"},ws={class:"flex space-x-1"},Ss={key:0,class:"ml-2 text-xs px-2 py-0.5 rounded-full border border-gray-200 bg-gray-100 dark:border-gray-700 dark:bg-gray-800 text-gray-600 dark:text-gray-300"},Cs={key:0,class:"flex flex-col items-center justify-center h-full text-muted-foreground"},pt=se({__name:"UserForm",props:{user:{type:Object,default:null},tenants:{type:Array,default:()=>[]},roles:{type:Array,default:()=>[]},permissions:{type:Array,default:()=>[]},isSuperAdmin:{type:Boolean,default:!1},tenantSlug:{type:String,default:null}},emits:["close","saved"],setup(h,{emit:j}){const u=h,x=j,w=F(""),n=F(""),v=F(!1),r=ee({name:"",email:"",password:"",tenant_id:null,roles:[],user_permissions:[]}),m=F(new Set),A=d=>{if(d){r.name=d.name??"",r.email=d.email??"",r.password="",r.tenant_id=d.tenant_id??null,r.roles=d.roles?d.roles.map(o=>o.id):[];const l=d.permissions?d.permissions.map(o=>o.name):[];r.user_permissions=l,m.value=new Set(l)}else r.name="",r.email="",r.password="",r.tenant_id=u.tenants.length?u.tenants[0].id:null,r.roles=[],r.user_permissions=[],m.value=new Set};te(()=>u.user,d=>A(d),{immediate:!0});const g=O(()=>{if(!w.value.trim())return u.roles;const d=w.value.toLowerCase();return u.roles.filter(l=>l.name.toLowerCase().includes(d))}),S=O(()=>r.user_permissions.length),k=O(()=>{const d=new Set;return u.roles.forEach(l=>{r.roles.includes(l.id)&&l.permissions&&l.permissions.forEach(o=>d.add(o.name))}),Array.from(d)}),L=(d,l)=>{const o=r.roles.indexOf(d);l&&o===-1&&r.roles.push(d),!l&&o!==-1&&r.roles.splice(o,1)},N=(d,l)=>{k.value.includes(d)||(l?m.value.add(d):m.value.delete(d),r.user_permissions=Array.from(m.value))},B=()=>{u.permissions.forEach(d=>{k.value.includes(d.name)||m.value.add(d.name)}),r.user_permissions=Array.from(m.value)},X=()=>{m.value.clear(),r.user_permissions=[]},W=d=>d.trim().toLowerCase()==="general"?"receive_updates":d,K=d=>{const l=W(d);u.permissions.filter(o=>o.name===l||o.name.startsWith(l+".")).forEach(o=>{k.value.includes(o.name)||m.value.add(o.name)}),r.user_permissions=Array.from(m.value)},y=d=>{const l=W(d);Array.from(m.value).forEach(o=>{(o===l||o.startsWith(l+"."))&&m.value.delete(o)}),r.user_permissions=Array.from(m.value)},p=O(()=>{const d=n.value.trim()?u.permissions.filter(o=>o.name.toLowerCase().includes(n.value.toLowerCase())):u.permissions,l={};return d.forEach(o=>{const V=o.name.split(".")[0];l[V]||(l[V]=[]),l[V].push(o)}),l}),C=d=>d==="tenant-settings"?"Tenant Settings":d==="repair-orders"?"Repair Orders":d==="safety-data"?"Safety Data":d==="miles-driven"?"Miles Driven":d==="support-tickets"?"Support Tickets":d==="sms-coaching"?"SMS Coaching":d==="support-responses"?"Support Responses":d==="receive_updates"||d==="general"?"General":d.charAt(0).toUpperCase()+d.slice(1),H=d=>{const l=d.split(".");return l.length>1?l[1].charAt(0).toUpperCase()+l[1].slice(1).replace(/-/g," "):d.replace(/_/g," ").replace(/\b\w/g,o=>o.toUpperCase())},E=()=>{r.user_permissions=Array.from(m.value);const d=()=>{u.user?u.isSuperAdmin?r.put(route("admin.users.update",u.user),{onSuccess:()=>x("saved")}):r.put(route("users.update",[u.tenantSlug,u.user]),{onSuccess:()=>x("saved")}):u.isSuperAdmin?r.post(route("admin.users.store"),{onSuccess:()=>x("saved")}):r.post(route("users.store",u.tenantSlug),{onSuccess:()=>x("saved")})};u.user&&!r.password?r.transform(l=>{const{password:o,...R}=l;return R}):r.transform(l=>l),d()};return(d,l)=>(i(),c("div",null,[t(e(de),null,{default:a(()=>[t(e(oe),{class:"text-xl sm:text-2xl font-bold flex items-center"},{default:a(()=>[t(e(ge),{class:"h-5 w-5 mr-2 text-primary"}),f(" "+_(h.user?"Edit User":"Create User"),1)]),_:1})]),_:1}),s("form",{onSubmit:le(E,["prevent"]),class:"space-y-4 mt-4"},[s("div",Je,[s("div",Ze,[t(e(U),{for:"name",class:"flex items-center"},{default:a(()=>l[10]||(l[10]=[s("span",null,"Name",-1),s("span",{class:"text-destructive ml-1"},"*",-1)])),_:1}),t(e(D),{id:"name",modelValue:e(r).name,"onUpdate:modelValue":l[0]||(l[0]=o=>e(r).name=o),placeholder:"Enter name",class:G(["w-full",{"border-destructive":e(r).errors.name}])},null,8,["modelValue","class"]),t(M,{message:e(r).errors.name},null,8,["message"])]),s("div",es,[t(e(U),{for:"email",class:"flex items-center"},{default:a(()=>l[11]||(l[11]=[s("span",null,"Email",-1),s("span",{class:"text-destructive ml-1"},"*",-1)])),_:1}),t(e(D),{id:"email",modelValue:e(r).email,"onUpdate:modelValue":l[1]||(l[1]=o=>e(r).email=o),type:"email",placeholder:"Enter email",class:G(["w-full",{"border-destructive":e(r).errors.email}])},null,8,["modelValue","class"]),t(M,{message:e(r).errors.email},null,8,["message"])]),s("div",ss,[t(e(U),{for:"password",class:"flex items-center"},{default:a(()=>[l[12]||(l[12]=s("span",null,"Password",-1)),h.user?$("",!0):(i(),c("span",ts,"*"))]),_:1}),s("div",ls,[t(e(D),{id:"password",modelValue:e(r).password,"onUpdate:modelValue":l[2]||(l[2]=o=>e(r).password=o),type:v.value?"text":"password",placeholder:h.user?"Leave blank to keep current password":"Enter password",class:G(["w-full pr-10",{"border-destructive":e(r).errors.password}])},null,8,["modelValue","type","placeholder","class"]),s("button",{type:"button",onClick:l[3]||(l[3]=o=>v.value=!v.value),class:"absolute inset-y-0 right-0 flex items-center pr-3 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"},[v.value?(i(),T(e(ye),{key:1,class:"h-5 w-5"})):(i(),T(e(xe),{key:0,class:"h-5 w-5"}))])]),t(M,{message:e(r).errors.password},null,8,["message"])]),h.isSuperAdmin?(i(),c("div",ns,[t(e(U),{for:"tenant"},{default:a(()=>l[13]||(l[13]=[f("Company Name")])),_:1}),ue(s("select",{id:"tenant","onUpdate:modelValue":l[4]||(l[4]=o=>e(r).tenant_id=o),class:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"},[l[14]||(l[14]=s("option",{value:null},"None",-1)),(i(!0),c(z,null,P(h.tenants,o=>(i(),c("option",{value:o.id,key:o.id},_(o.name),9,rs))),128))],512),[[me,e(r).tenant_id]]),t(M,{message:e(r).errors.tenant_id},null,8,["message"])])):$("",!0)]),s("div",is,[s("div",as,[s("div",os,[t(e(U),{class:"flex items-center"},{default:a(()=>[t(e(ne),{class:"h-4 w-4 mr-1 text-primary"}),l[15]||(l[15]=s("span",null,"Roles",-1)),t(e(I),{variant:"outline",class:"ml-2"},{default:a(()=>[f(_(e(r).roles.length)+" selected",1)]),_:1})]),_:1}),s("div",ds,[t(e(b),{type:"button",variant:"outline",size:"sm",class:"text-xs"},{default:a(()=>l[16]||(l[16]=[f("Select All")])),_:1}),t(e(b),{type:"button",variant:"outline",size:"sm",class:"text-xs"},{default:a(()=>l[17]||(l[17]=[f("Clear All")])),_:1})])]),s("div",us,[s("div",ms,[s("div",cs,[t(e(Y),{class:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),t(e(D),{modelValue:w.value,"onUpdate:modelValue":l[5]||(l[5]=o=>w.value=o),placeholder:"Search roles...",class:"w-full pl-9"},null,8,["modelValue"])]),w.value?(i(),T(e(b),{key:0,type:"button",variant:"ghost",size:"icon",onClick:l[6]||(l[6]=o=>w.value=""),class:"absolute right-2 top-2"},{default:a(()=>[t(e(q),{class:"h-4 w-4"})]),_:1})):$("",!0)])]),s("div",ps,[(i(!0),c(z,null,P(g.value,o=>(i(),c("div",{key:o.id,class:"flex items-center py-1 px-2 hover:bg-muted/50 rounded transition-colors"},[t(e(J),{id:`role-${o.id}`,"model-value":e(r).roles.includes(o.id),"onUpdate:modelValue":R=>L(o.id,R),class:"mr-2"},null,8,["id","model-value","onUpdate:modelValue"]),t(e(U),{for:`role-${o.id}`,class:"cursor-pointer"},{default:a(()=>[f(_(o.name),1)]),_:2},1032,["for"])]))),128)),g.value.length===0?(i(),c("div",fs,[t(e(Q),{class:"h-8 w-8 mb-2"}),l[18]||(l[18]=s("p",null,"No roles match your search",-1))])):$("",!0)]),t(M,{message:e(r).errors.roles},null,8,["message"])]),s("div",vs,[s("div",gs,[t(e(U),{class:"flex items-center"},{default:a(()=>[t(e(be),{class:"h-4 w-4 mr-1 text-primary"}),l[19]||(l[19]=s("span",null,"Permissions",-1)),t(e(I),{variant:"outline",class:"ml-2"},{default:a(()=>[f(_(S.value)+" selected",1)]),_:1})]),_:1}),s("div",xs,[t(e(b),{type:"button",variant:"outline",size:"sm",onClick:B,class:"text-xs"},{default:a(()=>l[20]||(l[20]=[f(" Select All ")])),_:1}),t(e(b),{type:"button",variant:"outline",size:"sm",onClick:X,class:"text-xs"},{default:a(()=>l[21]||(l[21]=[f(" Clear All ")])),_:1})])]),s("div",ys,[s("div",bs,[s("div",_s,[t(e(Y),{class:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),t(e(D),{modelValue:n.value,"onUpdate:modelValue":l[7]||(l[7]=o=>n.value=o),placeholder:"Search permissions...",class:"w-full pl-9"},null,8,["modelValue"])]),n.value?(i(),T(e(b),{key:0,type:"button",variant:"ghost",size:"icon",onClick:l[8]||(l[8]=o=>n.value=""),class:"absolute right-2 top-2"},{default:a(()=>[t(e(q),{class:"h-4 w-4"})]),_:1})):$("",!0)])]),s("div",hs,[(i(!0),c(z,null,P(p.value,(o,R)=>(i(),c("div",{key:R,class:"mb-4"},[s("div",ks,[s("div",$s,[t(e(re),{class:"h-4 w-4 mr-1 text-muted-foreground"}),f(" "+_(C(String(R)))+" ",1),t(e(I),{variant:"secondary",class:"ml-2"},{default:a(()=>[f(_(o.length),1)]),_:2},1024)]),s("div",ws,[t(e(b),{type:"button",variant:"ghost",size:"sm",onClick:V=>K(String(R)),class:"text-xs h-6 px-2"},{default:a(()=>l[22]||(l[22]=[f(" Select All ")])),_:2},1032,["onClick"]),t(e(b),{type:"button",variant:"ghost",size:"sm",onClick:V=>y(String(R)),class:"text-xs h-6 px-2"},{default:a(()=>l[23]||(l[23]=[f(" Clear ")])),_:2},1032,["onClick"])])]),(i(!0),c(z,null,P(o,V=>(i(),c("div",{key:V.id,class:"flex items-center py-1 px-2 hover:bg-muted/50 rounded transition-colors"},[t(e(J),{id:`permission-${V.name}`,"model-value":e(r).user_permissions.includes(V.name),"onUpdate:modelValue":ce=>N(V.name,ce),disabled:k.value.includes(V.name),class:"mr-2"},null,8,["id","model-value","onUpdate:modelValue","disabled"]),t(e(U),{for:`permission-${V.name}`,class:"cursor-pointer text-sm"},{default:a(()=>[f(_(H(V.name))+" ",1),k.value.includes(V.name)?(i(),c("span",Ss," inherited ")):$("",!0)]),_:2},1032,["for"])]))),128))]))),128)),Object.keys(p.value).length===0?(i(),c("div",Cs,[t(e(Q),{class:"h-8 w-8 mb-2"}),l[24]||(l[24]=s("p",null,"No permissions match your search",-1))])):$("",!0)]),t(M,{message:e(r).errors.user_permissions},null,8,["message"])])]),t(e(ae),{class:"mt-6"},{default:a(()=>[t(e(b),{type:"button",onClick:l[9]||(l[9]=()=>x("close")),variant:"outline"},{default:a(()=>l[25]||(l[25]=[f(" Cancel ")])),_:1}),t(e(b),{type:"submit",disabled:e(r).processing},{default:a(()=>[e(r).processing?(i(),T(e(ie),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):$("",!0),f(" "+_(e(r).processing?"Saving...":"Save"),1)]),_:1},8,["disabled"])]),_:1})],32)]))}}),As={class:"w-full overflow-x-auto"},Ts={class:"rounded-md border"},zs={class:"w-full caption-bottom text-sm"},Ps={class:"[&_tr:last-child]:border-0"},Es={class:"p-4 align-middle font-medium"},Vs={class:"p-4 align-middle"},Us={class:"p-4 align-middle"},js={class:"p-4 align-middle text-right"},Ls={class:"flex justify-end space-x-2"},Ms={key:0,class:"mt-6 flex justify-center"},Ns={class:"flex flex-wrap items-center gap-1 justify-center"},ft={__name:"TenantList",props:{tenants:{type:Object,default:()=>({data:[],links:[]})}},setup(h){const j=h,u={"America/New_York":"Eastern Time (ET)","America/Chicago":"Central Time (CT)","America/Denver":"Mountain Time (MT)","America/Los_Angeles":"Pacific Time (PT)","America/Anchorage":"Alaska Time (AKT)","Pacific/Honolulu":"Hawaii Time (HAST)","America/Phoenix":"Arizona Time (no DST)","America/Indiana/Indianapolis":"Eastern Time (Indiana)"},x=v=>u[v]||v,w=O(()=>Array.isArray(j.tenants)?j.tenants:j.tenants.data||[]),n=v=>{v&&Z.get(v,{},{only:["tenants"]})};return(v,r)=>(i(),c("div",As,[s("div",Ts,[s("table",zs,[r[2]||(r[2]=s("thead",{class:"[&_tr]:border-b"},[s("tr",{class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},[s("th",{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},"Company Name"),s("th",{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},"Slug"),s("th",{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},"Timezone"),s("th",{class:"h-12 px-4 text-right pr-16 align-middle font-medium text-muted-foreground"},"Actions")])],-1)),s("tbody",Ps,[(i(!0),c(z,null,P(w.value,m=>(i(),c("tr",{key:m.id,class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},[s("td",Es,_(m.name),1),s("td",Vs,_(m.slug),1),s("td",Us,_(x(m.timezone)),1),s("td",js,[s("div",Ls,[t(e(b),{onClick:A=>v.$emit("edit",m),variant:"outline",size:"sm"},{default:a(()=>r[0]||(r[0]=[f(" Edit ")])),_:2},1032,["onClick"]),t(e(b),{onClick:A=>v.$emit("delete",m),variant:"destructive",size:"sm"},{default:a(()=>r[1]||(r[1]=[f(" Delete ")])),_:2},1032,["onClick"])])])]))),128))])])]),h.tenants.links?(i(),c("div",Ms,[s("nav",Ns,[(i(!0),c(z,null,P(h.tenants.links,m=>(i(),T(e(b),{key:m.label,onClick:A=>n(m.url),disabled:!m.url,variant:m.active?"default":"outline",size:"sm",class:"min-w-[40px]",innerHTML:m.label},null,8,["onClick","disabled","variant","innerHTML"]))),128))])])):$("",!0)]))}},Rs={class:"space-y-2"},Ds={key:0,class:"space-y-2"},Os={class:"space-y-2"},Hs=["value"],vt=se({__name:"TenantForm",props:{tenant:{type:Object,default:null}},emits:["close","saved"],setup(h,{emit:j}){const u=h,x=j,w={"America/New_York":"Eastern Time (ET)","America/Chicago":"Central Time (CT)","America/Denver":"Mountain Time (MT)","America/Los_Angeles":"Pacific Time (PT)","America/Anchorage":"Alaska Time (AKT)","Pacific/Honolulu":"Hawaii Time (HAST)","America/Phoenix":"Arizona Time (no DST)","America/Indiana/Indianapolis":"Eastern Time (Indiana)"},n=ee({name:u.tenant?u.tenant.name:"",slug:u.tenant?u.tenant.slug:"",timezone:u.tenant?u.tenant.timezone:"America/Indiana/Indianapolis"});te(()=>u.tenant,r=>{r?(n.name=r.name,n.slug=r.slug,n.timezone=r.timezone):(n.name="",n.slug="",n.timezone="America/Indiana/Indianapolis")},{immediate:!0});const v=()=>{u.tenant?n.put(route("admin.tenants.update",u.tenant),{onSuccess:()=>{x("saved")}}):n.post(route("admin.tenants.store"),{onSuccess:()=>{x("saved")}})};return(r,m)=>(i(),c("div",null,[t(e(de),null,{default:a(()=>[t(e(oe),{class:"text-xl sm:text-2xl font-bold"},{default:a(()=>[f(_(h.tenant?"Edit Company":"Create Company"),1)]),_:1})]),_:1}),s("form",{onSubmit:le(v,["prevent"]),class:"space-y-4 mt-4"},[s("div",Rs,[t(e(U),{for:"name",class:"flex items-center"},{default:a(()=>m[4]||(m[4]=[s("span",null,"Company Name",-1),s("span",{class:"text-destructive ml-1"},"*",-1)])),_:1}),t(e(D),{id:"name",modelValue:e(n).name,"onUpdate:modelValue":m[0]||(m[0]=A=>e(n).name=A),placeholder:"Enter company name",class:G(["w-full",{"border-destructive":e(n).errors.name}])},null,8,["modelValue","class"]),t(M,{message:e(n).errors.name},null,8,["message"])]),h.tenant?(i(),c("div",Ds,[t(e(U),{for:"slug"},{default:a(()=>m[5]||(m[5]=[f("Slug")])),_:1}),t(e(D),{id:"slug",modelValue:e(n).slug,"onUpdate:modelValue":m[1]||(m[1]=A=>e(n).slug=A),placeholder:"Enter company slug",class:G(["w-full",{"border-destructive":e(n).errors.slug}])},null,8,["modelValue","class"]),t(M,{message:e(n).errors.slug},null,8,["message"])])):$("",!0),s("div",Os,[t(e(U),{for:"timezone",class:"flex items-center"},{default:a(()=>m[6]||(m[6]=[s("span",null,"Timezone",-1),s("span",{class:"text-destructive ml-1"},"*",-1)])),_:1}),ue(s("select",{id:"timezone","onUpdate:modelValue":m[2]||(m[2]=A=>e(n).timezone=A),class:G(["flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive":e(n).errors.timezone}])},[(i(),c(z,null,P(w,(A,g)=>s("option",{key:g,value:g},_(A),9,Hs)),64))],2),[[me,e(n).timezone]]),t(M,{message:e(n).errors.timezone},null,8,["message"])]),t(e(ae),{class:"mt-6"},{default:a(()=>[t(e(b),{type:"button",onClick:m[3]||(m[3]=()=>x("close")),variant:"outline"},{default:a(()=>m[7]||(m[7]=[f(" Cancel ")])),_:1}),t(e(b),{type:"submit",disabled:e(n).processing},{default:a(()=>[e(n).processing?(i(),T(e(ie),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):$("",!0),f(" "+_(e(n).processing?"Saving...":"Save"),1)]),_:1},8,["disabled"])]),_:1})],32)]))}}),Gs={class:"space-y-2"},Is={class:"space-y-2"},Bs={class:"flex justify-between items-center"},Fs={class:"flex space-x-2"},Ws={class:"relative"},Ks={class:"flex items-center space-x-2"},Xs={class:"relative w-full"},Ys={class:"h-64 border rounded-md p-2 overflow-y-auto"},qs={class:"flex items-center justify-between mb-1"},Qs={class:"font-medium text-sm text-foreground flex items-center"},Js={class:"flex space-x-1"},Zs={key:0,class:"flex flex-col items-center justify-center h-full text-muted-foreground"},gt=se({__name:"RoleForm",props:{role:{type:Object,default:null},permissions:{type:Array,default:()=>[]},isSuperAdmin:{type:Boolean,default:!1},tenantSlug:{type:String,default:null}},emits:["saved","close"],setup(h,{emit:j}){var W,K;const u=j,x=h,{tenantSlug:w}=x,n=ee({name:x.role?x.role.name:"",permissions:((K=(W=x.role)==null?void 0:W.permissions)==null?void 0:K.map(y=>y.name))||[]}),v=F(""),r=O(()=>n.permissions.length),m=O(()=>{const y=v.value.trim()?x.permissions.filter(C=>C.name.toLowerCase().includes(v.value.toLowerCase())):x.permissions,p={};return y.forEach(C=>{const E=C.name.split(".")[0];p[E]||(p[E]=[]),p[E].push(C)}),p}),A=y=>y==="tenant-settings"?"Tenant Settings":y==="repair-orders"?"Repair Orders":y==="safety-data"?"Safety Data":y==="miles-driven"?"Miles Driven":y==="support-tickets"?"Support Tickets":y==="sms-coaching"?"SMS Coaching":y==="support-responses"?"Support Responses":y==="receive_updates"?"General":y.charAt(0).toUpperCase()+y.slice(1),g=y=>{const p=y.split(".");return p.length>1?p[1].charAt(0).toUpperCase()+p[1].slice(1).replace(/-/g," "):y};te(()=>x.role,y=>{var p;y?(n.name=y.name,n.permissions=((p=y.permissions)==null?void 0:p.map(C=>C.name))||[]):(n.name="",n.permissions=[])},{immediate:!0});const S=y=>{const p=n.permissions.indexOf(y);p===-1?n.permissions.push(y):n.permissions.splice(p,1)},k=()=>{n.permissions=x.permissions.map(y=>y.name)},L=()=>{n.permissions=[]},N=y=>{x.permissions.filter(C=>C.name.startsWith(y+".")).map(C=>C.name).forEach(C=>{n.permissions.includes(C)||n.permissions.push(C)})},B=y=>{n.permissions=n.permissions.filter(p=>!p.startsWith(y+"."))},X=()=>{x.role?x.isSuperAdmin?n.put(route("admin.roles.update",x.role.id),{onSuccess:()=>{u("saved")}}):n.put(route("roles.update",[w,x.role.id]),{onSuccess:()=>{u("saved")}}):x.isSuperAdmin?n.post(route("admin.roles.store"),{onSuccess:()=>{u("saved")}}):n.post(route("roles.store",w),{onSuccess:()=>{u("saved")}})};return(y,p)=>(i(),c("div",null,[t(e(de),null,{default:a(()=>[t(e(oe),{class:"text-xl sm:text-2xl font-bold flex items-center"},{default:a(()=>[t(e(ne),{class:"h-5 w-5 mr-2 text-primary"}),f(" "+_(h.role?"Edit Role":"Create Role"),1)]),_:1})]),_:1}),s("form",{onSubmit:le(X,["prevent"]),class:"space-y-4 mt-4"},[s("div",Gs,[t(e(U),{for:"name",class:"flex items-center"},{default:a(()=>p[4]||(p[4]=[s("span",null,"Role Name",-1),s("span",{class:"text-destructive ml-1"},"*",-1)])),_:1}),t(e(D),{id:"name",modelValue:e(n).name,"onUpdate:modelValue":p[0]||(p[0]=C=>e(n).name=C),placeholder:"Enter role name",class:G(["w-full",{"border-destructive":e(n).errors.name}]),autofocus:""},null,8,["modelValue","class"]),t(M,{message:e(n).errors.name},null,8,["message"])]),s("div",Is,[s("div",Bs,[t(e(U),{class:"flex items-center"},{default:a(()=>[p[5]||(p[5]=s("span",null,"Permissions",-1)),t(e(I),{variant:"outline",class:"ml-2"},{default:a(()=>[f(_(r.value)+" selected",1)]),_:1})]),_:1}),s("div",Fs,[t(e(b),{type:"button",variant:"outline",size:"sm",onClick:k,class:"text-xs"},{default:a(()=>p[6]||(p[6]=[f(" Select All ")])),_:1}),t(e(b),{type:"button",variant:"outline",size:"sm",onClick:L,class:"text-xs"},{default:a(()=>p[7]||(p[7]=[f(" Clear All ")])),_:1})])]),s("div",Ws,[s("div",Ks,[s("div",Xs,[t(e(Y),{class:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),t(e(D),{modelValue:v.value,"onUpdate:modelValue":p[1]||(p[1]=C=>v.value=C),placeholder:"Search permissions...",class:"w-full pl-9"},null,8,["modelValue"])]),v.value?(i(),T(e(b),{key:0,type:"button",variant:"ghost",size:"icon",onClick:p[2]||(p[2]=C=>v.value=""),class:"absolute right-2 top-2"},{default:a(()=>[t(e(q),{class:"h-4 w-4"})]),_:1})):$("",!0)])]),s("div",Ys,[(i(!0),c(z,null,P(m.value,(C,H)=>(i(),c("div",{key:H,class:"mb-4"},[s("div",qs,[s("div",Qs,[t(e(re),{class:"h-4 w-4 mr-1 text-muted-foreground"}),f(" "+_(A(H))+" ",1),t(e(I),{variant:"secondary",class:"ml-2"},{default:a(()=>[f(_(C.length),1)]),_:2},1024)]),s("div",Js,[t(e(b),{type:"button",variant:"ghost",size:"sm",onClick:E=>N(H),class:"text-xs h-6 px-2"},{default:a(()=>p[8]||(p[8]=[f(" Select All ")])),_:2},1032,["onClick"]),t(e(b),{type:"button",variant:"ghost",size:"sm",onClick:E=>B(H),class:"text-xs h-6 px-2"},{default:a(()=>p[9]||(p[9]=[f(" Clear ")])),_:2},1032,["onClick"])])]),(i(!0),c(z,null,P(C,E=>(i(),c("div",{key:E.id,class:"flex items-center py-1 px-2 hover:bg-muted/50 rounded transition-colors"},[t(e(J),{id:`permission-${E.name}`,checked:e(n).permissions.includes(E.name),"onUpdate:checked":d=>S(E.name),class:"mr-2"},null,8,["id","checked","onUpdate:checked"]),t(e(U),{for:`permission-${E.name}`,class:"cursor-pointer text-sm"},{default:a(()=>[f(_(g(E.name)),1)]),_:2},1032,["for"])]))),128))]))),128)),Object.keys(m.value).length===0?(i(),c("div",Zs,[t(e(Q),{class:"h-8 w-8 mb-2"}),p[10]||(p[10]=s("p",null,"No permissions match your search",-1))])):$("",!0)]),t(M,{message:e(n).errors.permissions},null,8,["message"])]),t(e(ae),{class:"mt-6"},{default:a(()=>[t(e(b),{type:"button",onClick:p[3]||(p[3]=()=>u("close")),variant:"outline"},{default:a(()=>p[11]||(p[11]=[f(" Cancel ")])),_:1}),t(e(b),{type:"submit",disabled:e(n).processing},{default:a(()=>[e(n).processing?(i(),T(e(ie),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):$("",!0),f(" "+_(e(n).processing?"Saving...":"Save"),1)]),_:1},8,["disabled"])]),_:1})],32)]))}});export{mt as _,ct as a,ft as b,pt as c,vt as d,gt as e};
