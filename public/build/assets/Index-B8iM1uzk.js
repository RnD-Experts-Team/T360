import{A as nt,K as rt,r as _,c as te,w as $e,b as x,e as i,f as a,l as s,X as n,u as t,k as p,S as o,U as u,P as q,L as c,b2 as z,M as V,N as D,D as oe,bF as Pe,Y as Fe}from"./vendor-cgn9wV4E.js";import{_ as w}from"./Icon.vue_vue_type_script_setup_true_lang-g5QrAIpa.js";import{_ as _e,a as ge,b as L,c as M,d as ye,e as y}from"./TableRow.vue_vue_type_script_setup_true_lang-58J5Q7id.js";import{_ as g}from"./Button.vue_vue_type_script_setup_true_lang-DA-5a5tM.js";import{_ as se}from"./Card.vue_vue_type_script_setup_true_lang-DQTQMX6v.js";import{_ as ae}from"./CardContent.vue_vue_type_script_setup_true_lang-DNXZ8J1r.js";import{b as ie,_ as ue,a as de}from"./DialogDescription.vue_vue_type_script_setup_true_lang-BDOQqQHy.js";import{_ as me,a as ce}from"./DialogTitle.vue_vue_type_script_setup_true_lang-K_t0Wv0O.js";import{_ as be}from"./DialogFooter.vue_vue_type_script_setup_true_lang-C4cZ_wVx.js";import{_ as $}from"./Label.vue_vue_type_script_setup_true_lang-WOFpmVDV.js";import{_ as E}from"./Input.vue_vue_type_script_setup_true_lang-1zH_gJ02.js";import{b as we,_ as ke,a as he}from"./AlertDescription.vue_vue_type_script_setup_true_lang-BdYx0SaG.js";import{_ as ot}from"./AppLayout.vue_vue_type_script_setup_true_lang-Bx6WXffK.js";import{a as it,x as Se,g as ut,W as le}from"./vendor-vue-C6le94gM.js";import"./utils-C4uCeQPu.js";import"./vendor-icons-Bu7C1ObZ.js";import"./vendor-ui-BuPyOEYe.js";import"./useInitials-DzeGKvtI.js";import"./app-BwOLsRrX.js";import"./vendor-axios-C0Zqfgkc.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BM02NuXb.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const dt={class:"w-full md:max-w-2xl lg:max-w-3xl xl:max-w-6xl lg:mx-auto m-0 p-2 md:p-4 lg:p-6 space-y-2 md:space-y-4 lg:space-y-6"},mt={class:"w-full md:max-w-xl lg:max-w-2xl xl:max-w-6xl m-auto pt-2 space-y-2 md:space-y-4 lg:space-y-6"},ct={class:"flex flex-col md:flex-row md:items-center md:justify-between gap-2"},pt={class:"flex flex-wrap gap-3"},ft={class:"flex flex-col items-center md:items-start gap-2"},vt={class:"flex flex-wrap gap-1 md:gap-2"},xt={key:0,class:"text-sm text-muted-foreground"},_t={key:0},gt={key:1},yt={key:2},bt={key:3,class:"ml-1"},wt={class:"overflow-x-auto"},kt={class:"flex items-center justify-center"},ht=["checked"],St={class:"flex items-center"},Ct=["title"],Vt={key:0,class:"ml-2"},Dt={key:0,class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Nt={key:1,class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},$t={key:1,class:"ml-2 opacity-50"},Pt=["value"],Ft={class:"text-xs italic text-gray-500 whitespace-normal"},Mt={class:"text-xs italic text-gray-500 whitespace-normal"},Tt={class:"text-xs italic text-gray-500 whitespace-normal"},At={class:"text-xs italic text-gray-500 whitespace-normal"},Et={class:"text-xs italic text-gray-500 whitespace-normal"},Rt={class:"text-xs italic text-gray-500 whitespace-normal"},Ut={class:"text-xs italic text-gray-500 whitespace-normal"},It={class:"flex space-x-2"},Bt={key:0,class:"border-t bg-muted/20 px-4 py-3"},Ot={class:"flex flex-col sm:flex-row justify-between items-center gap-2"},Lt={class:"flex items-center gap-4 text-sm text-muted-foreground"},Wt={class:"flex flex-col sm:flex-row items-center gap-2 sm:gap-4 w-full sm:w-auto"},jt=["value"],qt={class:"flex flex-wrap"},zt=["innerHTML"],Ht={key:0,class:"col-span-2"},Yt={class:"relative mt-1"},Gt=["value"],Kt={class:"col-span-2 sm:col-span-1"},Qt={class:"col-span-2 sm:col-span-1"},Xt={class:"col-span-2 sm:col-span-1"},Jt={class:"col-span-2 sm:col-span-1"},Zt={class:"col-span-2 sm:col-span-1"},es={class:"col-span-2 sm:col-span-1"},ts={class:"col-span-2 sm:col-span-1"},ss={class:"col-span-2 sm:col-span-1"},as={class:"col-span-2 flex items-center gap-2"},ls={class:"flex items-center gap-2"},ns={class:"flex-1 overflow-y-auto px-4 sm:px-6 py-4"},rs={key:0},os={class:"space-y-4"},is={class:"cursor-pointer mt-3"},us=["disabled"],ds={key:0,class:"mt-3 text-xs text-primary font-medium"},ms={class:"flex items-center gap-2 text-sm text-muted-foreground"},cs=["href"],ps={key:0,class:"flex items-center justify-center gap-2 p-4"},fs={key:1,class:"space-y-4"},vs={key:0,class:"rounded-lg border p-3"},xs={class:"flex items-center justify-between"},_s={class:"text-xs text-muted-foreground"},gs={class:"mt-2 flex flex-wrap gap-2"},ys={class:"grid grid-cols-3 gap-4"},bs={class:"text-2xl font-bold"},ws={class:"text-2xl font-bold text-green-600"},ks={class:"text-2xl font-bold text-red-600"},hs={key:2},Ss={class:"flex items-center justify-between mb-3"},Cs={class:"text-lg font-semibold text-red-600 flex items-center gap-2"},Vs={class:"border rounded-lg overflow-hidden"},Ds={class:"max-h-96 overflow-y-auto"},Ns={class:"flex flex-wrap gap-x-3 gap-y-1"},$s={class:"font-medium text-foreground"},Ps={key:0,class:"italic text-muted-foreground"},Fs={class:"space-y-1"},Ms={key:0,class:"text-xs text-muted-foreground"},Ts={key:3},As={class:"text-lg font-semibold text-green-600 flex items-center gap-2 mb-3"},Es={class:"border rounded-lg overflow-hidden"},Rs={class:"flex flex-wrap gap-x-3 gap-y-1"},Us={class:"font-medium"},Is={key:0,class:"italic text-muted-foreground"},Bs={class:"border-t p-4 flex justify-end gap-3"},Os={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"},ua={__name:"Index",props:{performances:{type:Object,default:()=>({data:[],links:[]})},tenantSlug:{type:String,default:null},SuperAdmin:{type:Boolean,default:!1},tenants:{type:Array,default:()=>[]},dateFilter:{type:String,default:"yesterday"},dateRange:{type:Object,default:()=>({label:"All Time"})},perPage:{type:Number,default:10},weekNumber:{type:Number,default:null},startWeekNumber:{type:Number,default:null},endWeekNumber:{type:Number,default:null},year:{type:Number,default:null},permissions:Array},setup(b){const d=b,Me=it();nt(()=>{const r=e=>e.preventDefault();window.addEventListener("dragover",r),window.addEventListener("drop",r),rt(()=>{window.removeEventListener("dragover",r),window.removeEventListener("drop",r)})});const pe=_(null),R=_(!1);let W=0;const Ce=te(()=>(h.value==="yesterday"||h.value==="current-week")&&d.weekNumber&&d.year?`Week ${d.weekNumber}, ${d.year}`:(h.value==="6w"||h.value==="quarterly")&&d.startWeekNumber&&d.endWeekNumber&&d.year?`Weeks ${d.startWeekNumber}-${d.endWeekNumber}, ${d.year}`:""),P=_(""),T=_(""),H=_(!1),fe=_("Create Performance"),Y=_("Create"),h=_(d.dateFilter||"full"),G=_(d.perPage||10),S=_([]),K=_(!1),Q=_(!1),X=_(null),ve=_(null),J=_(!1),f=_(null),U=_(!1),I=_(!1),Te=[{title:d.tenantSlug?"Dashboard":"Admin Dashboard",href:d.tenantSlug?route("dashboard",{tenantSlug:d.tenantSlug}):route("admin.dashboard")},{title:"Performance",href:d.tenantSlug?route("performance.index",{tenantSlug:d.tenantSlug}):route("performance.index.admin")}];function Ae(r){if(r){const e=new URL(r);e.searchParams.set("perPage",G.value),e.searchParams.set("dateFilter",h.value),le.get(e.href,{},{only:["performances"]})}}const Z=_("date"),j=_("desc"),xe=["date","acceptance","on_time_to_origin","on_time_to_destination","on_time","maintenance_variance_to_spend","open_boc","meets_safety_bonus_criteria","vcr_preventable","vmcr_p"],m=Se({tenant_id:null,date:"",acceptance:"",on_time_to_origin:"",on_time_to_destination:"",maintenance_variance_to_spend:"",open_boc:"",meets_safety_bonus_criteria:!1,vcr_preventable:"",vmcr_p:"",id:null}),Ee=Se({}),B=te(()=>{let r=[...d.performances.data];return r.sort((e,l)=>{let v=e[Z.value],N=l[Z.value];return v===null?1:N===null?-1:(typeof v=="string"&&(v=v.toLowerCase(),N=N.toLowerCase()),v<N?j.value==="asc"?-1:1:v>N?j.value==="asc"?1:-1:0)}),r});function Re(r){Z.value===r?j.value=j.value==="asc"?"desc":"asc":(Z.value=r,j.value="asc")}function ne(r){h.value=r;const e=d.tenantSlug?route("performance.index",{tenantSlug:d.tenantSlug}):route("performance.index.admin");le.get(e,{dateFilter:r,perPage:G.value},{preserveState:!0})}function Ue(){const r=Y.value==="Create",e=r?d.SuperAdmin?route("performance.store.admin"):route("performance.store",d.tenantSlug):d.SuperAdmin?route("performance.update.admin",[m.id]):route("performance.update",[d.tenantSlug,m.id]);m[r?"post":"put"](e,{onSuccess:()=>{T.value=r?"Performance created successfully.":"Performance updated successfully.",Ve()},onError:()=>{alert("Something went wrong.")}})}function Ie(){var e,l;if(B.value.length===0){P.value="No data available to export",setTimeout(()=>{P.value=""},3e3);return}const r=d.SuperAdmin?route("performance.export.admin"):route("performance.export",d.tenantSlug);(e=ve.value)==null||e.setAttribute("action",r),(l=ve.value)==null||l.submit()}$e(T,r=>{r&&setTimeout(()=>{T.value=""},5e3)});function re(r){if(!r)return"";const e=new Date(r+"T12:00:00"),l=e.getMonth()+1,v=e.getDate(),N=e.getFullYear();return`${l}/${v}/${N}`}function Be(){fe.value="Create Performance",Y.value="Create",m.reset(),m.clearErrors(),d.SuperAdmin&&d.tenants.length>0&&(m.tenant_id=""),H.value=!0}function Oe(r){fe.value="Edit Performance",Y.value="Update",m.reset(),m.clearErrors(),m.id=r.id,m.tenant_id=r.tenant_id,m.date=r.date,m.acceptance=r.acceptance,m.on_time_to_origin=r.on_time_to_origin,m.on_time_to_destination=r.on_time_to_destination,m.maintenance_variance_to_spend=r.maintenance_variance_to_spend,m.open_boc=r.open_boc,m.meets_safety_bonus_criteria=r.meets_safety_bonus_criteria,m.vcr_preventable=r.vcr_preventable,m.vmcr_p=r.vmcr_p,H.value=!0}function Ve(){H.value=!1,m.reset(),m.clearErrors()}function Le(r){X.value=r,Q.value=!0}function We(){if(!X.value)return;const r=d.SuperAdmin?route("performance.destroy.admin",[X.value]):route("performance.destroy",[d.tenantSlug,X.value]);Ee.delete(r,{onSuccess:()=>{T.value="Performance deleted successfully.",Q.value=!1,X.value=null},onError:()=>{alert("Failed to delete performance record.")}})}const je=te(()=>B.value.length>0&&S.value.length===B.value.length);function qe(r){r.target.checked?S.value=B.value.map(e=>e.id):S.value=[]}function ze(){S.value.length>0&&(K.value=!0)}function He(){const r=Se({ids:S.value}),e=d.SuperAdmin?"performance.destroyBulk.admin":"performance.destroyBulk",l=d.SuperAdmin?{}:{tenantSlug:d.tenantSlug};r.delete(route(e,l),{preserveScroll:!0,onSuccess:()=>{T.value=`${S.value.length} performance records deleted successfully.`,S.value=[],K.value=!1},onError:v=>{console.error(v)}})}const O=r=>{if(!r)return"Not Available";switch(r){case"gold":return"Gold Tier";case"silver":return"Silver Tier";case"not_eligible":return"Not Eligible";case"fantastic_plus":return"Fantastic +";case"fantastic":return"Fantastic";case"good":return"Good";case"fair":return"Fair";case"poor":return"Poor";default:return r}},Ye=r=>({on_time_to_origin:"OTO",on_time_to_destination:"OTD",maintenance_variance_to_spend:"MVtS",open_boc:"Open BOC",vcr_preventable:"VCR-P",vmcr_p:"VMCR-P"})[r]||r.replace(/_/g," ").split(" ").map(l=>l.charAt(0).toUpperCase()+l.slice(1)).join(" "),Ge=r=>({on_time_to_origin:"On Time to Origin",on_time_to_destination:"On Time to Destination",maintenance_variance_to_spend:"Maintenance Variance to Spend",open_boc:"Open BOC",vcr_preventable:"VCR Preventable",vmcr_p:"VMCR P"})[r]||r.replace(/_/g," ").split(" ").map(l=>l.charAt(0).toUpperCase()+l.slice(1)).join(" ");function Ke(){const r=d.tenantSlug?route("performance.index",{tenantSlug:d.tenantSlug}):route("performance.index.admin");le.get(r,{dateFilter:h.value,perPage:G.value},{preserveState:!0})}const ee=r=>{if(r==null)return"—";const e=typeof r=="string"?parseFloat(r):r;return Number.isInteger(e)||e.toFixed(2).endsWith(".00")?Math.floor(e):e.toFixed(2).endsWith("0")?e.toFixed(1):e.toFixed(2)},C=te(()=>d.permissions.map(r=>r.name)),Qe=te(()=>"/storage/upload-data-temps/Performances Template.csv");function De(r){if(!r)return;if(!(r.type==="text/csv"||r.name.toLowerCase().endsWith(".csv")||r.type==="")){P.value="Please upload a valid CSV file.",setTimeout(()=>P.value="",4e3);return}U.value=!0;const l=new FormData;l.append("file",r);const v=d.tenantSlug?route("performance.validateImport",{tenantSlug:d.tenantSlug}):route("performance.validateImport.admin");le.post(v,l,{forceFormData:!0,preserveScroll:!0,only:["flash"],onFinish:()=>{U.value=!1},onError:()=>{U.value=!1,P.value="Failed to validate CSV file"}})}function Xe(r){var l;const e=(l=r.target.files)==null?void 0:l[0];e&&(De(e),r.target.value="")}function Je(){W+=1,R.value=!0}function Ze(){R.value=!0}function et(){W-=1,W<=0&&(W=0,R.value=!1)}function tt(r){var l,v;W=0,R.value=!1;const e=(v=(l=r.dataTransfer)==null?void 0:l.files)==null?void 0:v[0];e&&De(e)}function st(){var e;if(!f.value||(((e=f.value.summary)==null?void 0:e.invalid)??0)>0||f.value.header_error)return;I.value=!0;const r=d.tenantSlug?route("performance.confirmImport",{tenantSlug:d.tenantSlug}):route("performance.confirmImport.admin");le.post(r,{},{preserveScroll:!0,onSuccess:()=>{var l;T.value=`Successfully imported ${((l=f.value.summary)==null?void 0:l.valid)??0} performances`,Ne()},onError:()=>{P.value="Failed to import performances"},onFinish:()=>{I.value=!1}})}function at(){const r=d.tenantSlug?route("performance.downloadErrorReport",{tenantSlug:d.tenantSlug}):route("performance.downloadErrorReport.admin");window.location.href=r}function Ne(){J.value=!1,f.value=null,U.value=!1,I.value=!1,R.value=!1,W=0,pe.value&&(pe.value.value="")}return $e(()=>{var r;return(r=Me.props.flash)==null?void 0:r.importValidation},r=>{if(r){if(r.results){f.value=r.results,r.header_error&&(f.value.header_error=r.header_error),J.value=!0;return}r.message&&(P.value=r.message)}},{immediate:!0}),(r,e)=>(i(),x(ot,{breadcrumbs:Te,tenantSlug:b.tenantSlug,permissions:d.permissions},{default:a(()=>[s(t(ut),{title:"Performance"}),n("div",dt,[T.value?(i(),x(t(we),{key:0,variant:"success"},{default:a(()=>[s(t(ke),null,{default:a(()=>e[25]||(e[25]=[o("Success")])),_:1}),s(t(he),null,{default:a(()=>[o(u(T.value),1)]),_:1})]),_:1})):p("",!0),P.value?(i(),x(t(we),{key:1,variant:"destructive"},{default:a(()=>[s(t(ke),null,{default:a(()=>e[26]||(e[26]=[o("Error")])),_:1}),s(t(he),null,{default:a(()=>[o(u(P.value),1)]),_:1})]),_:1})):p("",!0),n("div",mt,[n("div",ct,[e[30]||(e[30]=n("h1",{class:"text-lg md:text-xl lg:text-2xl font-bold text-gray-800 dark:text-gray-200"}," Performance Management ",-1)),n("div",pt,[C.value.includes("performance.create")?(i(),x(t(g),{key:0,class:"px-2 py-0 md:px-4 md:py-2",onClick:Be,variant:"default"},{default:a(()=>[s(w,{name:"plus",class:"mr-1 h-4 w-4 md:mr-2"}),e[27]||(e[27]=o(" Create New Performance "))]),_:1})):p("",!0),S.value.length>0&&C.value.includes("performance.delete")?(i(),x(t(g),{key:1,class:"px-2 py-0 md:px-4 md:py-2",onClick:e[0]||(e[0]=l=>ze()),variant:"destructive"},{default:a(()=>[s(w,{name:"trash",class:"mr-1 h-4 w-4 md:mr-2"}),o(" Delete Selected ("+u(S.value.length)+") ",1)]),_:1})):p("",!0),C.value.includes("performance.import")?(i(),x(t(g),{key:2,onClick:e[1]||(e[1]=l=>J.value=!0),variant:"secondary",class:"px-2 py-0 md:px-4 md:py-2 shadow-sm hover:shadow transition-all"},{default:a(()=>[s(w,{name:"upload",class:"mr-1 h-4 w-4 md:mr-2"}),e[28]||(e[28]=o(" Import CSV "))]),_:1})):p("",!0),C.value.includes("performance.export")?(i(),x(t(g),{key:3,class:"px-2 py-0 md:px-4 md:py-2",onClick:q(Ie,["prevent"]),variant:"outline"},{default:a(()=>[s(w,{name:"download",class:"mr-1 h-4 w-4 md:mr-2"}),e[29]||(e[29]=o(" Download CSV "))]),_:1})):p("",!0)])])]),s(t(se),null,{default:a(()=>[s(t(ae),{class:"p-2 md:p-4 lg:p-6"},{default:a(()=>[n("div",ft,[n("div",vt,[s(t(g),{onClick:e[2]||(e[2]=l=>ne("yesterday")),variant:"outline",size:"sm",class:z({"border-primary bg-primary/10 text-primary":h.value==="yesterday"})},{default:a(()=>e[31]||(e[31]=[o(" Yesterday ")])),_:1},8,["class"]),s(t(g),{onClick:e[3]||(e[3]=l=>ne("current-week")),variant:"outline",size:"sm",class:z({"border-primary bg-primary/10 text-primary":h.value==="current-week"})},{default:a(()=>e[32]||(e[32]=[o(" WTD ")])),_:1},8,["class"]),s(t(g),{onClick:e[4]||(e[4]=l=>ne("6w")),variant:"outline",size:"sm",class:z({"border-primary bg-primary/10 text-primary":h.value==="6w"})},{default:a(()=>e[33]||(e[33]=[o(" T6W ")])),_:1},8,["class"]),s(t(g),{onClick:e[5]||(e[5]=l=>ne("quarterly")),variant:"outline",size:"sm",class:z({"border-primary bg-primary/10 text-primary":h.value==="quarterly"})},{default:a(()=>e[34]||(e[34]=[o(" Quarterly ")])),_:1},8,["class"])]),b.dateRange?(i(),c("div",xt,[h.value==="yesterday"&&b.dateRange.start?(i(),c("span",_t," Showing data from "+u(re(b.dateRange.start)),1)):b.dateRange.start&&b.dateRange.end?(i(),c("span",gt," Showing data from "+u(re(b.dateRange.start))+" to "+u(re(b.dateRange.end)),1)):(i(),c("span",yt,u(b.dateRange.label),1)),Ce.value?(i(),c("span",bt,"("+u(Ce.value)+")",1)):p("",!0)])):p("",!0)])]),_:1})]),_:1}),s(t(se),{class:"mx-auto max-w-[95vw] md:max-w-[64vw] lg:max-w-full overflow-x-auto"},{default:a(()=>[s(t(ae),{class:"p-0"},{default:a(()=>[n("div",wt,[s(t(_e),{class:"relative h-[600px] overflow-auto"},{default:a(()=>[s(t(ge),null,{default:a(()=>[s(t(L),{class:"sticky top-0 z-10 border-b bg-background hover:bg-background"},{default:a(()=>[C.value.includes("performance.delete")?(i(),x(t(M),{key:0,class:"w-[50px]"},{default:a(()=>[n("div",kt,[n("input",{type:"checkbox",onChange:qe,checked:je.value,class:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"},null,40,ht)])]),_:1})):p("",!0),b.SuperAdmin?(i(),x(t(M),{key:1},{default:a(()=>e[35]||(e[35]=[o("Company Name")])),_:1})):p("",!0),(i(),c(V,null,D(xe,l=>s(t(M),{key:l,class:"cursor-pointer",onClick:v=>Re(l)},{default:a(()=>[n("div",St,[n("span",{title:Ge(l)},u(Ye(l)),9,Ct),Z.value===l?(i(),c("div",Vt,[j.value==="asc"?(i(),c("svg",Dt,e[36]||(e[36]=[n("path",{d:"M8 15l4-4 4 4"},null,-1)]))):(i(),c("svg",Nt,e[37]||(e[37]=[n("path",{d:"M16 9l-4 4-4-4"},null,-1)])))])):(i(),c("div",$t,e[38]||(e[38]=[n("svg",{class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[n("path",{d:"M8 10l4-4 4 4"}),n("path",{d:"M16 14l-4 4-4-4"})],-1)])))])]),_:2},1032,["onClick"])),64)),C.value.includes("performance.update")||C.value.includes("performance.delete")?(i(),x(t(M),{key:2},{default:a(()=>e[39]||(e[39]=[o("Actions")])),_:1})):p("",!0)]),_:1})]),_:1}),s(t(ye),null,{default:a(()=>[B.value.length===0?(i(),x(t(L),{key:0},{default:a(()=>[s(t(y),{colspan:b.SuperAdmin?xe.length+3:xe.length+2,class:"py-8 text-center"},{default:a(()=>e[40]||(e[40]=[o(" No performance records found matching your criteria ")])),_:1},8,["colspan"])]),_:1})):p("",!0),(i(!0),c(V,null,D(B.value,l=>(i(),x(t(L),{key:l.id,class:"hover:bg-muted/50"},{default:a(()=>[C.value.includes("performance.delete")?(i(),x(t(y),{key:0,class:"text-center"},{default:a(()=>[oe(n("input",{type:"checkbox",value:l.id,"onUpdate:modelValue":e[6]||(e[6]=v=>S.value=v),class:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"},null,8,Pt),[[Pe,S.value]])]),_:2},1024)):p("",!0),b.SuperAdmin?(i(),x(t(y),{key:1,class:"min-w-[120px]"},{default:a(()=>{var v;return[o(u(((v=l.tenant)==null?void 0:v.name)??"—"),1)]}),_:2},1024)):p("",!0),s(t(y),{class:"min-w-[100px]"},{default:a(()=>[o(u(re(l.date)),1)]),_:2},1024),s(t(y),{class:"min-w-[120px]"},{default:a(()=>[n("div",null,u(ee(l.acceptance))+"%",1),n("div",Ft," ("+u(O(l.acceptance_rating))+") ",1)]),_:2},1024),s(t(y),{class:"min-w-[120px]"},{default:a(()=>[o(u(ee(l.on_time_to_origin))+"%",1)]),_:2},1024),s(t(y),{class:"min-w-[120px]"},{default:a(()=>[o(u(ee(l.on_time_to_destination))+"%",1)]),_:2},1024),s(t(y),{class:"min-w-[120px]"},{default:a(()=>[n("div",null,u(ee(l.on_time))+"%",1),n("div",Mt," ("+u(O(l.on_time_rating))+") ",1)]),_:2},1024),s(t(y),{class:"min-w-[140px]"},{default:a(()=>[n("div",null,u(ee(l.maintenance_variance_to_spend))+"%",1),n("div",Tt," ("+u(O(l.maintenance_variance_to_spend_rating))+") ",1)]),_:2},1024),s(t(y),{class:"min-w-[120px]"},{default:a(()=>[n("div",null,u(l.open_boc),1),n("div",At," ("+u(O(l.open_boc_rating))+") ",1)]),_:2},1024),s(t(y),{class:"min-w-[140px]"},{default:a(()=>[n("div",null,u(l.meets_safety_bonus_criteria?"Yes":"No"),1),n("div",Et," ("+u(O(l.meets_safety_bonus_criteria_rating))+") ",1)]),_:2},1024),s(t(y),{class:"min-w-[120px]"},{default:a(()=>[n("div",null,u(l.vcr_preventable),1),n("div",Rt," ("+u(O(l.vcr_preventable_rating))+") ",1)]),_:2},1024),s(t(y),{class:"min-w-[120px]"},{default:a(()=>[n("div",null,u(l.vmcr_p),1),n("div",Ut," ("+u(O(l.vmcr_p_rating))+") ",1)]),_:2},1024),C.value.includes("performance.update")||C.value.includes("performance.delete")?(i(),x(t(y),{key:2,class:"min-w-[120px]"},{default:a(()=>[n("div",It,[C.value.includes("performance.update")?(i(),x(t(g),{key:0,onClick:v=>Oe(l),variant:"warning",size:"sm"},{default:a(()=>[s(w,{name:"pencil",class:"mr-1 h-4 w-4"}),e[41]||(e[41]=o(" Edit "))]),_:2},1032,["onClick"])):p("",!0),C.value.includes("performance.delete")?(i(),x(t(g),{key:1,onClick:v=>Le(l.id),variant:"destructive",size:"sm"},{default:a(()=>[s(w,{name:"trash",class:"mr-1 h-4 w-4"}),e[42]||(e[42]=o(" Delete "))]),_:2},1032,["onClick"])):p("",!0)])]),_:2},1024)):p("",!0)]),_:2},1024))),128))]),_:1})]),_:1})]),b.performances.links?(i(),c("div",Bt,[n("div",Ot,[n("div",Lt,[n("span",null,"Showing "+u(B.value.length)+" of "+u(b.performances.data.length)+" entries",1),n("div",Wt,[e[43]||(e[43]=n("span",{class:"text-sm"},"Show:",-1)),oe(n("select",{"onUpdate:modelValue":e[7]||(e[7]=l=>G.value=l),onChange:Ke,class:"h-8 rounded-md border border-input bg-background px-2 py-1 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2"},[(i(),c(V,null,D([10,25,50,100],l=>n("option",{key:l,value:l},u(l),9,jt)),64))],544),[[Fe,G.value]])])]),n("div",qt,[(i(!0),c(V,null,D(b.performances.links,l=>(i(),x(t(g),{key:l.label,onClick:v=>Ae(l.url),disabled:!l.url,variant:"ghost",size:"sm",class:z(["mx-1",{"border-primary bg-primary/10 text-primary":l.active}])},{default:a(()=>[n("span",{innerHTML:l.label},null,8,zt)]),_:2},1032,["onClick","disabled","class"]))),128))])])])):p("",!0)]),_:1})]),_:1}),s(t(ie),{open:H.value,"onUpdate:open":e[18]||(e[18]=l=>H.value=l)},{default:a(()=>[s(t(ue),{class:"max-w-[95vw] sm:max-w-[90vw] md:max-w-4xl"},{default:a(()=>[s(t(me),{class:"px-4 sm:px-6"},{default:a(()=>[s(t(ce),{class:"text-lg sm:text-xl"},{default:a(()=>[o(u(fe.value),1)]),_:1}),s(t(de),{class:"text-xs sm:text-sm"},{default:a(()=>[o(" Fill in the details to "+u(Y.value.toLowerCase())+" a performance record. ",1)]),_:1})]),_:1}),n("form",{onSubmit:q(Ue,["prevent"]),class:"grid max-h-[75vh] grid-cols-1 gap-2 overflow-y-auto p-4 sm:grid-cols-2 sm:gap-3 sm:p-6"},[b.SuperAdmin?(i(),c("div",Ht,[s(t($),{for:"tenant",class:"text-xs sm:text-sm"},{default:a(()=>e[44]||(e[44]=[o("Company Name")])),_:1}),n("div",Yt,[oe(n("select",{id:"tenant","onUpdate:modelValue":e[8]||(e[8]=l=>t(m).tenant_id=l),required:"",class:"flex h-9 w-full appearance-none items-center rounded-md border border-input bg-background px-3 py-1 text-xs ring-offset-background focus:outline-none focus:ring-1 focus:ring-ring focus:ring-offset-1 disabled:cursor-not-allowed disabled:opacity-50 sm:h-10 sm:text-sm"},[e[45]||(e[45]=n("option",{disabled:"",value:""},"Select a Company",-1)),(i(!0),c(V,null,D(b.tenants,l=>(i(),c("option",{key:l.id,value:l.id},u(l.name),9,Gt))),128))],512),[[Fe,t(m).tenant_id]]),e[46]||(e[46]=n("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-2 text-gray-700"},[n("svg",{class:"h-3 w-3 opacity-50 sm:h-4 sm:w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[n("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})])],-1))])])):p("",!0),n("div",Kt,[s(t($),{for:"date",class:"text-xs sm:text-sm"},{default:a(()=>e[47]||(e[47]=[o("Date")])),_:1}),s(t(E),{id:"date",modelValue:t(m).date,"onUpdate:modelValue":e[9]||(e[9]=l=>t(m).date=l),type:"date",required:"",class:"h-9 px-3 py-1 text-xs sm:h-10 sm:text-sm"},null,8,["modelValue"])]),n("div",Qt,[s(t($),{for:"acceptance",class:"text-xs sm:text-sm"},{default:a(()=>e[48]||(e[48]=[o("Acceptance")])),_:1}),s(t(E),{id:"acceptance",modelValue:t(m).acceptance,"onUpdate:modelValue":e[10]||(e[10]=l=>t(m).acceptance=l),type:"number",step:"0.01",required:"",class:"h-9 px-3 py-1 text-xs sm:h-10 sm:text-sm"},null,8,["modelValue"])]),n("div",Xt,[s(t($),{for:"on_time_to_origin",class:"text-xs sm:text-sm"},{default:a(()=>e[49]||(e[49]=[o("On Time to Origin")])),_:1}),s(t(E),{id:"on_time_to_origin",modelValue:t(m).on_time_to_origin,"onUpdate:modelValue":e[11]||(e[11]=l=>t(m).on_time_to_origin=l),type:"number",step:"0.01",required:"",class:"h-9 px-3 py-1 text-xs sm:h-10 sm:text-sm"},null,8,["modelValue"])]),n("div",Jt,[s(t($),{for:"on_time_to_destination",class:"text-xs sm:text-sm"},{default:a(()=>e[50]||(e[50]=[o("On Time to Destination")])),_:1}),s(t(E),{id:"on_time_to_destination",modelValue:t(m).on_time_to_destination,"onUpdate:modelValue":e[12]||(e[12]=l=>t(m).on_time_to_destination=l),type:"number",step:"0.01",required:"",class:"h-9 px-3 py-1 text-xs sm:h-10 sm:text-sm"},null,8,["modelValue"])]),n("div",Zt,[s(t($),{for:"maintenance_variance_to_spend",class:"text-xs sm:text-sm"},{default:a(()=>e[51]||(e[51]=[o("Maintenance Variance to Spend")])),_:1}),s(t(E),{id:"maintenance_variance_to_spend",modelValue:t(m).maintenance_variance_to_spend,"onUpdate:modelValue":e[13]||(e[13]=l=>t(m).maintenance_variance_to_spend=l),type:"number",step:"0.001",required:"",class:"h-9 px-3 py-1 text-xs sm:h-10 sm:text-sm"},null,8,["modelValue"])]),n("div",es,[s(t($),{for:"open_boc",class:"text-xs sm:text-sm"},{default:a(()=>e[52]||(e[52]=[o("Open BOC")])),_:1}),s(t(E),{id:"open_boc",modelValue:t(m).open_boc,"onUpdate:modelValue":e[14]||(e[14]=l=>t(m).open_boc=l),type:"number",step:"1",required:"",class:"h-9 px-3 py-1 text-xs sm:h-10 sm:text-sm"},null,8,["modelValue"])]),n("div",ts,[s(t($),{for:"vcr_preventable",class:"text-xs sm:text-sm"},{default:a(()=>e[53]||(e[53]=[o("VCR Preventable")])),_:1}),s(t(E),{id:"vcr_preventable",modelValue:t(m).vcr_preventable,"onUpdate:modelValue":e[15]||(e[15]=l=>t(m).vcr_preventable=l),type:"number",step:"1",required:"",class:"h-9 px-3 py-1 text-xs sm:h-10 sm:text-sm"},null,8,["modelValue"])]),n("div",ss,[s(t($),{for:"vmcr_p",class:"text-xs sm:text-sm"},{default:a(()=>e[54]||(e[54]=[o("VMCR P")])),_:1}),s(t(E),{id:"vmcr_p",modelValue:t(m).vmcr_p,"onUpdate:modelValue":e[16]||(e[16]=l=>t(m).vmcr_p=l),type:"number",step:"1",required:"",class:"h-9 px-3 py-1 text-xs sm:h-10 sm:text-sm"},null,8,["modelValue"])]),n("div",as,[oe(n("input",{id:"meets_safety_bonus_criteria","onUpdate:modelValue":e[17]||(e[17]=l=>t(m).meets_safety_bonus_criteria=l),type:"checkbox",class:"h-3.5 w-3.5 rounded border-gray-300 text-primary focus:ring-1 focus:ring-primary sm:h-4 sm:w-4"},null,512),[[Pe,t(m).meets_safety_bonus_criteria]]),s(t($),{for:"meets_safety_bonus_criteria",class:"text-xs sm:text-sm"},{default:a(()=>e[55]||(e[55]=[o(" Meets Safety Bonus Criteria ")])),_:1})]),s(t(be),{class:"col-span-2 mt-3 flex flex-col gap-2 sm:flex-row sm:gap-3"},{default:a(()=>[s(t(g),{type:"button",onClick:Ve,variant:"outline",class:"h-9 px-4 py-1 text-xs sm:h-10 sm:text-sm"},{default:a(()=>e[56]||(e[56]=[o(" Cancel ")])),_:1}),s(t(g),{type:"submit",variant:"default",class:"h-9 px-4 py-1 text-xs sm:h-10 sm:text-sm"},{default:a(()=>[o(u(Y.value),1)]),_:1})]),_:1})],32)]),_:1})]),_:1},8,["open"]),s(t(ie),{open:Q.value,"onUpdate:open":e[20]||(e[20]=l=>Q.value=l)},{default:a(()=>[s(t(ue),{class:"max-w-[95vw] sm:max-w-md"},{default:a(()=>[s(t(me),{class:"px-4 sm:px-6"},{default:a(()=>[s(t(ce),{class:"text-lg sm:text-xl"},{default:a(()=>e[57]||(e[57]=[o("Confirm Deletion")])),_:1}),s(t(de),{class:"text-xs sm:text-sm"},{default:a(()=>e[58]||(e[58]=[o(" Are you sure you want to delete this performance record? This action cannot be undone. ")])),_:1})]),_:1}),s(t(be),{class:"px-4 sm:px-6"},{default:a(()=>[s(t(g),{type:"button",onClick:e[19]||(e[19]=l=>Q.value=!1),variant:"outline",class:"h-9 px-4 py-1 text-xs sm:h-10 sm:text-sm"},{default:a(()=>e[59]||(e[59]=[o(" Cancel ")])),_:1}),s(t(g),{type:"button",onClick:We,variant:"destructive",class:"h-9 px-4 py-1 text-xs sm:h-10 sm:text-sm"},{default:a(()=>e[60]||(e[60]=[o(" Delete ")])),_:1})]),_:1})]),_:1})]),_:1},8,["open"]),s(t(ie),{open:K.value,"onUpdate:open":e[23]||(e[23]=l=>K.value=l)},{default:a(()=>[s(t(ue),{class:"max-w-[95vw] sm:max-w-md"},{default:a(()=>[s(t(me),{class:"px-4 sm:px-6"},{default:a(()=>[s(t(ce),{class:"text-lg sm:text-xl"},{default:a(()=>e[61]||(e[61]=[o("Confirm Bulk Deletion")])),_:1}),s(t(de),{class:"text-xs sm:text-sm"},{default:a(()=>[o(" Are you sure you want to delete "+u(S.value.length)+" performance records? This action cannot be undone. ",1)]),_:1})]),_:1}),s(t(be),{class:"px-4 sm:px-6"},{default:a(()=>[s(t(g),{type:"button",onClick:e[21]||(e[21]=l=>K.value=!1),variant:"outline",class:"h-9 px-4 py-1 text-xs sm:h-10 sm:text-sm"},{default:a(()=>e[62]||(e[62]=[o(" Cancel ")])),_:1}),s(t(g),{type:"button",onClick:e[22]||(e[22]=l=>He()),variant:"destructive",class:"h-9 px-4 py-1 text-xs sm:h-10 sm:text-sm"},{default:a(()=>e[63]||(e[63]=[o(" Delete Selected ")])),_:1})]),_:1})]),_:1})]),_:1},8,["open"]),s(t(ie),{open:J.value,"onUpdate:open":e[24]||(e[24]=l=>J.value=l)},{default:a(()=>[s(t(ue),{class:"max-w-[95vw] sm:max-w-[90vw] md:max-w-5xl max-h-[90vh] overflow-hidden flex flex-col"},{default:a(()=>{var l,v,N;return[s(t(me),{class:"px-4 sm:px-6 border-b pb-3"},{default:a(()=>[n("div",ls,[s(w,{name:"upload",class:"h-5 w-5 text-primary"}),s(t(ce),{class:"text-lg sm:text-xl font-semibold"},{default:a(()=>e[64]||(e[64]=[o(" Import Performances ")])),_:1})]),s(t(de),{class:"text-xs sm:text-sm mt-1 text-muted-foreground"},{default:a(()=>e[65]||(e[65]=[o(" Upload a CSV file to import performances. The file will be validated before import. ")])),_:1})]),_:1}),n("div",ns,[f.value?(i(),c("div",fs,[(l=f.value.headers)!=null&&l.length?(i(),c("div",vs,[n("div",xs,[e[70]||(e[70]=n("div",{class:"text-sm font-semibold"},"CSV Headers",-1)),n("div",_s,u(f.value.headers.length)+" columns ",1)]),n("div",gs,[(i(!0),c(V,null,D(f.value.headers,k=>(i(),c("span",{key:k,class:"rounded-full bg-muted px-2 py-0.5 text-xs"},u(k),1))),128))])])):p("",!0),n("div",ys,[s(t(se),{class:"border-2"},{default:a(()=>[s(t(ae),{class:"p-4 text-center"},{default:a(()=>[n("div",bs,u(f.value.summary.total),1),e[71]||(e[71]=n("div",{class:"text-sm text-muted-foreground"},"Total Rows",-1))]),_:1})]),_:1}),s(t(se),{class:"border-2 border-green-500/50 bg-green-50 dark:bg-green-900/10"},{default:a(()=>[s(t(ae),{class:"p-4 text-center"},{default:a(()=>[n("div",ws,u(f.value.summary.valid),1),e[72]||(e[72]=n("div",{class:"text-sm text-muted-foreground"},"Valid",-1))]),_:1})]),_:1}),s(t(se),{class:"border-2 border-red-500/50 bg-red-50 dark:bg-red-900/10"},{default:a(()=>[s(t(ae),{class:"p-4 text-center"},{default:a(()=>[n("div",ks,u(f.value.summary.invalid),1),e[73]||(e[73]=n("div",{class:"text-sm text-muted-foreground"},"Invalid",-1))]),_:1})]),_:1})]),f.value.header_error?(i(),x(t(we),{key:1,variant:"destructive"},{default:a(()=>[s(t(ke),{class:"flex items-center gap-2"},{default:a(()=>[s(w,{name:"alert_circle",class:"h-5 w-5"}),e[74]||(e[74]=o(" Header Error "))]),_:1}),s(t(he),null,{default:a(()=>[o(u(f.value.header_error),1)]),_:1})]),_:1})):p("",!0),(v=f.value.invalid)!=null&&v.length?(i(),c("div",hs,[n("div",Ss,[n("h3",Cs,[s(w,{name:"alert-triangle",class:"h-5 w-5"}),o(" Validation Errors ("+u(f.value.invalid.length)+") ",1)]),s(t(g),{onClick:at,variant:"outline",size:"sm",class:"flex items-center gap-2"},{default:a(()=>[s(w,{name:"download",class:"h-4 w-4"}),e[75]||(e[75]=o(" Download Error Report "))]),_:1})]),n("div",Vs,[n("div",Ds,[s(t(_e),null,{default:a(()=>[s(t(ge),{class:"sticky top-0 bg-background"},{default:a(()=>[s(t(L),null,{default:a(()=>[s(t(M),{class:"w-20"},{default:a(()=>e[76]||(e[76]=[o("Row #")])),_:1}),s(t(M),null,{default:a(()=>e[77]||(e[77]=[o("Preview")])),_:1}),s(t(M),null,{default:a(()=>e[78]||(e[78]=[o("Errors")])),_:1})]),_:1})]),_:1}),s(t(ye),null,{default:a(()=>[(i(!0),c(V,null,D(f.value.invalid,k=>(i(),x(t(L),{key:k.rowNumber,class:"hover:bg-muted/50"},{default:a(()=>[s(t(y),{class:"font-medium"},{default:a(()=>[o(u(k.rowNumber),1)]),_:2},1024),s(t(y),{class:"text-sm text-muted-foreground"},{default:a(()=>{var A;return[n("div",Ns,[(i(!0),c(V,null,D(k.preview||[],F=>(i(),c("span",{key:F.key,class:"whitespace-nowrap"},[n("span",$s,u(F.label)+": ",1),o(" "+u(F.value),1)]))),128)),(A=k.preview)!=null&&A.length?p("",!0):(i(),c("span",Ps," — "))])]}),_:2},1024),s(t(y),null,{default:a(()=>{var A;return[n("div",Fs,[(i(!0),c(V,null,D(k.errors||[],(F,lt)=>(i(),c("div",{key:lt,class:"text-xs text-red-600 flex items-start gap-1"},[s(w,{name:"x-circle",class:"h-3 w-3 mt-0.5 flex-shrink-0"}),n("span",null,u(F),1)]))),128)),(A=k.errors)!=null&&A.length?p("",!0):(i(),c("div",Ms," — "))])]}),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])])])):p("",!0),(N=f.value.valid)!=null&&N.length?(i(),c("div",Ts,[n("h3",As,[s(w,{name:"check-circle",class:"h-5 w-5"}),o(" Valid Rows ("+u(f.value.valid.length)+") ",1)]),e[81]||(e[81]=n("div",{class:"text-sm text-muted-foreground mb-2"}," Showing first 5 valid rows ",-1)),n("div",Es,[s(t(_e),null,{default:a(()=>[s(t(ge),null,{default:a(()=>[s(t(L),null,{default:a(()=>[s(t(M),null,{default:a(()=>e[79]||(e[79]=[o("Row #")])),_:1}),s(t(M),null,{default:a(()=>e[80]||(e[80]=[o("Preview")])),_:1})]),_:1})]),_:1}),s(t(ye),null,{default:a(()=>[(i(!0),c(V,null,D(f.value.valid.slice(0,5),k=>(i(),x(t(L),{key:k.rowNumber},{default:a(()=>[s(t(y),{class:"font-medium"},{default:a(()=>[o(u(k.rowNumber),1)]),_:2},1024),s(t(y),{class:"text-sm"},{default:a(()=>{var A;return[n("div",Rs,[(i(!0),c(V,null,D(k.preview||[],F=>(i(),c("span",{key:F.key,class:"whitespace-nowrap"},[n("span",Us,u(F.label)+":",1),o(" "+u(F.value),1)]))),128)),(A=k.preview)!=null&&A.length?p("",!0):(i(),c("span",Is," — "))])]}),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])])):p("",!0)])):(i(),c("div",rs,[n("div",os,[n("div",{class:z(["flex flex-col items-center justify-center border-2 border-dashed rounded-lg p-8 bg-muted/20 transition-colors",{"border-primary bg-primary/5":R.value,"opacity-60 pointer-events-none":U.value}]),onDragenter:q(Je,["prevent"]),onDragover:q(Ze,["prevent"]),onDragleave:q(et,["prevent"]),onDrop:q(tt,["prevent"])},[s(w,{name:"file-spreadsheet",class:"h-12 w-12 text-muted-foreground mb-3"}),e[67]||(e[67]=n("div",{class:"text-center"},[n("div",{class:"text-sm font-medium"},[n("span",{class:"text-primary"},"Drag & drop"),o(" your CSV here ")]),n("p",{class:"text-xs text-muted-foreground mt-1"},"or")],-1)),n("label",is,[e[66]||(e[66]=n("span",{class:"text-sm font-medium text-primary hover:underline"}," Choose CSV file ",-1)),n("input",{ref_key:"importFileInput",ref:pe,type:"file",class:"hidden",onChange:Xe,accept:".csv,text/csv",disabled:U.value},null,40,us)]),e[68]||(e[68]=n("p",{class:"text-xs text-muted-foreground mt-2"},"CSV only",-1)),R.value?(i(),c("div",ds," Drop file to validate ")):p("",!0)],34),n("div",ms,[s(w,{name:"info",class:"h-4 w-4"}),n("a",{href:Qe.value,download:"",class:"text-primary hover:underline"}," Download CSV Template ",8,cs)]),U.value?(i(),c("div",ps,e[69]||(e[69]=[n("div",{class:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary"},null,-1),n("span",{class:"text-sm text-muted-foreground"},"Validating CSV file...",-1)]))):p("",!0)])]))]),n("div",Bs,[s(t(g),{onClick:Ne,variant:"outline",disabled:I.value},{default:a(()=>e[82]||(e[82]=[o(" Close ")])),_:1},8,["disabled"]),f.value&&f.value.summary.valid>0?(i(),x(t(g),{key:0,onClick:st,variant:"default",disabled:I.value||f.value.summary.invalid>0||!!f.value.header_error,class:"flex items-center gap-2"},{default:a(()=>[I.value?(i(),c("div",Os)):(i(),x(w,{key:1,name:"check",class:"h-4 w-4"})),o(" "+u(I.value?"Importing...":`Import ${f.value.summary.valid} Rows`),1)]),_:1},8,["disabled"])):p("",!0)])]}),_:1})]),_:1},8,["open"]),n("form",{ref_key:"exportForm",ref:ve,method:"GET",class:"hidden"},null,512)])]),_:1},8,["tenantSlug","permissions"]))}};export{ua as default};
