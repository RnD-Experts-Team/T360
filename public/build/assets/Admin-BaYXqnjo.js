import{r as E,c as j,b,e as i,f as t,l,X as u,u as e,L as f,k as L,S as n,M as _,N as p,U as d,D as Y,Y as H}from"./vendor-cgn9wV4E.js";import{_ as J}from"./AppLayout.vue_vue_type_script_setup_true_lang-DnFOFWBn.js";import{_ as K}from"./Form.vue_vue_type_script_setup_true_lang-BxeL3MIn.js";import{g as Q}from"./vendor-vue-C6le94gM.js";import{_ as z,a as O,b as $,c as v,d as F,e as g}from"./TableRow.vue_vue_type_script_setup_true_lang-58J5Q7id.js";import{_ as W}from"./Button.vue_vue_type_script_setup_true_lang-DA-5a5tM.js";import{_ as k}from"./Card.vue_vue_type_script_setup_true_lang-DQTQMX6v.js";import{_ as w}from"./CardHeader.vue_vue_type_script_setup_true_lang-n-Rvhb9V.js";import{_ as S}from"./CardTitle.vue_vue_type_script_setup_true_lang-AShXP1uR.js";import{_ as T}from"./CardContent.vue_vue_type_script_setup_true_lang-DNXZ8J1r.js";import{_ as Z}from"./Badge.vue_vue_type_script_setup_true_lang-BpieHD20.js";import"./utils-C4uCeQPu.js";import"./vendor-ui-BuPyOEYe.js";import"./Icon.vue_vue_type_script_setup_true_lang-g5QrAIpa.js";import"./vendor-icons-Bu7C1ObZ.js";import"./useInitials-DzeGKvtI.js";import"./app-DdEjr71t.js";import"./vendor-axios-C0Zqfgkc.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BM02NuXb.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Input.vue_vue_type_script_setup_true_lang-1zH_gJ02.js";import"./Label.vue_vue_type_script_setup_true_lang-WOFpmVDV.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-ChpZyGGS.js";const ee={class:"w-full md:max-w-2xl lg:max-w-3xl xl:max-w-6xl lg:mx-auto m-0 p-2 md:p-4 lg:p-6 space-y-2 md:space-y-4 lg:space-y-6"},te={class:"flex flex-col sm:flex-row justify-between items-center mb-6"},le={key:0},ae={key:1,class:"grid grid-cols-1 md:grid-cols-3 gap-6"},se={class:"overflow-x-auto"},re={class:"overflow-x-auto"},ne=["value"],oe={class:"flex flex-col space-y-2"},ie={class:"flex items-center justify-between"},ue={class:"text-muted-foreground"},de={class:"flex flex-wrap gap-2"},De={__name:"Admin",props:{metrics:Object,permissions:{type:Array,default:()=>[]},TenantMetricsRules:{type:Array,default:()=>[]},tenants:{type:Array,default:()=>[]}},setup(m){var B,N;const o=m,{tenantSlug:y}=o,U=[{title:y?"Dashboard":"Admin Dashboard",href:y?route("dashboard",{tenantSlug:y}):route("admin.dashboard")},{title:"Metrics",href:route("performance-metrics.edit")}],V=E(!1),h=E({}),A=["acceptance","on_time","maintenance_variance","open_boc","vcr_preventable","vmcr_p"],G=["fantastic_plus","fantastic","good","fair","poor"],q=["driver_distraction","speeding_violation","sign_violation","traffic_light_violation","following_distance","roadside_parking"],I=["gold","silver","not_eligible"],D={less:"Less than",less_or_equal:"Less than or equal to",equal:"Equal to",more_or_equal:"More than or equal to",more:"More than"},x=j(()=>{if(!o.metrics)return{};const c={};return A.forEach(a=>{c[a]=G.map(s=>{const r=o.metrics[`${a}_${s}_operator`]??"-";return{level:s.replace(/_/g," "),value:o.metrics[`${a}_${s}`]??"-",operator:D[r]||r}})}),q.forEach(a=>{c[a]=I.map(s=>{const r=o.metrics[`${a}_${s}_operator`]??"-";return{level:s.replace(/_/g," "),value:o.metrics[`${a}_${s}`]??"-",operator:D[r]||r}})}),c.safety_bonus_eligible_levels=o.metrics.safety_bonus_eligible_levels||[],c});function P(){h.value=o.metrics??{},V.value=!0}function R(){V.value=!1,h.value={}}const M=E(((N=(B=o.tenants)==null?void 0:B[0])==null?void 0:N.id)||null),X=j(()=>!Array.isArray(o.TenantMetricsRules)||!M.value?o.metrics||{}:o.TenantMetricsRules.find(c=>c.tenant_id===M.value)||o.metrics||{});return(c,a)=>(i(),b(J,{breadcrumbs:U,tenantSlug:e(y),permissions:o.permissions},{default:t(()=>[l(e(Q),{title:"Metrics Management"}),u("div",ee,[u("div",te,[a[2]||(a[2]=u("h1",{class:"text-2xl font-bold text-foreground"}," Performance Metrics ",-1)),l(e(W),{onClick:P,variant:"default",class:"mt-4 sm:mt-0"},{default:t(()=>a[1]||(a[1]=[n(" Edit Global Metrics ")])),_:1})]),V.value?(i(),f("div",le,[l(K,{entry:h.value,tenants:m.tenants,metrics:m.metrics,TenantMetricsRules:m.TenantMetricsRules,onSaved:R,onCancel:R},null,8,["entry","tenants","metrics","TenantMetricsRules"])])):o.metrics?(i(),f("div",ae,[(i(),f(_,null,p(A,s=>l(e(k),{key:s},{default:t(()=>[l(e(w),null,{default:t(()=>[l(e(S),{class:"capitalize"},{default:t(()=>[n(d(s.replace(/_/g," ")),1)]),_:2},1024)]),_:2},1024),l(e(T),null,{default:t(()=>[u("div",se,[l(e(z),null,{default:t(()=>[l(e(O),null,{default:t(()=>[l(e($),null,{default:t(()=>[l(e(v),null,{default:t(()=>a[3]||(a[3]=[n("Level")])),_:1}),l(e(v),null,{default:t(()=>a[4]||(a[4]=[n("Value")])),_:1}),l(e(v),null,{default:t(()=>a[5]||(a[5]=[n("Operator")])),_:1})]),_:1})]),_:1}),l(e(F),null,{default:t(()=>[(i(!0),f(_,null,p(x.value[s],(r,C)=>(i(),b(e($),{key:C},{default:t(()=>[l(e(g),null,{default:t(()=>[n(d(r.level),1)]),_:2},1024),l(e(g),null,{default:t(()=>[n(d(r.value),1)]),_:2},1024),l(e(g),null,{default:t(()=>[n(d(r.operator),1)]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)])]),_:2},1024)]),_:2},1024)),64)),(i(),f(_,null,p(q,s=>l(e(k),{key:s},{default:t(()=>[l(e(w),null,{default:t(()=>[l(e(S),{class:"capitalize"},{default:t(()=>[n(d(s.replace(/_/g," ")),1)]),_:2},1024)]),_:2},1024),l(e(T),null,{default:t(()=>[u("div",re,[l(e(z),null,{default:t(()=>[l(e(O),null,{default:t(()=>[l(e($),null,{default:t(()=>[l(e(v),null,{default:t(()=>a[6]||(a[6]=[n("Tier")])),_:1}),l(e(v),null,{default:t(()=>a[7]||(a[7]=[n("Value")])),_:1}),l(e(v),null,{default:t(()=>a[8]||(a[8]=[n("Operator")])),_:1})]),_:1})]),_:1}),l(e(F),null,{default:t(()=>[(i(!0),f(_,null,p(x.value[s],(r,C)=>(i(),b(e($),{key:C},{default:t(()=>[l(e(g),null,{default:t(()=>[n(d(r.level),1)]),_:2},1024),l(e(g),null,{default:t(()=>[n(d(r.value),1)]),_:2},1024),l(e(g),null,{default:t(()=>[n(d(r.operator),1)]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)])]),_:2},1024)]),_:2},1024)),64)),l(e(k),{class:"col-span-1 md:col-span-2"},{default:t(()=>[l(e(w),{class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},{default:t(()=>{var s;return[l(e(S),null,{default:t(()=>a[9]||(a[9]=[n("MVtS Configuration")])),_:1}),(s=m.tenants)!=null&&s.length?Y((i(),f("select",{key:0,"onUpdate:modelValue":a[0]||(a[0]=r=>M.value=r),class:"p-2 rounded-md border border-input bg-background text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 dark:border-gray-700 dark:bg-gray-800 dark:text-white max-w-[200px]"},[(i(!0),f(_,null,p(m.tenants,r=>(i(),f("option",{key:r.id,value:r.id},d(r.name),9,ne))),128))],512)),[[H,M.value]]):L("",!0)]}),_:1}),l(e(T),null,{default:t(()=>{var s;return[u("div",oe,[u("div",ie,[a[10]||(a[10]=u("span",{class:"font-medium text-foreground"},"MVtS Divisor:",-1)),u("span",ue,d(((s=X.value)==null?void 0:s.mvts_divisor)||"0.135"),1)]),a[11]||(a[11]=u("p",{class:"text-sm text-muted-foreground"}," This value is used to calculate the Maintenance Variance to Standard (MVtS) metric. ",-1))])]}),_:1})]),_:1}),x.value.safety_bonus_eligible_levels.length?(i(),b(e(k),{key:0,class:"col-span-1 md:col-span-2"},{default:t(()=>[l(e(w),null,{default:t(()=>[l(e(S),null,{default:t(()=>a[12]||(a[12]=[n(" Safety Bonus Eligibility ")])),_:1})]),_:1}),l(e(T),null,{default:t(()=>[u("div",de,[(i(!0),f(_,null,p(x.value.safety_bonus_eligible_levels,(s,r)=>(i(),b(e(Z),{key:r,variant:"success",class:"capitalize"},{default:t(()=>[n(d(s.replace(/_/g," ")),1)]),_:2},1024))),128))])]),_:1})]),_:1})):L("",!0)])):L("",!0)])]),_:1},8,["tenantSlug","permissions"]))}};export{De as default};
