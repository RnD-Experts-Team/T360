import{c as A,L as f,e as u,X as l,U as g,b2 as X,M,S as m,N as q,a1 as vt,r as N,A as Je,w as ce,bW as bt,b as V,l as r,k as _,f as n,u as a,d as Te,D as J,Y as te,bH as gt,P as be,h as z,K as _t,bF as xt}from"./vendor-cgn9wV4E.js";import{a as yt,W as Me,x as Ie,g as kt}from"./vendor-vue-C6le94gM.js";import{_ as wt}from"./Badge.vue_vue_type_script_setup_true_lang-BpieHD20.js";import{_ as W}from"./Icon.vue_vue_type_script_setup_true_lang-g5QrAIpa.js";import{_ as L}from"./Button.vue_vue_type_script_setup_true_lang-DA-5a5tM.js";import{b as Ve,_ as Re,a as Ae}from"./AlertDescription.vue_vue_type_script_setup_true_lang-BdYx0SaG.js";import{_ as ge}from"./Card.vue_vue_type_script_setup_true_lang-DQTQMX6v.js";import{_ as _e}from"./CardContent.vue_vue_type_script_setup_true_lang-DNXZ8J1r.js";import{_ as Le,a as Ue,b as de,c as oe,d as Ee,e as re}from"./TableRow.vue_vue_type_script_setup_true_lang-58J5Q7id.js";import{b as Se,a as he,_ as Ce}from"./DialogDescription.vue_vue_type_script_setup_true_lang-BDOQqQHy.js";import{_ as $e,a as De}from"./DialogTitle.vue_vue_type_script_setup_true_lang-K_t0Wv0O.js";import{_ as Pe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as H}from"./Input.vue_vue_type_script_setup_true_lang-1zH_gJ02.js";import{_ as B}from"./Label.vue_vue_type_script_setup_true_lang-WOFpmVDV.js";import{_ as jt}from"./CardHeader.vue_vue_type_script_setup_true_lang-n-Rvhb9V.js";import{_ as St}from"./CardTitle.vue_vue_type_script_setup_true_lang-AShXP1uR.js";import{_ as Ze}from"./DialogFooter.vue_vue_type_script_setup_true_lang-C4cZ_wVx.js";import{_ as ht}from"./AppLayout.vue_vue_type_script_setup_true_lang-Bx6WXffK.js";import"./vendor-axios-C0Zqfgkc.js";import"./utils-C4uCeQPu.js";import"./vendor-icons-Bu7C1ObZ.js";import"./vendor-ui-BuPyOEYe.js";import"./useInitials-DzeGKvtI.js";import"./app-BwOLsRrX.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BM02NuXb.js";const Ct={class:"bg-background rounded-lg border shadow-sm p-2 md:p-4 flex flex-col items-center justify-center"},$t={class:"text-sm font-semibold mb-2 text-foreground"},Dt={__name:"TotalLateStops",props:{title:{type:String,required:!0},value:{type:[Number,String],required:!0}},setup(S){const i=S,h=A(()=>i.value===null||i.value===void 0||i.value===""?"No Data":i.value),R=A(()=>{const I=Number(i.value);return i.title.toLowerCase().includes("total")&&I>0});return(I,U)=>(u(),f("div",Ct,[l("h3",$t,g(S.title),1),l("p",{class:X(["text-2xl font-bold",R.value?"text-red-600":"text-primary"])},g(h.value),3)]))}},Vt={class:"bg-background rounded-lg border shadow-sm p-2 md:p-4"},Rt={class:"text-base text-center font-semibold mb-4"},At={key:0,class:"text-center text-sm py-4 text-primary font-medium"},Tt={class:"space-y-3"},Bt={class:"text-sm"},Ft={__name:"BottomDrivers",props:{title:{type:String,default:"Bottom 5 Drivers"},drivers:{type:Array,default:()=>[]},totalRejections:{type:Number,default:0},rejectionType:{type:String,default:""}},setup(S){const i=S;A(()=>i.rejectionType==="load"?"No load rejections recorded. You're on track for Fantastic+ !":i.rejectionType==="block"?"No block rejections recorded. You're on track for Fantastic+ !":"No rejections recorded. You're on track for Fantastic+ !");const h=R=>{const I=["#ef4444","#f97316","#f59e0b","#84cc16","#10b981"],w=[...i.drivers].sort((C,D)=>D.total_penalty-C.total_penalty).map(C=>C.total_penalty).indexOf(R);return I[w]||"#6b7280"};return(R,I)=>(u(),f("div",Vt,[l("h3",Rt,g(S.title),1),S.drivers.length===0?(u(),f("div",At,[S.totalRejections===0?(u(),f(M,{key:0},[S.rejectionType==="block"?(u(),f(M,{key:0},[m(" No block rejections recorded. You're on track for Fantastic+ ! ")],64)):S.rejectionType==="load"?(u(),f(M,{key:1},[m(" No load rejections recorded. You're on track for Fantastic+ ! ")],64)):(u(),f(M,{key:2},[m(" No rejections recorded. You're on track for Fantastic+ ! ")],64))],64)):(u(),f(M,{key:1},[m(" No delays recorded. You're on track for Fantastic+ ! ")],64))])):(u(),f(M,{key:1},[I[0]||(I[0]=l("div",{class:"flex justify-between items-center mb-2"},[l("span",{class:"text-base mb-2 font-medium"},"Driver Name"),l("span",{class:"text-base mb-2 font-medium"},"Total Penalty")],-1)),l("div",Tt,[(u(!0),f(M,null,q(S.drivers,(U,w)=>(u(),f("div",{key:w,class:"flex justify-between items-center"},[l("span",Bt,g(U.driver_name),1),l("span",{class:"text-sm font-medium",style:vt({color:h(U.total_penalty)})},g(U.total_penalty),5)]))),128))])],64))]))}},Nt={class:"bg-background rounded-lg border shadow-sm p-2 md:p-4"},Mt={class:"text-base text-center font-semibold mb-4"},It={class:"h-64"},Lt={__name:"LineChart",props:{title:{type:String,default:"Acceptance Score"},chartData:{type:Object,default:()=>({labels:[],datasets:[]})},averageAcceptance:{type:Number,default:null}},setup(S){const i=S,h=N(null);let R=null;const I=()=>{if(R&&R.destroy(),!h.value)return;const U=h.value.getContext("2d"),w=[];i.chartData.datasets.forEach($=>{$.data&&$.data.length&&w.push(...$.data)});const C=w.length>0?Math.min(...w):0,D=w.length>0?Math.max(...w):100;R=new bt(U,{type:"line",data:i.chartData,options:{responsive:!0,maintainAspectRatio:!1,layout:{padding:{left:15,right:15,top:10,bottom:10}},plugins:{legend:{position:!1},tooltip:{callbacks:{label:function($){const s=$.raw||0,E=i.averageAcceptance||0,d=i.chartData.dateRangeLabel||"selected period",o=Number(E).toFixed(2);return[`Acceptance Score: ${s}`,`Average Score Over ${d}: ${o}`]}}}},scales:{y:{beginAtZero:!(C>10),min:Math.max(Math.floor(C-5),0),max:Math.min(102.5,Math.ceil(D+5)),ticks:{stepSize:2.5,padding:10,font:{size:11},callback:function($){return $<=100?$:""}},grid:{drawBorder:!0,color:"rgba(200, 200, 200, 0.2)"}},x:{ticks:{padding:10,font:{size:11}},grid:{drawBorder:!0,color:"rgba(200, 200, 200, 0.2)"}}}}})};return Je(()=>{I()}),ce(()=>i.chartData,()=>{I()},{deep:!0}),(U,w)=>(u(),f("div",Nt,[l("h3",Mt,g(S.title),1),l("div",It,[l("canvas",{ref_key:"chartCanvas",ref:h},null,512)])]))}},Ut={class:"space-y-2 md:space-y-4 lg:space-y-6 mb-2 md:mb-4 lg:mb-6"},Et={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-2 md:gap-4"},Pt={class:"grid grid-cols-1 lg:grid-cols-4 gap-2 md:gap-4 lg:gap-6"},Ot={key:1,class:"bg-background rounded-lg border shadow-sm p-4 md:p-6 lg:col-span-3 md:col-span-2 transition-all duration-300 hover:shadow-md flex flex-col justify-center"},Wt={class:"flex flex-col sm:flex-row items-center justify-center sm:justify-around gap-3 mb-4"},Ht={class:"text-xs text-muted-foreground text-center mt-2"},Yt={key:2,class:"bg-background rounded-lg border shadow-sm p-4 md:p-6 lg:col-span-3 md:col-span-2 transition-all duration-300 hover:shadow-md flex flex-col justify-center items-center"},zt={class:"flex flex-col items-center justify-center gap-3 mb-4"},qt={__name:"AcceptanceDashboard",props:{metricsData:{type:Object,default:()=>({})},driversData:{type:Array,default:()=>[]},chartData:{type:Object,default:()=>({})},averageAcceptance:{type:Number,default:null},currentDateFilter:{type:String,default:null},currentFilters:{type:Object,default:()=>({})}},setup(S){const i=S,h=A(()=>{var v;if(!i.metricsData||!i.metricsData.totalRejections)return[];const k=(v=i.currentFilters)==null?void 0:v.rejectionType;return!k||k===""?[{title:"Total Rejected Stops",value:i.metricsData.totalRejections||0},{title:"Rejected In Advance",value:i.metricsData.advancedRejectionCount||0},{title:"Rejected +24 Hours Before Start Time",value:i.metricsData.moreThan24Count||0},{title:"Rejected Within 24 Hours Before Start Time",value:i.metricsData.within24Count||0},{title:"Rejected +6 Hours Before Start Time",value:i.metricsData.moreThan6Count||0},{title:"Rejected Within 6 Hours Before Start Time",value:i.metricsData.within6Count||0},{title:"Rejected After Start Time",value:i.metricsData.afterStartCount||0}]:k==="block"?[{title:"Total Block Rejections",value:i.metricsData.totalRejections||0},{title:"Rejected In Advance",value:i.metricsData.advancedRejectionCount||0},{title:"Rejected +24 Hours Before Start Time",value:i.metricsData.moreThan24Count||0},{title:"Rejected Within 24 Hours Before Start Time",value:i.metricsData.within24Count||0},{title:"Rejected After Start Time",value:i.metricsData.afterStartCount||0}]:k==="load"?[{title:"Total Load Rejections",value:i.metricsData.totalRejections||0},{title:"Rejected +6 Hours Before Start Time",value:i.metricsData.moreThan6Count||0},{title:"Rejected Within 6 Hours Before Start Time",value:i.metricsData.within6Count||0},{title:"Rejected After Start Time",value:i.metricsData.afterStartCount||0}]:[]}),R=A(()=>i.driversData&&i.driversData.length?i.driversData:[]),I=A(()=>i.chartData&&Object.keys(i.chartData).length?i.chartData:{}),U=A(()=>{var k;return((k=i.metricsData)==null?void 0:k.totalRejections)||0}),w=A(()=>{var k;return((k=i.currentFilters)==null?void 0:k.rejectionType)||null}),C=A(()=>!i.chartData||!i.chartData.labels?!1:i.chartData.labels.length>1),D=A(()=>{var k,v,ne,P;return((P=(ne=(v=(k=i.chartData)==null?void 0:k.datasets)==null?void 0:v[0])==null?void 0:ne.data)==null?void 0:P.length)>0}),$=A(()=>D.value?i.chartData.datasets[0].data[0]:0),s=A(()=>{const k=$.value;return k>=98?"fantastic_plus":k>=95?"fantastic":k>=90?"good":k>=85?"fair":"poor"}),E=k=>k==null?"0%":`${Math.round(parseFloat(k))}%`,d=k=>{if(!k)return"Not Available";switch(k){case"fantastic_plus":return"Fantastic +";case"fantastic":return"Fantastic";case"good":return"Good";case"fair":return"Fair";case"poor":return"Poor";default:return k}},o=k=>{if(!k)return"outline";switch(k){case"fantastic_plus":return"fantastic-plus";case"fantastic":return"fantastic";case"good":return"good";case"fair":return"fair";case"poor":return"poor";default:return"outline"}},b=k=>{if(!k)return"text-gray-600";switch(k){case"fantastic_plus":return"text-green-600";case"fantastic":return"text-emerald-600";case"good":return"text-blue-600";case"fair":return"text-amber-600";case"poor":return"text-red-600";default:return"text-indigo-600"}},ee=k=>{if(!k)return"";switch(k){case"fantastic_plus":return"Outstanding performance with exceptional acceptance rate";case"fantastic":return"Excellent performance with very high acceptance rate";case"good":return"Solid performance with good acceptance rate";case"fair":return"Acceptable performance with room for improvement";case"poor":return"Performance needs significant improvement";default:return""}};return(k,v)=>(u(),f("div",Ut,[l("div",Et,[(u(!0),f(M,null,q(h.value,(ne,P)=>(u(),V(Dt,{key:P,title:ne.title,value:ne.value,class:"transition-all duration-300 hover:shadow-md"},null,8,["title","value"]))),128))]),l("div",Pt,[r(Ft,{title:"Bottom 5 Drivers",drivers:R.value,"total-rejections":U.value,"rejection-type":w.value,class:X({"lg:col-span-1":C.value,"lg:col-span-1 md:col-span-1":!C.value,"transition-all duration-300 hover:shadow-md":!0})},null,8,["drivers","total-rejections","rejection-type","class"]),i.currentDateFilter!="Yesterday"&&C.value?(u(),V(Lt,{key:0,title:"Acceptance Score",chartData:I.value,averageAcceptance:S.averageAcceptance,class:"lg:col-span-3 md:col-span-2 transition-all duration-300 hover:shadow-md"},null,8,["chartData","averageAcceptance"])):_("",!0),!C.value&&D.value?(u(),f("div",Ot,[v[0]||(v[0]=l("h3",{class:"text-base md:text-lg text-center font-semibold mb-4"},"Acceptance Score",-1)),l("div",Wt,[l("div",{class:X(["text-4xl md:text-5xl font-bold text-center",b(s.value)])},g(E($.value)),3),r(a(wt),{variant:o(s.value),class:"text-xs md:text-sm px-3 py-1"},{default:n(()=>[m(g(d(s.value)),1)]),_:1},8,["variant"])]),l("p",Ht,g(ee(s.value)),1)])):_("",!0),D.value?_("",!0):(u(),f("div",Yt,[v[3]||(v[3]=l("h3",{class:"text-base md:text-lg text-center font-semibold mb-4"},"Acceptance Score",-1)),l("div",zt,[r(W,{name:"chart_bar",class:"h-16 w-16 text-muted-foreground/50"}),v[1]||(v[1]=l("div",{class:"text-lg font-medium text-center text-primary"}," No data available ",-1)),v[2]||(v[2]=l("p",{class:"text-sm text-primary/70 text-center max-w-md"}," There is no acceptance data available for the selected time period. Try selecting a different date range or check back later. ",-1))])]))])]))}},Gt={class:"flex items-center gap-2"},Kt={class:"flex-1 overflow-y-auto px-4 sm:px-6 py-4 space-y-5"},Qt={key:0,class:"space-y-2"},Xt=["disabled"],Zt=["value"],Jt={key:0,class:"text-xs text-amber-600 dark:text-amber-400 flex items-center gap-1"},el={class:"text-sm font-semibold flex items-center gap-2"},tl={class:"flex h-5 w-5 items-center justify-center rounded-full bg-primary text-[11px] font-bold text-primary-foreground"},ll={class:"grid grid-cols-1 sm:grid-cols-2 gap-3"},al=["value","disabled"],rl={class:"space-y-0.5"},nl={class:"text-sm font-medium"},ol={class:"text-xs text-muted-foreground"},sl={class:"space-y-2"},il={class:"text-sm font-semibold flex items-center gap-2"},ul={class:"flex h-5 w-5 items-center justify-center rounded-full bg-primary text-[11px] font-bold text-primary-foreground"},dl={key:0,class:"rounded-md border p-3 bg-muted/10 space-y-1"},cl={class:"cursor-pointer inline-flex items-center gap-2 text-sm text-primary hover:underline mt-1"},ml=["disabled"],pl={key:1,class:"rounded-md border border-amber-300 bg-amber-50 dark:bg-amber-900/10 p-3 text-xs text-amber-700 dark:text-amber-300"},fl={class:"cursor-pointer mt-3"},vl=["disabled"],bl={key:0,class:"mt-2 text-xs text-muted-foreground"},gl={class:"font-medium text-foreground"},_l={key:1,class:"text-xs text-muted-foreground mt-2"},xl={key:2,class:"flex items-center justify-center gap-2 py-4"},yl={key:0,class:"rounded-md border border-primary/30 bg-primary/5 px-3 py-2 text-xs text-primary flex items-center gap-2"},kl={class:"font-semibold ml-1"},wl={key:1,class:"rounded-lg border p-3"},jl={class:"flex items-center justify-between mb-2"},Sl={class:"text-xs text-muted-foreground"},hl={class:"flex flex-wrap gap-2"},Cl={key:3,class:"grid grid-cols-3 gap-4"},$l={class:"text-2xl font-bold"},Dl={class:"text-2xl font-bold text-green-600"},Vl={class:"text-2xl font-bold text-red-600"},Rl={key:5},Al={class:"flex items-center justify-between mb-3"},Tl={class:"text-base font-semibold text-red-600 flex items-center gap-2"},Bl={class:"border rounded-lg overflow-hidden"},Fl={class:"max-h-72 overflow-y-auto"},Nl={class:"flex flex-wrap gap-x-3 gap-y-1"},Ml={class:"font-medium text-foreground"},Il={key:6},Ll={class:"text-base font-semibold text-green-600 flex items-center gap-2 mb-3"},Ul={class:"border rounded-lg overflow-hidden"},El={class:"flex flex-wrap gap-x-3 gap-y-1"},Pl={class:"font-medium"},Ol={class:"flex justify-start"},Wl={class:"border-t px-4 sm:px-6 py-4 flex items-center justify-between gap-3 bg-background"},Hl={class:"text-xs text-muted-foreground"},Yl={key:0},zl={class:"font-medium"},ql={class:"font-medium"},Gl={class:"flex gap-3"},Kl={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"},Ql=Te({__name:"ImportRejectionModal",props:{open:{type:Boolean,default:!1},isSuperAdmin:{type:Boolean,default:!1},tenantSlug:{type:String,default:null},tenants:{type:Array,default:()=>[]}},emits:["update:open","success","error"],setup(S,{emit:i}){const h=S,R=i,I=A({get:()=>h.open,set:x=>R("update:open",x)}),U=[{value:"advanced_block",label:"Advanced Block",description:"Import advanced block rejections from a weekly block schedule CSV."},{value:"block",label:"Block",description:"Import rejected blocks from a block acceptance status CSV."},{value:"load",label:"Load",description:"Import rejected loads from a load status CSV."},{value:"load_with_trips",label:"Load + Trips",description:"Import rejected loads and attach a Trips CSV to auto-fill driver names."},{value:"trips_only",label:"Trips Only",description:"Upload a Trips CSV to update driver names on existing load rejections."}],w=N(null),C=N(""),D=N(null),$=N(null),s=N(null),E=N(!1),d=N(!1),o=N(!1),b=N(null),ee=N(null);let k=0;const v=yt(),ne=A(()=>{var x;return((x=U.find(c=>c.value===C.value))==null?void 0:x.label)??""}),P=A(()=>{var x;return!h.isSuperAdmin||!w.value?"":((x=h.tenants.find(c=>c.id===w.value))==null?void 0:x.name)??""});A(()=>"/storage/upload-data-temps/Rejections Template.csv");const Z=A(()=>{var x,c;return!s.value||s.value.header_error||h.isSuperAdmin&&!w.value?!1:s.value.trips_only?!0:C.value==="load_with_trips"&&!$.value?!1:(((x=s.value.summary)==null?void 0:x.valid)??0)>0&&(((c=s.value.summary)==null?void 0:c.invalid)??0)===0}),le={advanced_block:{validate:"acceptance.validateAdvancedBlockImport",confirm:"acceptance.confirmAdvancedBlockImport"},block:{validate:"acceptance.validateBlockImport",confirm:"acceptance.confirmBlockImport"},load:{validate:"acceptance.validateLoadImport",confirm:"acceptance.confirmLoadImport"},load_with_trips:{validate:"acceptance.validateLoadImport",confirm:"acceptance.confirmLoadImport"},trips_only:{validate:"acceptance.validateLoadImport",confirm:"acceptance.confirmLoadImport"}};function me(x){var ie;const c=(ie=le[C.value])==null?void 0:ie[x];if(!c)throw new Error(`No route for type: ${C.value}`);const Y=h.isSuperAdmin?`${c}.admin`:c,K=h.isSuperAdmin?{}:{tenantSlug:h.tenantSlug};return route(Y,K)}function pe(){D.value=null,$.value=null,s.value=null,E.value=!1,o.value=!1,k=0,b.value&&(b.value.value=""),ee.value&&(ee.value.value="")}function xe(x){var Y;const c=(Y=x.target.files)==null?void 0:Y[0];c&&we(c),x.target.value=""}function se(x){var c;$.value=((c=x.target.files)==null?void 0:c[0])??null,C.value==="load_with_trips"&&D.value&&$.value&&ae()}function fe(){k++,o.value=!0}function ve(){o.value=!0}function Be(){k--,k<=0&&(k=0,o.value=!1)}function ye(x){var Y,K;k=0,o.value=!1;const c=(K=(Y=x.dataTransfer)==null?void 0:Y.files)==null?void 0:K[0];c&&we(c)}function we(x){if(!(x.type==="text/csv"||x.name.toLowerCase().endsWith(".csv"))){R("error","Please upload a valid CSV file.");return}if(D.value=x,C.value==="load_with_trips"&&!$.value){R("error","Please attach the required Trips CSV file.");return}ae()}function ae(){if(!D.value)return;E.value=!0;const x=new FormData;if(h.isSuperAdmin&&w.value&&x.append("tenant_id",String(w.value)),x.append("file",D.value),C.value==="load_with_trips"){if(!$.value){R("error","Trips CSV is required."),E.value=!1;return}x.append("trips_file",$.value)}C.value==="trips_only"&&(x.delete("file"),x.append("trips_file",D.value)),Me.post(me("validate"),x,{forceFormData:!0,preserveScroll:!0,onFinish:()=>{E.value=!1},onError:()=>{E.value=!1,R("error","Failed to validate CSV.")}})}function Fe(){d.value=!0;const x={};h.isSuperAdmin&&w.value&&(x.tenant_id=w.value),Me.post(me("confirm"),x,{preserveScroll:!0,onSuccess:()=>{var Y,K;const c=((K=(Y=s.value)==null?void 0:Y.summary)==null?void 0:K.valid)??0;R("success",`Successfully imported ${c} rejection(s) for ${P.value||"company"}.`),je()},onError:()=>R("error","Import failed. Please try again."),onFinish:()=>{d.value=!1}})}function Ne(){const x=h.isSuperAdmin?"acceptance.downloadErrorReport.admin":"acceptance.downloadErrorReport",c=h.isSuperAdmin?{}:{tenantSlug:h.tenantSlug};window.location.href=route(x,c)}function je(){I.value=!1}return ce(I,x=>{x||(w.value=null,C.value="",D.value=null,$.value=null,s.value=null,E.value=!1,d.value=!1,o.value=!1,k=0)}),ce(()=>{var x;return(x=v.props.flash)==null?void 0:x.importValidation},x=>{x&&(E.value=!1,x.results?(s.value={...x.results},x.header_error&&(s.value.header_error=x.header_error),x.trips_only&&(s.value.trips_only=!0)):x.message&&R("error",x.message))},{immediate:!0}),(x,c)=>(u(),V(a(Se),{open:I.value,"onUpdate:open":c[3]||(c[3]=Y=>I.value=Y)},{default:n(()=>[r(a(Ce),{class:"max-w-[95vw] sm:max-w-[90vw] md:max-w-5xl max-h-[90vh] overflow-hidden flex flex-col"},{default:n(()=>{var Y,K,ie;return[r(a($e),{class:"px-4 sm:px-6 border-b pb-3"},{default:n(()=>[l("div",Gt,[r(W,{name:"upload",class:"h-5 w-5 text-primary"}),r(a(De),{class:"text-lg sm:text-xl font-semibold"},{default:n(()=>c[4]||(c[4]=[m(" Import Rejections ")])),_:1})]),r(a(he),{class:"text-xs sm:text-sm mt-1 text-muted-foreground"},{default:n(()=>c[5]||(c[5]=[m(" Choose an import type, then upload your CSV file. The file will be validated before import. ")])),_:1})]),_:1}),l("div",Kt,[S.isSuperAdmin?(u(),f("div",Qt,[c[8]||(c[8]=l("p",{class:"text-sm font-semibold flex items-center gap-2"},[l("span",{class:"flex h-5 w-5 items-center justify-center rounded-full bg-primary text-[11px] font-bold text-primary-foreground"},"1"),m(" Select Company ")],-1)),J(l("select",{"onUpdate:modelValue":c[0]||(c[0]=T=>w.value=T),class:"select-base",disabled:E.value||d.value,onChange:pe},[c[6]||(c[6]=l("option",{value:null,disabled:""},"— Choose a company —",-1)),(u(!0),f(M,null,q(S.tenants,T=>(u(),f("option",{key:T.id,value:T.id},g(T.name),9,Zt))),128))],40,Xt),[[te,w.value]]),w.value?_("",!0):(u(),f("p",Jt,[r(W,{name:"alert-triangle",class:"h-3 w-3"}),c[7]||(c[7]=m(" You must select a company before uploading a file. "))]))])):_("",!0),l("div",{class:X(["space-y-2",{"opacity-50 pointer-events-none":S.isSuperAdmin&&!w.value}])},[l("p",el,[l("span",tl,g(S.isSuperAdmin?"2":"1"),1),c[9]||(c[9]=m(" Import Type "))]),l("div",ll,[(u(),f(M,null,q(U,T=>l("label",{key:T.value,class:X(["flex items-start gap-3 rounded-md border p-3 cursor-pointer hover:bg-muted/20 transition-colors",C.value===T.value?"border-primary bg-primary/5":"border-border"])},[J(l("input",{type:"radio",class:"mt-1 accent-primary",value:T.value,"onUpdate:modelValue":c[1]||(c[1]=G=>C.value=G),disabled:E.value||d.value||S.isSuperAdmin&&!w.value,onChange:pe},null,40,al),[[gt,C.value]]),l("div",rl,[l("div",nl,g(T.label),1),l("div",ol,g(T.description),1)])],2)),64))])],2),C.value&&!s.value&&(!S.isSuperAdmin||w.value)?(u(),f(M,{key:1},[l("div",sl,[l("p",il,[l("span",ul,g(S.isSuperAdmin?"3":"2"),1),c[10]||(c[10]=m(" Upload File "))])]),C.value==="load_with_trips"?(u(),f("div",dl,[c[11]||(c[11]=l("p",{class:"text-xs font-semibold text-muted-foreground uppercase tracking-wide"}," Required: Trips file ",-1)),c[12]||(c[12]=l("p",{class:"text-xs text-muted-foreground"}," You must upload a Trips CSV alongside the Loads CSV to import with driver names. ",-1)),l("label",cl,[r(W,{name:"file-plus",class:"h-4 w-4"}),m(" "+g($.value?$.value.name:"Attach Trips CSV")+" ",1),l("input",{ref_key:"tripsFileInput",ref:ee,type:"file",class:"hidden",accept:".csv,text/csv",onChange:se,disabled:E.value},null,40,ml)]),$.value?(u(),f("button",{key:0,type:"button",onClick:c[2]||(c[2]=T=>$.value=null),class:"ml-2 text-xs text-red-500 hover:underline"}," Remove ")):_("",!0)])):_("",!0),C.value==="trips_only"?(u(),f("div",pl," This will upload a Trips CSV only to update driver names on existing load rejections. No new rejections will be created. ")):_("",!0),l("div",{class:X(["flex flex-col items-center justify-center border-2 border-dashed rounded-lg p-8 bg-muted/10 transition-colors",{"border-primary bg-primary/5":o.value,"opacity-60 pointer-events-none":E.value}]),onDragenter:be(fe,["prevent"]),onDragover:be(ve,["prevent"]),onDragleave:be(Be,["prevent"]),onDrop:be(ye,["prevent"])},[r(W,{name:"file-spreadsheet",class:"h-12 w-12 text-muted-foreground mb-3"}),c[15]||(c[15]=l("div",{class:"text-center"},[l("p",{class:"text-sm font-medium"},[l("span",{class:"text-primary"},"Drag & drop"),m(" your CSV here ")]),l("p",{class:"text-xs text-muted-foreground mt-1"},"or")],-1)),l("label",fl,[c[13]||(c[13]=l("span",{class:"text-sm font-medium text-primary hover:underline"},"Choose CSV file",-1)),l("input",{ref_key:"mainFileInput",ref:b,type:"file",class:"hidden",accept:".csv,text/csv",onChange:xe,disabled:E.value},null,40,vl)]),D.value?(u(),f("p",bl,[c[14]||(c[14]=m(" Selected: ")),l("span",gl,g(D.value.name),1)])):(u(),f("p",_l,"CSV files only"))],34),E.value?(u(),f("div",xl,c[16]||(c[16]=[l("div",{class:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary"},null,-1),l("span",{class:"text-sm text-muted-foreground"},"Validating CSV file...",-1)]))):_("",!0)],64)):_("",!0),s.value?(u(),f(M,{key:2},[S.isSuperAdmin&&w.value?(u(),f("div",yl,[r(W,{name:"building",class:"h-4 w-4 flex-shrink-0"}),c[17]||(c[17]=m(" Importing for: ")),l("span",kl,g(P.value),1)])):_("",!0),(Y=s.value.headers)!=null&&Y.length?(u(),f("div",wl,[l("div",jl,[c[18]||(c[18]=l("span",{class:"text-sm font-semibold"},"CSV Headers Detected",-1)),l("span",Sl,g(s.value.headers.length)+" columns",1)]),l("div",hl,[(u(!0),f(M,null,q(s.value.headers,T=>(u(),f("span",{key:T,class:"rounded-full bg-muted px-2 py-0.5 text-xs"},g(T),1))),128))])])):_("",!0),s.value.header_error?(u(),V(a(Ve),{key:2,variant:"destructive"},{default:n(()=>[r(a(Re),null,{default:n(()=>c[19]||(c[19]=[m("Header Error")])),_:1}),r(a(Ae),null,{default:n(()=>[m(g(s.value.header_error),1)]),_:1})]),_:1})):_("",!0),s.value.summary.total!==-1?(u(),f("div",Cl,[r(a(ge),{class:"border-2"},{default:n(()=>[r(a(_e),{class:"p-4 text-center"},{default:n(()=>[l("div",$l,g(s.value.summary.total),1),c[20]||(c[20]=l("div",{class:"text-sm text-muted-foreground"},"Total Rows",-1))]),_:1})]),_:1}),r(a(ge),{class:"border-2 border-green-500/50 bg-green-50 dark:bg-green-900/10"},{default:n(()=>[r(a(_e),{class:"p-4 text-center"},{default:n(()=>[l("div",Dl,g(s.value.summary.valid),1),c[21]||(c[21]=l("div",{class:"text-sm text-muted-foreground"},"Valid",-1))]),_:1})]),_:1}),r(a(ge),{class:"border-2 border-red-500/50 bg-red-50 dark:bg-red-900/10"},{default:n(()=>[r(a(_e),{class:"p-4 text-center"},{default:n(()=>[l("div",Vl,g(s.value.summary.invalid),1),c[22]||(c[22]=l("div",{class:"text-sm text-muted-foreground"},"Invalid",-1))]),_:1})]),_:1})])):_("",!0),s.value.trips_only?(u(),V(a(Ve),{key:4,class:"border-amber-300 bg-amber-50 dark:bg-amber-900/10"},{default:n(()=>[r(a(Re),{class:"text-amber-700 dark:text-amber-300"},{default:n(()=>c[23]||(c[23]=[m("Trips Only Mode")])),_:1}),r(a(Ae),{class:"text-amber-600 dark:text-amber-400"},{default:n(()=>c[24]||(c[24]=[m(" Only driver names will be updated on existing load rejections. No new records will be created. ")])),_:1})]),_:1})):_("",!0),(K=s.value.invalid)!=null&&K.length?(u(),f("div",Rl,[l("div",Al,[l("h3",Tl,[r(W,{name:"alert-triangle",class:"h-5 w-5"}),m(" Validation Errors ("+g(s.value.invalid.length)+") ",1)]),r(L,{onClick:Ne,variant:"outline",size:"sm"},{default:n(()=>[r(W,{name:"download",class:"h-4 w-4 mr-1"}),c[25]||(c[25]=m(" Download Error Report "))]),_:1})]),l("div",Bl,[l("div",Fl,[r(a(Le),null,{default:n(()=>[r(a(Ue),{class:"sticky top-0 bg-background"},{default:n(()=>[r(a(de),null,{default:n(()=>[r(a(oe),{class:"w-20"},{default:n(()=>c[26]||(c[26]=[m("Row #")])),_:1}),r(a(oe),null,{default:n(()=>c[27]||(c[27]=[m("Preview")])),_:1}),r(a(oe),null,{default:n(()=>c[28]||(c[28]=[m("Errors")])),_:1})]),_:1})]),_:1}),r(a(Ee),null,{default:n(()=>[(u(!0),f(M,null,q(s.value.invalid,T=>(u(),V(a(de),{key:T.rowNumber},{default:n(()=>[r(a(re),{class:"font-medium text-sm"},{default:n(()=>[m(g(T.rowNumber),1)]),_:2},1024),r(a(re),{class:"text-xs text-muted-foreground"},{default:n(()=>[l("div",Nl,[(u(!0),f(M,null,q(T.preview||[],G=>(u(),f("span",{key:G.key,class:"whitespace-nowrap"},[l("span",Ml,g(G.label)+":",1),m(" "+g(G.value),1)]))),128))])]),_:2},1024),r(a(re),null,{default:n(()=>[(u(!0),f(M,null,q(T.errors||[],(G,ue)=>(u(),f("div",{key:ue,class:"text-xs text-red-600"}," • "+g(G),1))),128))]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])])])):_("",!0),(ie=s.value.valid)!=null&&ie.length&&!s.value.trips_only?(u(),f("div",Il,[l("h3",Ll,[r(W,{name:"check-circle",class:"h-5 w-5"}),m(" Valid Rows Preview (first 5 of "+g(s.value.valid.length)+") ",1)]),l("div",Ul,[r(a(Le),null,{default:n(()=>[r(a(Ue),null,{default:n(()=>[r(a(de),null,{default:n(()=>[r(a(oe),{class:"w-20"},{default:n(()=>c[29]||(c[29]=[m("Row #")])),_:1}),r(a(oe),null,{default:n(()=>c[30]||(c[30]=[m("Preview")])),_:1})]),_:1})]),_:1}),r(a(Ee),null,{default:n(()=>[(u(!0),f(M,null,q(s.value.valid.slice(0,5),T=>(u(),V(a(de),{key:T.rowNumber},{default:n(()=>[r(a(re),{class:"font-medium text-sm"},{default:n(()=>[m(g(T.rowNumber),1)]),_:2},1024),r(a(re),{class:"text-xs"},{default:n(()=>[l("div",El,[(u(!0),f(M,null,q(T.preview||[],G=>(u(),f("span",{key:G.key,class:"whitespace-nowrap"},[l("span",Pl,g(G.label)+":",1),m(" "+g(G.value),1)]))),128))])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])])):_("",!0),l("div",Ol,[r(L,{onClick:pe,variant:"ghost",size:"sm",class:"text-muted-foreground"},{default:n(()=>[r(W,{name:"rotate_ccw",class:"mr-2 h-4 w-4"}),c[31]||(c[31]=m(" Upload a different file "))]),_:1})])],64)):_("",!0)]),l("div",Wl,[l("div",Hl,[S.isSuperAdmin&&P.value?(u(),f("span",Yl,[c[32]||(c[32]=m(" Company: ")),l("span",zl,g(P.value),1)])):_("",!0),C.value?(u(),f("span",{key:1,class:X({"ml-3":S.isSuperAdmin&&P.value})},[c[33]||(c[33]=m(" Mode: ")),l("span",ql,g(ne.value),1)],2)):_("",!0)]),l("div",Gl,[r(L,{onClick:je,variant:"outline",disabled:d.value},{default:n(()=>c[34]||(c[34]=[m("Close")])),_:1},8,["disabled"]),Z.value?(u(),V(L,{key:0,onClick:Fe,variant:"default",disabled:d.value},{default:n(()=>{var T,G,ue;return[d.value?(u(),f("div",Kl)):(u(),V(W,{key:1,name:"check",class:"h-4 w-4 mr-1"})),m(" "+g(d.value?"Importing...":(T=s.value)!=null&&T.trips_only?"Update Driver Names":`Import ${((ue=(G=s.value)==null?void 0:G.summary)==null?void 0:ue.valid)??0} Rows`),1)]}),_:1},8,["disabled"])):_("",!0)])])]}),_:1})]),_:1},8,["open"]))}}),Xl=Pe(Ql,[["__scopeId","data-v-2e8bbe32"]]),Zl={key:0,class:"text-sm text-red-500"},O=Te({__name:"InputError",props:{message:{type:String,default:""}},setup(S){return(i,h)=>S.message?(u(),f("div",Zl,g(S.message),1)):_("",!0)}}),Jl={key:0,class:"col-span-full"},ea=["value"],ta={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},la={class:"flex gap-2 mt-1"},aa={key:1,class:"grid grid-cols-1 sm:grid-cols-2 gap-4 rounded-md border p-4"},ra={key:2,class:"grid grid-cols-1 sm:grid-cols-2 gap-4 rounded-md border p-4"},na={key:3,class:"grid grid-cols-1 sm:grid-cols-2 gap-4 rounded-md border p-4"},oa={class:"flex flex-col space-y-2 sm:space-y-0 sm:flex-row sm:justify-end sm:space-x-2 pt-4 border-t"},sa=Te({__name:"RejectionForm",props:{rejection:{type:Object,default:null},tenants:{type:Array,default:()=>[]},isSuperAdmin:{type:Boolean,default:!1},tenantSlug:{type:String,default:null}},emits:["close","success"],setup(S,{emit:i}){const h=S,R=i,I=[{value:"advanced_block",label:"Advanced Block"},{value:"block",label:"Block"},{value:"load",label:"Load"}];function U(d){return d&&d.type&&["advanced_block","block","load"].includes(d.type)?d.type:"block"}function w(d){return d?d.includes("T")?d.slice(0,16):d.replace(" ","T").slice(0,16):""}function C(d){return d?String(d).split("T")[0].split(" ")[0]:""}function D(d){return d===!0||d===1||d==="1"}function $(d){const o=U(d);return{id:(d==null?void 0:d.id)??null,tenant_id:(d==null?void 0:d.tenant_id)??null,date:C(d==null?void 0:d.date)??"",disputed:(d==null?void 0:d.disputed)??"none",carrier_controllable:D(d==null?void 0:d.carrier_controllable),driver_controllable:D(d==null?void 0:d.driver_controllable),rejection_reason:(d==null?void 0:d.rejection_reason)??"",type:o,advance_block_rejection_id:(d==null?void 0:d.advance_block_rejection_id)??"",week_start:C(d==null?void 0:d.week_start)??"",week_end:C(d==null?void 0:d.week_end)??"",impacted_blocks:(d==null?void 0:d.impacted_blocks)??"",expected_blocks:(d==null?void 0:d.expected_blocks)??"",block_id:(d==null?void 0:d.block_id)??"",block_driver_name:(d==null?void 0:d.block_driver_name)??"",block_start:w(d==null?void 0:d.block_start)??"",block_end:w(d==null?void 0:d.block_end)??"",rejection_datetime:w(d==null?void 0:d.rejection_datetime)??"",load_id:(d==null?void 0:d.load_id)??"",load_driver_name:(d==null?void 0:d.load_driver_name)??"",origin_yard_arrival:w(d==null?void 0:d.origin_yard_arrival)??"",load_rejection_bucket:(d==null?void 0:d.load_rejection_bucket)??""}}const s=Ie($(h.rejection));ce(()=>h.rejection,d=>{const o=$(d);Object.keys(o).forEach(b=>{s[b]=o[b]}),s.clearErrors()},{immediate:!0});function E(){const d=!!s.id,o=h.isSuperAdmin?d?"acceptance.update.admin":"acceptance.store.admin":d?"acceptance.update":"acceptance.store",b=h.isSuperAdmin?d?{rejection:s.id}:{}:d?{tenantSlug:h.tenantSlug,rejection:s.id}:{tenantSlug:h.tenantSlug};s[d?"put":"post"](route(o,b),{preserveScroll:!0,onSuccess:()=>{R("success"),R("close")}})}return(d,o)=>(u(),f("form",{onSubmit:be(E,["prevent"]),class:"space-y-6"},[S.isSuperAdmin?(u(),f("div",Jl,[r(B,null,{default:n(()=>o[21]||(o[21]=[m("Company Name")])),_:1}),J(l("select",{"onUpdate:modelValue":o[0]||(o[0]=b=>a(s).tenant_id=b),class:"select-base"},[o[22]||(o[22]=l("option",{value:null,disabled:""},"Select Company",-1)),(u(!0),f(M,null,q(S.tenants,b=>(u(),f("option",{key:b.id,value:b.id},g(b.name),9,ea))),128))],512),[[te,a(s).tenant_id]]),r(O,{message:a(s).errors.tenant_id},null,8,["message"])])):_("",!0),l("div",null,[r(B,null,{default:n(()=>o[23]||(o[23]=[m("Date")])),_:1}),r(a(H),{type:"date",modelValue:a(s).date,"onUpdate:modelValue":o[1]||(o[1]=b=>a(s).date=b),class:"w-full"},null,8,["modelValue"]),r(O,{message:a(s).errors.date},null,8,["message"])]),l("div",ta,[l("div",null,[r(B,{for:"disputed"},{default:n(()=>o[24]||(o[24]=[m("Disputed")])),_:1}),J(l("select",{id:"disputed","onUpdate:modelValue":o[2]||(o[2]=b=>a(s).disputed=b),class:"select-base"},o[25]||(o[25]=[l("option",{value:"none"},"None",-1),l("option",{value:"pending"},"Pending",-1),l("option",{value:"won"},"Won",-1),l("option",{value:"lost"},"Lost",-1)]),512),[[te,a(s).disputed]]),r(O,{message:a(s).errors.disputed},null,8,["message"])]),l("div",null,[r(B,{for:"carrier_controllable"},{default:n(()=>o[26]||(o[26]=[m("Carrier Controllable")])),_:1}),J(l("select",{id:"carrier_controllable","onUpdate:modelValue":o[3]||(o[3]=b=>a(s).carrier_controllable=b),class:"select-base"},o[27]||(o[27]=[l("option",{value:!0},"Yes",-1),l("option",{value:!1},"No",-1)]),512),[[te,a(s).carrier_controllable]]),r(O,{message:a(s).errors.carrier_controllable},null,8,["message"])]),l("div",null,[r(B,{for:"driver_controllable"},{default:n(()=>o[28]||(o[28]=[m("Driver Controllable")])),_:1}),J(l("select",{id:"driver_controllable","onUpdate:modelValue":o[4]||(o[4]=b=>a(s).driver_controllable=b),class:"select-base"},o[29]||(o[29]=[l("option",{value:!0},"Yes",-1),l("option",{value:!1},"No",-1)]),512),[[te,a(s).driver_controllable]]),r(O,{message:a(s).errors.driver_controllable},null,8,["message"])]),l("div",null,[r(B,{for:"rejection_reason"},{default:n(()=>o[30]||(o[30]=[m("Rejection Reason")])),_:1}),r(a(H),{id:"rejection_reason",modelValue:a(s).rejection_reason,"onUpdate:modelValue":o[5]||(o[5]=b=>a(s).rejection_reason=b),placeholder:"Optional reason...",class:"w-full"},null,8,["modelValue"]),r(O,{message:a(s).errors.rejection_reason},null,8,["message"])])]),l("div",null,[r(B,null,{default:n(()=>o[31]||(o[31]=[m("Rejection Type")])),_:1}),l("div",la,[(u(),f(M,null,q(I,b=>r(L,{type:"button",key:b.value,variant:a(s).type===b.value?"default":"outline",size:"sm",onClick:ee=>a(s).type=b.value},{default:n(()=>[m(g(b.label),1)]),_:2},1032,["variant","onClick"])),64))]),r(O,{message:a(s).errors.type},null,8,["message"])]),a(s).type==="advanced_block"?(u(),f("div",aa,[o[37]||(o[37]=l("p",{class:"col-span-full text-sm font-semibold text-muted-foreground"},"Advanced Block Details",-1)),l("div",null,[r(B,null,{default:n(()=>o[32]||(o[32]=[m("Advance Block Rejection ID")])),_:1}),r(a(H),{modelValue:a(s).advance_block_rejection_id,"onUpdate:modelValue":o[6]||(o[6]=b=>a(s).advance_block_rejection_id=b),class:"w-full"},null,8,["modelValue"]),r(O,{message:a(s).errors.advance_block_rejection_id},null,8,["message"])]),l("div",null,[r(B,null,{default:n(()=>o[33]||(o[33]=[m("Week Start")])),_:1}),r(a(H),{type:"date",modelValue:a(s).week_start,"onUpdate:modelValue":o[7]||(o[7]=b=>a(s).week_start=b),class:"w-full"},null,8,["modelValue"]),r(O,{message:a(s).errors.week_start},null,8,["message"])]),l("div",null,[r(B,null,{default:n(()=>o[34]||(o[34]=[m("Week End")])),_:1}),r(a(H),{type:"date",modelValue:a(s).week_end,"onUpdate:modelValue":o[8]||(o[8]=b=>a(s).week_end=b),class:"w-full"},null,8,["modelValue"]),r(O,{message:a(s).errors.week_end},null,8,["message"])]),l("div",null,[r(B,null,{default:n(()=>o[35]||(o[35]=[m("Impacted Blocks")])),_:1}),r(a(H),{type:"number",min:"0",modelValue:a(s).impacted_blocks,"onUpdate:modelValue":o[9]||(o[9]=b=>a(s).impacted_blocks=b),class:"w-full"},null,8,["modelValue"]),r(O,{message:a(s).errors.impacted_blocks},null,8,["message"])]),l("div",null,[r(B,null,{default:n(()=>o[36]||(o[36]=[m("Expected Blocks")])),_:1}),r(a(H),{type:"number",min:"0",modelValue:a(s).expected_blocks,"onUpdate:modelValue":o[10]||(o[10]=b=>a(s).expected_blocks=b),class:"w-full"},null,8,["modelValue"]),r(O,{message:a(s).errors.expected_blocks},null,8,["message"])])])):_("",!0),a(s).type==="block"?(u(),f("div",ra,[o[43]||(o[43]=l("p",{class:"col-span-full text-sm font-semibold text-muted-foreground"},"Block Details",-1)),l("div",null,[r(B,null,{default:n(()=>o[38]||(o[38]=[m("Block ID")])),_:1}),r(a(H),{modelValue:a(s).block_id,"onUpdate:modelValue":o[11]||(o[11]=b=>a(s).block_id=b),class:"w-full"},null,8,["modelValue"]),r(O,{message:a(s).errors.block_id},null,8,["message"])]),l("div",null,[r(B,null,{default:n(()=>o[39]||(o[39]=[m("Driver Name")])),_:1}),r(a(H),{modelValue:a(s).block_driver_name,"onUpdate:modelValue":o[12]||(o[12]=b=>a(s).block_driver_name=b),class:"w-full"},null,8,["modelValue"]),r(O,{message:a(s).errors.block_driver_name},null,8,["message"])]),l("div",null,[r(B,null,{default:n(()=>o[40]||(o[40]=[m("Block Start")])),_:1}),r(a(H),{type:"datetime-local",modelValue:a(s).block_start,"onUpdate:modelValue":o[13]||(o[13]=b=>a(s).block_start=b),class:"w-full"},null,8,["modelValue"]),r(O,{message:a(s).errors.block_start},null,8,["message"])]),l("div",null,[r(B,null,{default:n(()=>o[41]||(o[41]=[m("Block End")])),_:1}),r(a(H),{type:"datetime-local",modelValue:a(s).block_end,"onUpdate:modelValue":o[14]||(o[14]=b=>a(s).block_end=b),class:"w-full"},null,8,["modelValue"]),r(O,{message:a(s).errors.block_end},null,8,["message"])]),l("div",null,[r(B,null,{default:n(()=>o[42]||(o[42]=[m("Rejection Date/Time")])),_:1}),r(a(H),{type:"datetime-local",modelValue:a(s).rejection_datetime,"onUpdate:modelValue":o[15]||(o[15]=b=>a(s).rejection_datetime=b),class:"w-full"},null,8,["modelValue"]),r(O,{message:a(s).errors.rejection_datetime},null,8,["message"])])])):_("",!0),a(s).type==="load"?(u(),f("div",na,[o[49]||(o[49]=l("p",{class:"col-span-full text-sm font-semibold text-muted-foreground"},"Load Details",-1)),l("div",null,[r(B,null,{default:n(()=>o[44]||(o[44]=[m("Load ID")])),_:1}),r(a(H),{modelValue:a(s).load_id,"onUpdate:modelValue":o[16]||(o[16]=b=>a(s).load_id=b),class:"w-full"},null,8,["modelValue"]),r(O,{message:a(s).errors.load_id},null,8,["message"])]),l("div",null,[r(B,null,{default:n(()=>o[45]||(o[45]=[m("Driver Name")])),_:1}),r(a(H),{modelValue:a(s).load_driver_name,"onUpdate:modelValue":o[17]||(o[17]=b=>a(s).load_driver_name=b),class:"w-full"},null,8,["modelValue"]),r(O,{message:a(s).errors.load_driver_name},null,8,["message"])]),l("div",null,[r(B,null,{default:n(()=>o[46]||(o[46]=[m("Origin Yard Arrival")])),_:1}),r(a(H),{type:"datetime-local",modelValue:a(s).origin_yard_arrival,"onUpdate:modelValue":o[18]||(o[18]=b=>a(s).origin_yard_arrival=b),class:"w-full"},null,8,["modelValue"]),r(O,{message:a(s).errors.origin_yard_arrival},null,8,["message"])]),l("div",null,[r(B,null,{default:n(()=>o[47]||(o[47]=[m("Load Rejection Bucket")])),_:1}),J(l("select",{"onUpdate:modelValue":o[19]||(o[19]=b=>a(s).load_rejection_bucket=b),class:"select-base"},o[48]||(o[48]=[l("option",{value:""},"— Select —",-1),l("option",{value:"rejected_after_start_time"},"After Start Time",-1),l("option",{value:"rejected_0_6_hours_before_start_time"},"0–6 Hours Before Start",-1),l("option",{value:"rejected_6_plus_hours_before_start_time"},"6+ Hours Before Start",-1)]),512),[[te,a(s).load_rejection_bucket]]),r(O,{message:a(s).errors.load_rejection_bucket},null,8,["message"])])])):_("",!0),l("div",oa,[r(L,{type:"button",onClick:o[20]||(o[20]=b=>R("close")),variant:"outline",class:"w-full sm:w-auto"},{default:n(()=>o[50]||(o[50]=[m(" Cancel ")])),_:1}),r(L,{type:"submit",disabled:a(s).processing,class:"w-full sm:w-auto"},{default:n(()=>[m(g(a(s).id?"Update":"Create"),1)]),_:1},8,["disabled"])])],32))}}),ia=Pe(sa,[["__scopeId","data-v-bf916ea7"]]),ua={class:"w-full md:max-w-2xl lg:max-w-3xl xl:max-w-6xl lg:mx-auto m-0 p-2 md:p-4 lg:p-6 space-y-2 md:space-y-4 lg:space-y-6"},da={class:"mb-2 flex flex-col items-center justify-between px-2 sm:flex-row md:mb-4 lg:mb-6"},ca={class:"flex flex-wrap gap-3 ml-3"},ma=["action"],pa={class:"flex flex-col items-center gap-2 md:items-start"},fa={class:"flex flex-wrap gap-1 md:gap-2"},va={key:0,class:"text-sm text-muted-foreground"},ba={key:0},ga={key:1},_a={key:2},xa={key:3,class:"ml-1"},ya={class:"flex items-center justify-between"},ka={class:"flex items-center gap-3 flex-wrap"},wa={class:"flex items-center rounded-lg border border-input bg-muted p-0.5 gap-0.5"},ja={key:0,class:"flex flex-wrap gap-2"},Sa={key:0,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold"},ha={key:1,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold"},Ca={key:2,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold"},$a={key:3,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold capitalize"},Da={key:4,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold"},Va={key:5,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold"},Ra={key:6,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold"},Aa={class:"flex flex-col gap-3 md:gap-4"},Ta={class:"grid w-full grid-cols-1 gap-3 sm:grid-cols-3 md:gap-4"},Ba={class:"grid w-full grid-cols-1 gap-3 sm:grid-cols-3 md:gap-4"},Fa={class:"grid w-full grid-cols-1 gap-3 sm:grid-cols-2 md:gap-4"},Na={class:"flex justify-end space-x-2"},Ma={class:"overflow-x-auto"},Ia={class:"flex items-center justify-center"},La=["checked"],Ua={class:"flex items-center gap-1"},Ea={key:0},Pa={key:0,class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Oa={key:1,class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Wa={key:1,class:"opacity-40"},Ha=["value"],Ya={class:"flex space-x-2"},za={key:0,class:"border-t bg-muted/20 px-4 py-3"},qa={class:"flex flex-col items-center justify-between gap-2 sm:flex-row"},Ga={class:"flex items-center gap-4 text-sm text-muted-foreground"},Ka={class:"flex items-center gap-2"},Qa=["value"],Xa={class:"flex flex-wrap"},Za=["innerHTML"],Ja={__name:"Index",props:{rejections:{type:Object,default:()=>({data:[],links:[],total:0})},tenantSlug:{type:String,default:null},tenants:{type:Array,default:()=>[]},isSuperAdmin:{type:Boolean,default:!1},dateFilter:{type:String,default:"yesterday"},dateRange:{type:Object,default:()=>({})},perPage:{type:Number,default:10},weekNumber:{type:Number,default:null},startWeekNumber:{type:Number,default:null},endWeekNumber:{type:Number,default:null},year:{type:Number,default:null},rejection_breakdown:{type:Object,default:null},line_chart_data:{type:Array,default:()=>[]},average_acceptance:{type:Number,default:null},filters:{type:Object,default:()=>({search:"",rejectionType:"",rejectionBucket:"",disputed:"",carrierControllable:"",driverControllable:"",penaltyMin:"",penaltyMax:"",rejectionReasonFilter:"with_reason"})},permissions:{type:Array,default:()=>[]}},setup(S){var We,He,Ye,ze,qe,Ge,Ke,Qe,Xe;const i=S,h=N(!1),R=N(null),I=N(""),U=N(""),w=N(i.dateFilter||"quarterly"),C=N(i.perPage||10),D=N([]),$=N(!1),s=N(!1),E=N(null),d=N(null),o=N(!1),b=N(!1),ee=N("date"),k=N("desc"),v=N({search:((We=i.filters)==null?void 0:We.search)??"",rejectionType:((He=i.filters)==null?void 0:He.rejectionType)??"",rejectionBucket:((Ye=i.filters)==null?void 0:Ye.rejectionBucket)??"",disputed:((ze=i.filters)==null?void 0:ze.disputed)??"",carrierControllable:((qe=i.filters)==null?void 0:qe.carrierControllable)??"",driverControllable:((Ge=i.filters)==null?void 0:Ge.driverControllable)??"",penaltyMin:((Ke=i.filters)==null?void 0:Ke.penaltyMin)??"",penaltyMax:((Qe=i.filters)==null?void 0:Qe.penaltyMax)??"",rejectionReasonFilter:((Xe=i.filters)==null?void 0:Xe.rejectionReasonFilter)??"with_reason"}),ne=[{title:i.tenantSlug?"Dashboard":"Admin Dashboard",href:i.tenantSlug?route("dashboard",{tenantSlug:i.tenantSlug}):route("admin.dashboard")},{title:"Acceptance",href:i.tenantSlug?route("acceptance.index",{tenantSlug:i.tenantSlug}):route("acceptance.index.admin")}];function P(t){var e;return((e=t.advanced_rejected_block)==null?void 0:e[0])??null}function Z(t){var e;return((e=t.rejected_block)==null?void 0:e[0])??null}function le(t){var e;return((e=t.rejected_load)==null?void 0:e[0])??null}function me(t){return P(t)?"advanced_block":le(t)?"load":Z(t)?"block":"unknown"}function pe(t){return{advanced_block:"Advanced Block",block:"Block",load:"Load",unknown:"—"}[t]??t}function xe(t){return{more_than_24:"24+ hours before start",less_than_24:"Less than 24 hours before start",rejected_after_start_time:"Rejected after start time",rejected_0_6_hours_before_start_time:"Rejected 0–6 hours before start",rejected_6_plus_hours_before_start_time:"Rejected 6+ hours before start"}[t]??t??"—"}function se(t){if(!t)return"—";const e=String(t).split(" ")[0],[j,p,F]=e.split("-");return!j||!p||!F?t:`${Number(p)}/${Number(F)}/${j}`}function fe(t){if(!t)return"—";try{return new Date(t).toLocaleString("en-US",{month:"numeric",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{return t}}const ve=[{key:"date",label:"Date",shared:!0,getValue:t=>se(t.date)},{key:"type",label:"Type",shared:!0,getValue:t=>me(t),render:t=>{const e=me(t),j={advanced_block:"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300",block:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300",load:"bg-amber-100 text-amber-700 dark:bg-amber-900/30 dark:text-amber-300",unknown:"bg-muted text-muted-foreground"}[e]??"bg-muted text-muted-foreground";return z("span",{class:`inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium ${j}`},pe(e))}},{key:"penalty",label:"Penalty",shared:!0,getValue:t=>{const e=t.disputed==="won";t.driver_controllable===!0||t.driver_controllable===1||t.driver_controllable==="1"||t.driver_controllable;const j=t.carrier_controllable===!0||t.carrier_controllable===1||t.carrier_controllable==="1"||t.carrier_controllable==="true";return e||!j?0:t.penalty!=null?Number(t.penalty):null},render:t=>{const e=t.penalty!=null?Number(t.penalty).toFixed(2):null,j=t.disputed==="won",p=t.driver_controllable===!0||t.driver_controllable===1||t.driver_controllable==="1"||t.driver_controllable==="true",F=t.carrier_controllable===!0||t.carrier_controllable===1||t.carrier_controllable==="1"||t.carrier_controllable==="true";return!e&&!j?z("span",{class:"text-muted-foreground"},"—"):j&&p?z("div",{class:"flex flex-col leading-tight"},[z("span",{class:"font-mono text-xs font-semibold text-green-600 dark:text-green-400"},"0.00"),z("span",{class:"self-end text-[10px] opacity-60 font-mono whitespace-nowrap"},`Driver: ${e}`)]):j?z("span",{class:"font-mono text-xs font-semibold text-green-600 dark:text-green-400"},"0.00"):F?z("span",{class:"font-mono text-xs"},e):p&&e?z("div",{class:"flex flex-col leading-tight"},[z("span",{class:"font-mono text-xs font-semibold text-green-600 dark:text-green-400"},"0.00"),z("span",{class:"self-end text-[10px] opacity-60 font-mono whitespace-nowrap"},`Driver: ${e}`)]):z("span",{class:"font-mono text-xs font-semibold text-green-600 dark:text-green-400"},"0.00")}},{key:"disputed",label:"Disputed",shared:!0,getValue:t=>t.disputed||null,render:t=>{const e={none:"bg-muted text-muted-foreground",pending:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-300",won:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300",lost:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300"}[t.disputed]??"bg-muted text-muted-foreground";return z("span",{class:`inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium capitalize ${e}`},t.disputed||"none")}},{key:"carrier_controllable",label:"Carrier Ctrl.",shared:!0,getValue:t=>t.carrier_controllable!=null?t.carrier_controllable?"Yes":"No":null},{key:"driver_controllable",label:"Driver Ctrl.",shared:!0,getValue:t=>t.driver_controllable!=null?t.driver_controllable?"Yes":"No":null},{key:"rejection_reason",label:"Reason",shared:!0,getValue:t=>t.rejection_reason||null,render:t=>t.rejection_reason?z("span",{class:"block max-w-[180px] truncate",title:t.rejection_reason},t.rejection_reason):z("span",{class:"text-muted-foreground"},"—")},{key:"ab_rejection_id",label:"Adv. Rejection ID",shared:!1,getValue:t=>{var e;return((e=P(t))==null?void 0:e.advance_block_rejection_id)??null}},{key:"ab_week_start",label:"Week Start",shared:!1,getValue:t=>{var e;return(e=P(t))!=null&&e.week_start?se(P(t).week_start):null}},{key:"ab_week_end",label:"Week End",shared:!1,getValue:t=>{var e;return(e=P(t))!=null&&e.week_end?se(P(t).week_end):null}},{key:"ab_impacted_blocks",label:"Impacted Blocks",shared:!1,getValue:t=>{var e;return((e=P(t))==null?void 0:e.impacted_blocks)!=null?String(P(t).impacted_blocks):null}},{key:"ab_expected_blocks",label:"Expected Blocks",shared:!1,getValue:t=>{var e;return((e=P(t))==null?void 0:e.expected_blocks)!=null?String(P(t).expected_blocks):null}},{key:"b_block_id",label:"Block ID",shared:!1,getValue:t=>{var e;return((e=Z(t))==null?void 0:e.block_id)??null}},{key:"b_driver_name",label:"Driver Name",shared:!1,getValue:t=>{var e;return((e=Z(t))==null?void 0:e.driver_name)??null}},{key:"b_block_start",label:"Block Start",shared:!1,getValue:t=>{var e;return(e=Z(t))!=null&&e.block_start?fe(Z(t).block_start):null}},{key:"b_block_end",label:"Block End",shared:!1,getValue:t=>{var e;return(e=Z(t))!=null&&e.block_end?fe(Z(t).block_end):null}},{key:"b_rejection_datetime",label:"Rejection Time",shared:!1,getValue:t=>{var e;return(e=Z(t))!=null&&e.rejection_datetime?fe(Z(t).rejection_datetime):null}},{key:"b_rejection_bucket",label:"Bucket",shared:!1,getValue:t=>{var e;return(e=Z(t))!=null&&e.rejection_bucket?xe(Z(t).rejection_bucket):null}},{key:"l_load_id",label:"Load ID",shared:!1,getValue:t=>{var e;return((e=le(t))==null?void 0:e.load_id)??null}},{key:"l_driver_name",label:"Driver Name",shared:!1,getValue:t=>{var e;return((e=le(t))==null?void 0:e.driver_name)??null}},{key:"l_origin_yard_arrival",label:"Yard Arrival",shared:!1,getValue:t=>{var e;return(e=le(t))!=null&&e.origin_yard_arrival?fe(le(t).origin_yard_arrival):null}},{key:"l_rejection_bucket",label:"Bucket",shared:!1,getValue:t=>{var e;return(e=le(t))!=null&&e.rejection_bucket?xe(le(t).rejection_bucket):null}}],Be=Te({props:{col:String,rejection:Object},setup(t){return()=>{const e=ve.find(p=>p.key===t.col);if(!e)return z("span",{class:"text-muted-foreground"},"—");if(e.render)return e.render(t.rejection);const j=e.getValue(t.rejection);return j?z("span",{},j):z("span",{class:"text-muted-foreground"},"—")}}}),ye=A(()=>{const t=ae.value;return t.length?ve.filter(e=>e.shared?!0:t.some(j=>{const p=e.getValue(j);return p!==null&&p!==""&&p!=="—"})):ve.filter(e=>e.shared)}),we=A(()=>{let t=ye.value.length;return i.isSuperAdmin&&(t+=1),Q.value.includes("acceptance.delete")&&(t+=1),(Q.value.includes("acceptance.update")||Q.value.includes("acceptance.delete"))&&(t+=1),t}),ae=A(()=>[...i.rejections.data??[]].sort((e,j)=>{const p=ve.find(ft=>ft.key===ee.value),F=p?p.getValue(e)??"":"",y=p?p.getValue(j)??"":"";if(F==="—"||F==="")return 1;if(y==="—"||y==="")return-1;const ke=String(F).toLowerCase()<String(y).toLowerCase()?-1:String(F).toLowerCase()>String(y).toLowerCase()?1:0;return k.value==="asc"?ke:-ke}));function Fe(t){ee.value===t?k.value=k.value==="asc"?"desc":"asc":(ee.value=t,k.value="asc")}const Ne=A(()=>{var p,F;if(!R.value)return null;const t=R.value,e=me(t),j={id:t.id,tenant_id:t.tenant_id,date:t.date,disputed:t.disputed??"none",carrier_controllable:t.carrier_controllable,driver_controllable:t.driver_controllable,rejection_reason:t.rejection_reason??"",penalty:t.penalty,type:e};if(e==="advanced_block"){const y=P(t);return{...j,advance_block_rejection_id:(y==null?void 0:y.advance_block_rejection_id)??"",week_start:((p=y==null?void 0:y.week_start)==null?void 0:p.split(" ")[0])??"",week_end:((F=y==null?void 0:y.week_end)==null?void 0:F.split(" ")[0])??"",impacted_blocks:(y==null?void 0:y.impacted_blocks)??"",expected_blocks:(y==null?void 0:y.expected_blocks)??""}}if(e==="block"){const y=Z(t);return{...j,block_id:(y==null?void 0:y.block_id)??"",block_driver_name:(y==null?void 0:y.driver_name)??"",block_start:(y==null?void 0:y.block_start)??"",block_end:(y==null?void 0:y.block_end)??"",rejection_datetime:(y==null?void 0:y.rejection_datetime)??""}}if(e==="load"){const y=le(t);return{...j,load_id:(y==null?void 0:y.load_id)??"",load_driver_name:(y==null?void 0:y.driver_name)??"",origin_yard_arrival:(y==null?void 0:y.origin_yard_arrival)??"",load_rejection_bucket:(y==null?void 0:y.rejection_bucket)??""}}return j}),je=A(()=>!!v.value.search||!!v.value.rejectionType||!!v.value.rejectionBucket||!!v.value.disputed||!!v.value.carrierControllable||!!v.value.driverControllable||!!v.value.penaltyMin||!!v.value.penaltyMax||v.value.rejectionReasonFilter!=="with_reason");A(()=>{const t=v.value.rejectionType,e=[{value:"rejected_after_start_time",label:"After Start Time"},{value:"rejected_0_6_hours_before_start_time",label:"0–6 Hours Before"},{value:"rejected_6_plus_hours_before_start_time",label:"6+ Hours Before"}],j=[{value:"less_than_24",label:"Less Than 24 Hours Before"},{value:"more_than_24",label:"24+ Hours Before"}];return t==="load"?e:t==="block"?j:[...e,...j]}),ce(()=>v.value.rejectionType,()=>{v.value.rejectionBucket=""});function x(t){v.value.rejectionReasonFilter=t,c()}function c(t={}){const e=i.tenantSlug?"acceptance.index":"acceptance.index.admin",j=i.tenantSlug?{tenantSlug:i.tenantSlug}:{};return Me.get(route(e,j),{...v.value,perPage:C.value,dateFilter:w.value,...t},{preserveState:!0,preserveScroll:!0})}function Y(){c()}function K(t){w.value=t,c({dateFilter:t})}function ie(){c()}function T(){v.value={search:"",rejectionType:"",rejectionBucket:"",disputed:"",carrierControllable:"",driverControllable:"",penaltyMin:"",penaltyMax:"",rejectionReasonFilter:"with_reason"},c()}function G(t){if(!t)return;const e=new URL(t);c({page:e.searchParams.get("page")||1})}const ue=A(()=>{const{year:t,weekNumber:e,startWeekNumber:j,endWeekNumber:p}=i;return["yesterday","current-week"].includes(w.value)&&e&&t?`Week ${e}, ${t}`:["6w","quarterly"].includes(w.value)&&j&&p&&t?j>p?`Weeks ${j}–${p} (${t}–${t+1})`:`Weeks ${j}–${p}, ${t}`:""}),Q=A(()=>i.permissions.map(t=>t.name));function Oe(t=null){R.value=t,h.value=!0}function et(){h.value=!1,U.value=R.value?"Rejection updated successfully.":"Rejection created successfully."}function tt(t){E.value=t,s.value=!0}function lt(t){const e=Ie({}),j=i.isSuperAdmin?"acceptance.destroy.admin":"acceptance.destroy",p=i.isSuperAdmin?{rejection:t}:{tenantSlug:i.tenantSlug,rejection:t};e.delete(route(j,p),{preserveScroll:!0,onSuccess:()=>{U.value="Rejection deleted successfully.",s.value=!1}})}const at=A(()=>ae.value.length>0&&D.value.length===ae.value.length);function rt(t){D.value=t.target.checked?ae.value.map(e=>e.id):[]}function nt(){D.value.length>0&&($.value=!0)}function ot(){const t=Ie({ids:D.value}),e=i.isSuperAdmin?"acceptance.destroyBulk.admin":"acceptance.destroyBulk",j=i.isSuperAdmin?{}:{tenantSlug:i.tenantSlug};t.delete(route(e,j),{preserveScroll:!0,onSuccess:()=>{U.value=`${D.value.length} records deleted.`,D.value=[],$.value=!1}})}function st(t){U.value=t}function it(t){I.value=t}const ut=A(()=>i.tenantSlug?route("acceptance.export",{tenantSlug:i.tenantSlug}):route("acceptance.export.admin"));function dt(){if(!ae.value.length){I.value="No data to export.";return}d.value&&d.value.submit()}const ct=A(()=>{var e;const t=(e=i.rejection_breakdown)==null?void 0:e.by_category;return t?{totalRejections:t.total_rejections??0,afterStartCount:t.after_start_count??0,moreThan24Count:t.more_than_24_count??0,within24Count:t.within_24_count??0,advancedRejectionCount:t.advanced_rejection_count??0,moreThan6Count:t.more_than_6_count??0,within6Count:t.within_6_count??0}:null}),mt=A(()=>{var e,j,p,F,y,ke;const t=v.value.rejectionType;return t==="load"?((j=(e=i.rejection_breakdown)==null?void 0:e.bottom_five_drivers)==null?void 0:j.load)??[]:t==="block"?((F=(p=i.rejection_breakdown)==null?void 0:p.bottom_five_drivers)==null?void 0:F.block)??[]:((ke=(y=i.rejection_breakdown)==null?void 0:y.bottom_five_drivers)==null?void 0:ke.total)??[]}),pt=A(()=>{var t;return(t=i.line_chart_data)!=null&&t.length?{labels:i.line_chart_data.map(e=>e.date),datasets:[{label:"Acceptance Performance",data:i.line_chart_data.map(e=>e.acceptancePerformance),borderColor:"#3b82f6",backgroundColor:"rgba(59,130,246,0.1)",tension:.3}]}:{labels:[],datasets:[]}});return ce(U,t=>{t&&setTimeout(()=>{U.value=""},5e3)}),ce(I,t=>{t&&setTimeout(()=>{I.value=""},5e3)}),Je(()=>{const t=e=>e.preventDefault();window.addEventListener("dragover",t),window.addEventListener("drop",t),_t(()=>{window.removeEventListener("dragover",t),window.removeEventListener("drop",t)})}),(t,e)=>(u(),V(ht,{breadcrumbs:ne,tenantSlug:S.tenantSlug,permissions:i.permissions},{default:n(()=>{var j;return[r(a(kt),{title:"Acceptance"}),l("div",ua,[U.value?(u(),V(a(Ve),{key:0,variant:"success"},{default:n(()=>[r(a(Re),null,{default:n(()=>e[31]||(e[31]=[m("Success")])),_:1}),r(a(Ae),null,{default:n(()=>[m(g(U.value),1)]),_:1})]),_:1})):_("",!0),I.value?(u(),V(a(Ve),{key:1,variant:"destructive"},{default:n(()=>[r(a(Re),null,{default:n(()=>e[32]||(e[32]=[m("Error")])),_:1}),r(a(Ae),null,{default:n(()=>[m(g(I.value),1)]),_:1})]),_:1})):_("",!0),l("div",da,[e[36]||(e[36]=l("h1",{class:"text-lg font-bold text-gray-800 dark:text-gray-200 md:text-xl lg:text-2xl"}," Acceptance ",-1)),l("div",ca,[Q.value.includes("acceptance.create")?(u(),V(L,{key:0,class:"px-2 py-0 md:px-4 md:py-2",onClick:e[0]||(e[0]=p=>Oe()),variant:"default"},{default:n(()=>[r(W,{name:"plus",class:"mr-1 h-4 w-4 md:mr-2"}),e[33]||(e[33]=m(" Add Rejection "))]),_:1})):_("",!0),D.value.length>0&&Q.value.includes("acceptance.delete")?(u(),V(L,{key:1,class:"px-2 py-0 md:px-4 md:py-2",onClick:e[1]||(e[1]=p=>nt()),variant:"destructive"},{default:n(()=>[r(W,{name:"trash",class:"mr-1 h-4 w-4 md:mr-2"}),m(" Delete Selected ("+g(D.value.length)+") ",1)]),_:1})):_("",!0),Q.value.includes("acceptance.import")?(u(),V(L,{key:2,variant:"secondary",class:"px-2 py-0 md:px-4 md:py-2 shadow-sm hover:shadow transition-all",onClick:e[2]||(e[2]=p=>b.value=!0)},{default:n(()=>[r(W,{name:"upload",class:"mr-1 h-4 w-4 md:mr-2"}),e[34]||(e[34]=m(" Import CSV "))]),_:1})):_("",!0),Q.value.includes("acceptance.export")?(u(),V(L,{key:3,class:"px-2 py-0 md:px-4 md:py-2",onClick:be(dt,["prevent"]),variant:"outline"},{default:n(()=>[r(W,{name:"download",class:"mr-1 h-4 w-4 md:mr-2"}),e[35]||(e[35]=m(" Download CSV "))]),_:1})):_("",!0)])]),l("form",{ref_key:"exportForm",ref:d,action:ut.value,method:"GET",class:"hidden"},null,8,ma),r(a(ge),null,{default:n(()=>[r(a(_e),{class:"p-2 md:p-4 lg:p-6"},{default:n(()=>[l("div",pa,[l("div",fa,[r(L,{onClick:e[3]||(e[3]=p=>K("yesterday")),variant:"outline",size:"sm",class:X({"border-primary bg-primary/10 text-primary":w.value==="yesterday"})},{default:n(()=>e[37]||(e[37]=[m(" Yesterday ")])),_:1},8,["class"]),r(L,{onClick:e[4]||(e[4]=p=>K("current-week")),variant:"outline",size:"sm",class:X({"border-primary bg-primary/10 text-primary":w.value==="current-week"})},{default:n(()=>e[38]||(e[38]=[m(" WTD ")])),_:1},8,["class"]),r(L,{onClick:e[5]||(e[5]=p=>K("6w")),variant:"outline",size:"sm",class:X({"border-primary bg-primary/10 text-primary":w.value==="6w"})},{default:n(()=>e[39]||(e[39]=[m(" T6W ")])),_:1},8,["class"]),r(L,{onClick:e[6]||(e[6]=p=>K("quarterly")),variant:"outline",size:"sm",class:X({"border-primary bg-primary/10 text-primary":w.value==="quarterly"})},{default:n(()=>e[40]||(e[40]=[m(" Quarterly ")])),_:1},8,["class"])]),i.dateRange?(u(),f("div",va,[w.value==="yesterday"&&i.dateRange.start?(u(),f("span",ba," Showing data from "+g(se(i.dateRange.start)),1)):i.dateRange.start&&i.dateRange.end?(u(),f("span",ga," Showing data from "+g(se(i.dateRange.start))+" to "+g(se(i.dateRange.end)),1)):(u(),f("span",_a,g(i.dateRange.label),1)),ue.value?(u(),f("span",xa,"("+g(ue.value)+")",1)):_("",!0)])):_("",!0)])]),_:1})]),_:1}),r(a(ge),{class:"mb-6"},{default:n(()=>[r(a(jt),{class:"p-2 md:p-4 lg:p-6"},{default:n(()=>[l("div",ya,[l("div",ka,[r(a(St),{class:"text-lg md:text-xl lg:text-2xl"},{default:n(()=>e[41]||(e[41]=[m("Filters")])),_:1}),l("div",wa,[l("button",{onClick:e[7]||(e[7]=p=>x("with_reason")),class:X(["rounded-md px-3 py-1 text-xs font-medium transition-all",v.value.rejectionReasonFilter==="with_reason"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"])}," Rejected ",2),l("button",{onClick:e[8]||(e[8]=p=>x("without_reason")),class:X(["rounded-md px-3 py-1 text-xs font-medium transition-all",v.value.rejectionReasonFilter==="without_reason"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"])}," Accepted ",2),l("button",{onClick:e[9]||(e[9]=p=>x("all")),class:X(["rounded-md px-3 py-1 text-xs font-medium transition-all",v.value.rejectionReasonFilter==="all"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"])}," All ",2)]),!o.value&&je.value?(u(),f("div",ja,[v.value.search?(u(),f("span",Sa," Search: "+g(v.value.search),1)):_("",!0),v.value.rejectionType?(u(),f("span",ha," Type: "+g(pe(v.value.rejectionType)),1)):_("",!0),v.value.rejectionBucket?(u(),f("span",Ca," Bucket: "+g(xe(v.value.rejectionBucket)),1)):_("",!0),v.value.disputed?(u(),f("span",$a," Disputed: "+g(v.value.disputed),1)):_("",!0),v.value.carrierControllable?(u(),f("span",Da," Carrier: "+g(v.value.carrierControllable==="true"?"Yes":"No"),1)):_("",!0),v.value.driverControllable?(u(),f("span",Va," Driver: "+g(v.value.driverControllable==="true"?"Yes":"No"),1)):_("",!0),v.value.penaltyMin||v.value.penaltyMax?(u(),f("span",Ra," Penalty: "+g(v.value.penaltyMin||"0")+" – "+g(v.value.penaltyMax||"∞"),1)):_("",!0)])):_("",!0)]),r(L,{variant:"ghost",size:"sm",onClick:e[10]||(e[10]=p=>o.value=!o.value)},{default:n(()=>[m(g(o.value?"Hide Filters":"Show Filters")+" ",1),r(W,{name:o.value?"chevron-up":"chevron-down",class:"ml-2 h-4 w-4"},null,8,["name"])]),_:1})])]),_:1}),o.value?(u(),V(a(_e),{key:0,class:"p-2 md:p-4 lg:p-6"},{default:n(()=>[l("div",Aa,[l("div",Ta,[l("div",null,[r(a(B),{for:"search"},{default:n(()=>e[42]||(e[42]=[m("Search")])),_:1}),r(a(H),{class:"h-9 w-full lg:h-10",id:"search",modelValue:v.value.search,"onUpdate:modelValue":e[11]||(e[11]=p=>v.value.search=p),type:"text",placeholder:"Driver name, Block ID, Load ID..."},null,8,["modelValue"])]),l("div",null,[r(a(B),{for:"rejectionType"},{default:n(()=>e[43]||(e[43]=[m("Rejection Type")])),_:1}),J(l("select",{id:"rejectionType","onUpdate:modelValue":e[12]||(e[12]=p=>v.value.rejectionType=p),class:"select-base",onChange:e[13]||(e[13]=p=>v.value.rejectionBucket="")},e[44]||(e[44]=[l("option",{value:""},"All Types",-1),l("option",{value:"advanced_block"},"Advanced Block",-1),l("option",{value:"block"},"Block",-1),l("option",{value:"load"},"Load",-1)]),544),[[te,v.value.rejectionType]])]),l("div",null,[r(a(B),{for:"rejectionBucket"},{default:n(()=>e[45]||(e[45]=[m("Rejection Bucket")])),_:1}),J(l("select",{id:"rejectionBucket","onUpdate:modelValue":e[14]||(e[14]=p=>v.value.rejectionBucket=p),class:"select-base"},[e[51]||(e[51]=l("option",{value:""},"All Buckets",-1)),v.value.rejectionType==="load"||v.value.rejectionType===""?(u(),f(M,{key:0},[e[46]||(e[46]=l("option",{value:"rejected_after_start_time"},"After Start Time",-1)),e[47]||(e[47]=l("option",{value:"rejected_0_6_hours_before_start_time"}," 0–6 Hours Before ",-1)),e[48]||(e[48]=l("option",{value:"rejected_6_plus_hours_before_start_time"}," 6+ Hours Before ",-1))],64)):_("",!0),v.value.rejectionType==="block"||v.value.rejectionType===""?(u(),f(M,{key:1},[e[49]||(e[49]=l("option",{value:"less_than_24"},"Less Than 24 Hours Before",-1)),e[50]||(e[50]=l("option",{value:"more_than_24"},"24+ Hours Before",-1))],64)):_("",!0)],512),[[te,v.value.rejectionBucket]])])]),l("div",Ba,[l("div",null,[r(a(B),{for:"disputed"},{default:n(()=>e[52]||(e[52]=[m("Disputed")])),_:1}),J(l("select",{id:"disputed","onUpdate:modelValue":e[15]||(e[15]=p=>v.value.disputed=p),class:"select-base"},e[53]||(e[53]=[l("option",{value:""},"All",-1),l("option",{value:"none"},"None",-1),l("option",{value:"pending"},"Pending",-1),l("option",{value:"won"},"Won",-1),l("option",{value:"lost"},"Lost",-1)]),512),[[te,v.value.disputed]])]),l("div",null,[r(a(B),{for:"carrierControllable"},{default:n(()=>e[54]||(e[54]=[m("Carrier Controllable")])),_:1}),J(l("select",{id:"carrierControllable","onUpdate:modelValue":e[16]||(e[16]=p=>v.value.carrierControllable=p),class:"select-base"},e[55]||(e[55]=[l("option",{value:""},"All",-1),l("option",{value:"true"},"Yes",-1),l("option",{value:"false"},"No",-1)]),512),[[te,v.value.carrierControllable]])]),l("div",null,[r(a(B),{for:"driverControllable"},{default:n(()=>e[56]||(e[56]=[m("Driver Controllable")])),_:1}),J(l("select",{id:"driverControllable","onUpdate:modelValue":e[17]||(e[17]=p=>v.value.driverControllable=p),class:"select-base"},e[57]||(e[57]=[l("option",{value:""},"All",-1),l("option",{value:"true"},"Yes",-1),l("option",{value:"false"},"No",-1)]),512),[[te,v.value.driverControllable]])])]),l("div",Fa,[l("div",null,[r(a(B),{for:"penaltyMin"},{default:n(()=>e[58]||(e[58]=[m("Penalty Min")])),_:1}),r(a(H),{class:"h-9 w-full lg:h-10",id:"penaltyMin",modelValue:v.value.penaltyMin,"onUpdate:modelValue":e[18]||(e[18]=p=>v.value.penaltyMin=p),type:"number",min:"0",placeholder:"e.g. 0"},null,8,["modelValue"])]),l("div",null,[r(a(B),{for:"penaltyMax"},{default:n(()=>e[59]||(e[59]=[m("Penalty Max")])),_:1}),r(a(H),{class:"h-9 w-full lg:h-10",id:"penaltyMax",modelValue:v.value.penaltyMax,"onUpdate:modelValue":e[19]||(e[19]=p=>v.value.penaltyMax=p),type:"number",min:"0",placeholder:"e.g. 100"},null,8,["modelValue"])])]),l("div",Na,[r(L,{onClick:T,variant:"ghost",size:"sm"},{default:n(()=>[r(W,{name:"rotate_ccw",class:"mr-2 h-4 w-4"}),e[60]||(e[60]=m(" Reset Filters "))]),_:1}),r(L,{onClick:Y,variant:"default",size:"sm"},{default:n(()=>[r(W,{name:"filter",class:"mr-2 h-4 w-4"}),e[61]||(e[61]=m(" Apply Filters "))]),_:1})])])]),_:1})):_("",!0)]),_:1}),i.isSuperAdmin?_("",!0):(u(),V(qt,{key:2,metricsData:ct.value||{},driversData:mt.value||[],chartData:pt.value||{},averageAcceptance:i.average_acceptance||null,currentDateFilter:((j=i.dateRange)==null?void 0:j.label)||"",currentFilters:v.value||{}},null,8,["metricsData","driversData","chartData","averageAcceptance","currentDateFilter","currentFilters"])),r(a(ge),{class:"mx-auto max-w-[95vw] overflow-x-auto md:max-w-[64vw] lg:max-w-full"},{default:n(()=>[r(a(_e),{class:"p-0"},{default:n(()=>[l("div",Ma,[r(a(Le),{class:"relative h-[500px] overflow-auto"},{default:n(()=>[r(a(Ue),null,{default:n(()=>[r(a(de),{class:"sticky top-0 z-10 border-b bg-background hover:bg-background"},{default:n(()=>[Q.value.includes("acceptance.delete")?(u(),V(a(oe),{key:0,class:"w-[50px]"},{default:n(()=>[l("div",Ia,[l("input",{type:"checkbox",onChange:rt,checked:at.value,class:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"},null,40,La)])]),_:1})):_("",!0),i.isSuperAdmin?(u(),V(a(oe),{key:1,class:"whitespace-nowrap"},{default:n(()=>e[62]||(e[62]=[m("Company")])),_:1})):_("",!0),(u(!0),f(M,null,q(ye.value,p=>(u(),V(a(oe),{key:p.key,class:"cursor-pointer whitespace-nowrap",onClick:F=>Fe(p.key)},{default:n(()=>[l("div",Ua,[m(g(p.label)+" ",1),ee.value===p.key?(u(),f("span",Ea,[k.value==="asc"?(u(),f("svg",Pa,e[63]||(e[63]=[l("path",{d:"M8 15l4-4 4 4"},null,-1)]))):(u(),f("svg",Oa,e[64]||(e[64]=[l("path",{d:"M16 9l-4 4-4-4"},null,-1)])))])):(u(),f("span",Wa,e[65]||(e[65]=[l("svg",{class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[l("path",{d:"M8 10l4-4 4 4"}),l("path",{d:"M16 14l-4 4-4-4"})],-1)])))])]),_:2},1032,["onClick"]))),128)),Q.value.includes("acceptance.update")||Q.value.includes("acceptance.delete")?(u(),V(a(oe),{key:2},{default:n(()=>e[66]||(e[66]=[m(" Actions ")])),_:1})):_("",!0)]),_:1})]),_:1}),r(a(Ee),null,{default:n(()=>[ae.value.length===0?(u(),V(a(de),{key:0},{default:n(()=>[r(a(re),{colspan:we.value,class:"py-8 text-center text-primary font-medium"},{default:n(()=>e[67]||(e[67]=[m(" No rejections found matching your criteria ")])),_:1},8,["colspan"])]),_:1})):_("",!0),(u(!0),f(M,null,q(ae.value,p=>(u(),V(a(de),{key:p.id,class:"hover:bg-muted/50"},{default:n(()=>[Q.value.includes("acceptance.delete")?(u(),V(a(re),{key:0,class:"text-center"},{default:n(()=>[J(l("input",{type:"checkbox",value:p.id,"onUpdate:modelValue":e[20]||(e[20]=F=>D.value=F),class:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"},null,8,Ha),[[xt,D.value]])]),_:2},1024)):_("",!0),i.isSuperAdmin?(u(),V(a(re),{key:1,class:"whitespace-nowrap"},{default:n(()=>{var F;return[m(g(((F=p.tenant)==null?void 0:F.name)||"—"),1)]}),_:2},1024)):_("",!0),(u(!0),f(M,null,q(ye.value,F=>(u(),V(a(re),{key:F.key,class:"whitespace-nowrap text-sm"},{default:n(()=>[r(a(Be),{col:F.key,rejection:p},null,8,["col","rejection"])]),_:2},1024))),128)),Q.value.includes("acceptance.delete")||Q.value.includes("acceptance.update")?(u(),V(a(re),{key:2},{default:n(()=>[l("div",Ya,[Q.value.includes("acceptance.update")?(u(),V(L,{key:0,size:"sm",onClick:F=>Oe(p),variant:"warning"},{default:n(()=>[r(W,{name:"pencil",class:"mr-1 h-4 w-4"}),e[68]||(e[68]=m(" Edit "))]),_:2},1032,["onClick"])):_("",!0),Q.value.includes("acceptance.delete")?(u(),V(L,{key:1,size:"sm",variant:"destructive",onClick:F=>tt(p.id)},{default:n(()=>[r(W,{name:"trash",class:"mr-1 h-4 w-4"}),e[69]||(e[69]=m(" Delete "))]),_:2},1032,["onClick"])):_("",!0)])]),_:2},1024)):_("",!0)]),_:2},1024))),128))]),_:1})]),_:1})]),i.rejections.links?(u(),f("div",za,[l("div",qa,[l("div",Ga,[l("span",null," Showing "+g(i.rejections.data.length)+" of "+g(i.rejections.total)+" entries ",1),l("div",Ka,[e[70]||(e[70]=l("span",{class:"text-sm"},"Show:",-1)),J(l("select",{"onUpdate:modelValue":e[21]||(e[21]=p=>C.value=p),onChange:ie,class:"h-8 rounded-md border border-input bg-background px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-ring"},[(u(),f(M,null,q([10,25,50,100],p=>l("option",{key:p,value:p},g(p),9,Qa)),64))],544),[[te,C.value]])])]),l("div",Xa,[(u(!0),f(M,null,q(i.rejections.links,p=>(u(),V(L,{key:p.label,onClick:F=>G(p.url),disabled:!p.url,variant:"ghost",size:"sm",class:X(["mx-1",{"border-primary bg-primary/10 text-primary":p.active}])},{default:n(()=>[l("span",{innerHTML:p.label},null,8,Za)]),_:2},1032,["onClick","disabled","class"]))),128))])])])):_("",!0)]),_:1})]),_:1}),r(a(Se),{open:h.value,"onUpdate:open":e[23]||(e[23]=p=>h.value=p)},{default:n(()=>[r(a(Ce),{class:"max-w-[95vw] sm:max-w-[90vw] md:max-w-4xl"},{default:n(()=>[r(a($e),{class:"px-4 sm:px-6"},{default:n(()=>[r(a(De),{class:"text-lg sm:text-xl"},{default:n(()=>[m(g(R.value?"Edit":"Add")+" Rejection ",1)]),_:1}),r(a(he),{class:"text-xs sm:text-sm"},{default:n(()=>[m(" Fill in the details to "+g(R.value?"update":"add")+" a rejection. ",1)]),_:1})]),_:1}),r(ia,{rejection:Ne.value,tenants:i.tenants,"is-super-admin":i.isSuperAdmin,"tenant-slug":i.tenantSlug,onClose:e[22]||(e[22]=p=>h.value=!1),onSuccess:et,class:"max-h-[75vh] overflow-y-auto p-4 sm:p-6"},null,8,["rejection","tenants","is-super-admin","tenant-slug"])]),_:1})]),_:1},8,["open"]),r(a(Se),{open:$.value,"onUpdate:open":e[26]||(e[26]=p=>$.value=p)},{default:n(()=>[r(a(Ce),{class:"max-w-[95vw] sm:max-w-md"},{default:n(()=>[r(a($e),{class:"px-4 sm:px-6"},{default:n(()=>[r(a(De),{class:"text-lg sm:text-xl"},{default:n(()=>e[71]||(e[71]=[m("Confirm Bulk Deletion")])),_:1}),r(a(he),{class:"text-xs sm:text-sm"},{default:n(()=>[m(" Are you sure you want to delete "+g(D.value.length)+" rejection records? This action cannot be undone. ",1)]),_:1})]),_:1}),r(a(Ze),{class:"px-4 sm:px-6"},{default:n(()=>[r(L,{type:"button",onClick:e[24]||(e[24]=p=>$.value=!1),variant:"outline"},{default:n(()=>e[72]||(e[72]=[m("Cancel")])),_:1}),r(L,{type:"button",onClick:e[25]||(e[25]=p=>ot()),variant:"destructive"},{default:n(()=>e[73]||(e[73]=[m("Delete Selected")])),_:1})]),_:1})]),_:1})]),_:1},8,["open"]),r(a(Se),{open:s.value,"onUpdate:open":e[29]||(e[29]=p=>s.value=p)},{default:n(()=>[r(a(Ce),{class:"max-w-[95vw] sm:max-w-md"},{default:n(()=>[r(a($e),{class:"px-4 sm:px-6"},{default:n(()=>[r(a(De),{class:"text-lg sm:text-xl"},{default:n(()=>e[74]||(e[74]=[m("Confirm Deletion")])),_:1}),r(a(he),{class:"text-xs sm:text-sm"},{default:n(()=>e[75]||(e[75]=[m(" Are you sure you want to delete this rejection record? This action cannot be undone. ")])),_:1})]),_:1}),r(a(Ze),{class:"px-4 sm:px-6"},{default:n(()=>[r(L,{type:"button",onClick:e[27]||(e[27]=p=>s.value=!1),variant:"outline"},{default:n(()=>e[76]||(e[76]=[m("Cancel")])),_:1}),r(L,{type:"button",onClick:e[28]||(e[28]=p=>lt(E.value)),variant:"destructive"},{default:n(()=>e[77]||(e[77]=[m("Delete")])),_:1})]),_:1})]),_:1})]),_:1},8,["open"]),r(Xl,{open:b.value,"onUpdate:open":e[30]||(e[30]=p=>b.value=p),"is-super-admin":i.isSuperAdmin,"tenant-slug":i.tenantSlug,tenants:i.tenants,onSuccess:st,onError:it},null,8,["open","is-super-admin","tenant-slug","tenants"])])]}),_:1},8,["tenantSlug","permissions"]))}},hr=Pe(Ja,[["__scopeId","data-v-cc925a24"]]);export{hr as default};
