import{g as Y,W as Z}from"./vendor-vue-C6le94gM.js";import{_ as X}from"./AppLayout.vue_vue_type_script_setup_true_lang-Bx6WXffK.js";import{_ as N}from"./Icon.vue_vue_type_script_setup_true_lang-g5QrAIpa.js";import{_ as F}from"./Badge.vue_vue_type_script_setup_true_lang-BpieHD20.js";import{d as W,c as C,L as R,e as m,X as e,U as n,b2 as A,r as O,k as V,M as z,N as E,l as i,f as d,S as b,u as c,i as J,w as K,b as S,D as ee,Y as te,A as ae}from"./vendor-cgn9wV4E.js";import{_ as se,a as re,b as Q,c as q,d as ne,e as I}from"./TableRow.vue_vue_type_script_setup_true_lang-58J5Q7id.js";import{_ as U}from"./Button.vue_vue_type_script_setup_true_lang-DA-5a5tM.js";import{_ as oe}from"./Card.vue_vue_type_script_setup_true_lang-DQTQMX6v.js";import{_ as ie}from"./CardHeader.vue_vue_type_script_setup_true_lang-n-Rvhb9V.js";import{_ as le}from"./CardTitle.vue_vue_type_script_setup_true_lang-AShXP1uR.js";import{_ as ce}from"./CardContent.vue_vue_type_script_setup_true_lang-DNXZ8J1r.js";import{_ as de}from"./Input.vue_vue_type_script_setup_true_lang-1zH_gJ02.js";import{c as ue}from"./utils-C4uCeQPu.js";import"./vendor-axios-C0Zqfgkc.js";import"./vendor-ui-BuPyOEYe.js";import"./useInitials-DzeGKvtI.js";import"./app-BwOLsRrX.js";import"./vendor-icons-Bu7C1ObZ.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BM02NuXb.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const me={class:"mb-6"},fe=W({__name:"DashboardHeader",props:{operationalExcellenceScore:{type:String,default:"Not Available"}},setup(a){const f=a,u=C(()=>{switch(f.operationalExcellenceScore){case"Fantastic +":return"text-green-600";case"Fantastic":return"text-emerald-600";case"Good":return"text-blue-600";case"Fair":return"text-amber-600";case"Poor":return"text-red-600";default:return"text-gray-600"}});return(y,p)=>(m(),R("div",me,[e("h2",{class:A(["text-4xl font-bold tracking-tight",[u.value,"transition-colors duration-300"]])},n(a.operationalExcellenceScore),3)]))}}),ve={class:"mb-6"},ge={class:"border-b"},pe={class:"flex -mb-px space-x-8"},xe=["onClick"],be={key:0,class:"mt-2 text-sm text-muted-foreground"},ye={key:0,class:"ml-1"},_e=W({__name:"TimePeriodTabs",props:{dateRangeText:{type:String,default:""},weekNumber:{type:Number,default:null},startWeekNumber:{type:Number,default:null},endWeekNumber:{type:Number,default:null},year:{type:Number,default:null},activeTabId:{type:String,default:"yesterday"}},emits:["tab-change"],setup(a,{emit:f}){const u=a,y=[{id:"yesterday",label:"Yesterday"},{id:"current-week",label:"WTD"},{id:"t6w",label:"T6W Scores"},{id:"quarterly",label:"Quarterly Scores"}],p=O(u.activeTabId),w=f,v=C(()=>(p.value==="yesterday"||p.value==="current-week")&&u.weekNumber&&u.year?`Week ${u.weekNumber}, ${u.year}`:(p.value==="t6w"||p.value==="quarterly")&&u.startWeekNumber&&u.endWeekNumber&&u.year?`Weeks ${u.startWeekNumber}-${u.endWeekNumber}, ${u.year}`:""),x=T=>{p.value=T,w("tab-change",T)};return(T,_)=>(m(),R("div",ve,[e("div",ge,[e("div",pe,[(m(),R(z,null,E(y,j=>e("button",{key:j.id,onClick:k=>x(j.id),class:A(["py-2 px-1 border-b-2 text-sm font-medium transition-colors",p.value===j.id?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-foreground hover:border-muted-foreground"])},n(j.label),11,xe)),64))])]),a.dateRangeText?(m(),R("div",be,[e("span",null,n(a.dateRangeText),1),v.value?(m(),R("span",ye,"("+n(v.value)+")",1)):V("",!0)])):V("",!0)]))}}),we={class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-6 mb-6"},he={class:"bg-card rounded-lg border shadow-sm p-4"},De={class:"flex items-center justify-between gap-3 mb-4"},ke={class:"space-y-2 text-sm max-h-40 overflow-y-auto"},$e={class:"bg-card rounded-lg border shadow-sm p-4"},Ne={class:"flex items-center justify-between gap-3 mb-4"},Se={class:"space-y-2 text-sm max-h-40 overflow-y-auto"},Re={class:"bg-card rounded-lg border shadow-sm p-4"},je={class:"flex items-center justify-between gap-3 mb-4"},Ce={class:"text-sm mb-2 space-y-2"},Te={class:"flex justify-between"},Be={class:"flex justify-between"},Fe={class:"flex justify-between"},Pe={class:"flex justify-between"},Ae={class:"bg-card rounded-lg border shadow-sm p-4"},Me={class:"flex items-center justify-between gap-3 mb-4"},Oe={class:"space-y-2 text-sm"},Ve={class:"flex justify-between items-center"},We={class:"flex items-center gap-2"},Ie={class:"w-12 text-right"},ze={class:"w-16 text-right"},Ee={class:"flex justify-between items-center"},Ge={class:"flex items-center gap-2"},Le={class:"w-12 text-right"},qe={class:"w-16 text-right"},Ue={class:"flex justify-between items-center"},He={class:"flex items-center gap-2"},Ke={class:"w-12 text-right"},Qe={class:"w-16 text-right"},Ye={class:"flex justify-between items-center"},Ze={class:"flex items-center gap-2"},Xe={class:"w-12 text-right"},Je={class:"w-16 text-right"},et={class:"flex justify-between items-center"},tt={class:"flex items-center gap-2"},at={class:"w-12 text-right"},st={class:"w-16 text-right"},rt={class:"flex justify-between items-center"},nt={class:"flex items-center gap-2"},ot={class:"w-12 text-right"},it={class:"w-16 text-right"},lt={class:"text-sm text-muted-foreground mt-3"},ct=W({__name:"PerformanceCards",props:{performanceData:{type:Object,default:()=>({})},performanceRatings:{type:Object,default:()=>({})},safetyData:{type:Object,default:()=>({})},delayBreakdowns:{type:Array,default:()=>[]},rejectionBreakdowns:{type:Array,default:()=>[]},maintenanceBreakdowns:{type:Object,default:()=>({})}},setup(a){const f=a,u=C(()=>[...f.delayBreakdowns].sort((t,s)=>s.total_delays-t.total_delays).slice(0,3)),y=C(()=>[...f.rejectionBreakdowns].sort((t,s)=>s.total_rejections-t.total_rejections).slice(0,3)),p=(t,s=0)=>{if(t==null||t==="")return"0%";const $=Number(t);return Number.isFinite($)?`${$.toFixed(s)}%`:"0%"},w=t=>(typeof t=="string"&&(t=parseFloat(t)),t==null||isNaN(t)?"0":Math.round(t).toString()),v=t=>(typeof t=="string"&&(t=parseFloat(t)),t==null||isNaN(t)?"0.00":t.toFixed(2)),x=t=>(typeof t=="string"&&(t=parseFloat(t)),t==null||isNaN(t)?"0.00":t.toFixed(2)),T=t=>{if(!t)return"Not Available";switch(t){case"gold":return"Gold Tier";case"silver":return"Silver Tier";case"not_eligible":return"Not Eligible";case"fantastic_plus":return"Fantastic +";case"fantastic":return"Fantastic";case"good":return"Good";case"fair":return"Fair";case"poor":return"Poor";default:return t}},_=t=>{if(!t)return"outline";switch(t){case"gold":return"gold";case"silver":return"silver";case"not_eligible":return"not-eligible";case"fantastic_plus":return"fantastic-plus";case"fantastic":return"fantastic";case"good":return"good";case"fair":return"fair";case"poor":return"poor";default:return"outline"}},j=t=>t?t==="Gold Tier"?"gold":t==="Silver Tier"?"silver":t==="Not Eligible"?"not-eligible":"outline":"outline",k=C(()=>{var g;if(!((g=f.safetyData)!=null&&g.ratings))return null;const t=f.safetyData.ratings,s={gold:3,silver:2,not_eligible:1},$=["traffic_light_violation","speeding_violations","following_distance","driver_distraction","sign_violations","roadside_parking"];let h="gold";for(const l of $)t[l]&&s[t[l]]<s[h]&&(h=t[l]);switch(h){case"gold":return"Gold Tier";case"silver":return"Silver Tier";case"not_eligible":return"Not Eligible";default:return"Not Available"}}),P=t=>{if(!t)return"text-gray-600";switch(t){case"gold":return"text-amber-600";case"silver":return"text-slate-600";case"not_eligible":return"text-red-600";case"fantastic_plus":return"text-green-600";case"fantastic":return"text-emerald-600";case"good":return"text-blue-600";case"fair":return"text-amber-600";case"poor":return"text-red-600";default:return"text-indigo-600"}},G=t=>t>=900?"text-green-600":t>=750?"text-emerald-600":t>=600?"text-blue-600":"text-red-600";return(t,s)=>{var $,h,g,l,r,o;return m(),R("div",we,[e("div",he,[s[0]||(s[0]=e("h3",{class:"text-base font-semibold mb-1"},"Acceptance",-1)),s[1]||(s[1]=e("div",{class:"text-xs text-muted-foreground mb-1"},"Total Score",-1)),e("div",De,[e("div",{class:A(["text-4xl font-bold",P(a.performanceRatings.average_acceptance)])},n(p(a.performanceData.average_acceptance)),3),i(c(F),{variant:_(a.performanceRatings.average_acceptance),class:"text-xs"},{default:d(()=>[b(n(T(a.performanceRatings.average_acceptance)),1)]),_:1},8,["variant"])]),s[2]||(s[2]=e("div",{class:"text-sm mb-2 flex justify-between"},[e("span",{class:"font-semibold"},"Rejections by Reason"),e("span",{class:"font-semibold"},"Total")],-1)),e("div",ke,[(m(!0),R(z,null,E(y.value,(D,M)=>(m(),R("div",{key:M,class:"flex justify-between"},[e("span",null,n(D.reason_code),1),e("span",null,n(D.total_rejections),1)]))),128))])]),e("div",$e,[s[3]||(s[3]=e("h3",{class:"text-base font-semibold mb-1"},"On-Time",-1)),s[4]||(s[4]=e("div",{class:"text-xs text-muted-foreground mb-1"},"Total Score",-1)),e("div",Ne,[e("div",{class:A(["text-4xl font-bold",P(a.performanceRatings.average_on_time)])},n(p(a.performanceData.average_on_time)),3),i(c(F),{variant:_(a.performanceRatings.average_on_time),class:"text-xs"},{default:d(()=>[b(n(T(a.performanceRatings.average_on_time)),1)]),_:1},8,["variant"])]),s[5]||(s[5]=e("div",{class:"text-sm mb-2 flex justify-between"},[e("span",{class:"font-semibold"},"Delays by Reason"),e("span",{class:"font-semibold"},"Total")],-1)),e("div",Se,[(m(!0),R(z,null,E(u.value,(D,M)=>(m(),R("div",{key:M,class:"flex justify-between"},[e("span",null,n(D.code),1),e("span",null,n(D.total_delays),1)]))),128))])]),e("div",Re,[s[10]||(s[10]=e("h3",{class:"text-base font-semibold mb-1"},"Maintenance",-1)),s[11]||(s[11]=e("div",{class:"text-xs text-muted-foreground mb-1"},"MVtS Score",-1)),e("div",je,[e("div",{class:A(["text-4xl font-bold",P(a.performanceRatings.average_maintenance_variance_to_spend)])},n(p(a.performanceData.average_maintenance_variance_to_spend,1)),3),i(c(F),{variant:_(a.performanceRatings.average_maintenance_variance_to_spend),class:"text-xs"},{default:d(()=>[b(n(T(a.performanceRatings.average_maintenance_variance_to_spend)),1)]),_:1},8,["variant"])]),e("div",Ce,[e("div",Te,[s[6]||(s[6]=e("span",null,"Cost per mile",-1)),e("span",null,"$"+n(x(a.maintenanceBreakdowns.qs_cpm)),1)]),e("div",Be,[s[7]||(s[7]=e("span",null,"Num of WOs",-1)),e("span",null,n(a.maintenanceBreakdowns.total_repair_orders),1)]),e("div",Fe,[s[8]||(s[8]=e("span",null,"Current Costs",-1)),e("span",null,"$"+n(x(a.maintenanceBreakdowns.total_invoice_amount)),1)]),e("div",Pe,[s[9]||(s[9]=e("span",null,"Missing Invoices",-1)),e("span",null,n(a.maintenanceBreakdowns.missing_invoices_count||0),1)])])]),e("div",Ae,[s[18]||(s[18]=e("h3",{class:"text-base font-semibold mb-1"},"Netradyne Alerts Bonus Criteria",-1)),s[19]||(s[19]=e("div",{class:"text-xs text-muted-foreground mb-1"},"Green Zone Score",-1)),e("div",Me,[e("div",{class:A(["text-4xl font-bold",G(a.safetyData.average_driver_score)])},n(w(a.safetyData.average_driver_score||"N/A")),3),i(c(F),{variant:j(k.value),class:"text-xs"},{default:d(()=>[b(n(T(k.value)),1)]),_:1},8,["variant"])]),s[20]||(s[20]=e("div",{class:"flex justify-between items-center text-sm font-semibold mb-2"},[e("span",null,"Alert Type"),e("div",{class:"flex items-center gap-2"},[e("span",{class:"w-12 text-right"},"Total"),e("span",{class:"w-16 text-right"},"P1KH")])],-1)),e("div",Oe,[e("div",Ve,[s[12]||(s[12]=e("span",null,"Distracted Driving",-1)),e("div",We,[e("span",Ie,n(w(a.safetyData.driver_distraction)),1),e("span",ze,n(v(($=a.safetyData.rates)==null?void 0:$.driver_distraction)),1)])]),e("div",Ee,[s[13]||(s[13]=e("span",null,"Speeding",-1)),e("div",Ge,[e("span",Le,n(w(a.safetyData.speeding_violations)),1),e("span",qe,n(v((h=a.safetyData.rates)==null?void 0:h.speeding_violations)),1)])]),e("div",Ue,[s[14]||(s[14]=e("span",null,"Sign Violation",-1)),e("div",He,[e("span",Ke,n(w(a.safetyData.sign_violations)),1),e("span",Qe,n(v((g=a.safetyData.rates)==null?void 0:g.sign_violations)),1)])]),e("div",Ye,[s[15]||(s[15]=e("span",null,"Traffic Light Violation",-1)),e("div",Ze,[e("span",Xe,n(w(a.safetyData.traffic_light_violation)),1),e("span",Je,n(v((l=a.safetyData.rates)==null?void 0:l.traffic_light_violation)),1)])]),e("div",et,[s[16]||(s[16]=e("span",null,"Following Distance",-1)),e("div",tt,[e("span",at,n(w(a.safetyData.following_distance)),1),e("span",st,n(v((r=a.safetyData.rates)==null?void 0:r.following_distance)),1)])]),e("div",rt,[s[17]||(s[17]=e("span",null,"Roadside Parking",-1)),e("div",nt,[e("span",ot,n(w(a.safetyData.roadside_parking)),1),e("span",it,n(v((o=a.safetyData.rates)==null?void 0:o.roadside_parking)),1)])])]),e("div",lt,[e("div",null,"Total Hours Analyzed: "+n(w(a.safetyData.total_hours||0)),1)])])])}}}),dt={class:"bg-card rounded-lg border shadow-sm p-6 mb-6"},ut={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},mt={class:"p-4 border rounded-lg"},ft={class:"flex items-center justify-between gap-3 mb-3"},vt={class:"p-4 border rounded-lg"},gt={class:"flex items-center justify-between gap-3 mb-3"},pt={class:"p-4 border rounded-lg"},xt={class:"flex items-center justify-between gap-3 mb-3"},bt=W({__name:"AdditionalMetricsCard",props:{performanceData:{type:Object,default:()=>({})},performanceRatings:{type:Object,default:()=>({})}},setup(a){const f=v=>v==null?"0":Math.round(parseFloat(v)).toString(),u=v=>{if(v==null)return"0";const x=parseFloat(v);return isNaN(x)?"0":x.toFixed(2).replace(/\.?0+$/,"")},y=v=>{if(!v)return"Not Available";switch(v){case"fantastic_plus":return"Fantastic +";case"fantastic":return"Fantastic";case"good":return"Good";case"fair":return"Fair";case"poor":return"Poor";default:return v.charAt(0).toUpperCase()+v.slice(1).replace(/_/g," ")}},p=v=>{if(!v)return"outline";switch(v){case"fantastic_plus":return"fantastic-plus";case"fantastic":return"fantastic";case"good":return"good";case"fair":return"fair";case"poor":return"poor";default:return"outline"}},w=v=>{if(!v)return"text-gray-600";switch(v){case"fantastic_plus":return"text-green-600";case"fantastic":return"text-emerald-600";case"good":return"text-blue-600";case"fair":return"text-amber-600";case"poor":return"text-red-600";default:return"text-indigo-600"}};return(v,x)=>(m(),R("div",dt,[x[6]||(x[6]=e("h3",{class:"text-xl font-semibold mb-4"},"Additional Performance Metrics For T6W",-1)),e("div",ut,[e("div",mt,[x[0]||(x[0]=e("h4",{class:"text-lg font-medium mb-2"},"VCR-P",-1)),x[1]||(x[1]=e("div",{class:"text-sm text-muted-foreground mb-1"},"Count",-1)),e("div",ft,[e("div",{class:A(["text-3xl font-bold",w(a.performanceRatings.vcr_preventable)])},n(u(a.performanceData.vcr_preventable)),3),i(c(F),{variant:p(a.performanceRatings.vcr_preventable),class:"text-xs"},{default:d(()=>[b(n(y(a.performanceRatings.vcr_preventable)),1)]),_:1},8,["variant"])])]),e("div",vt,[x[2]||(x[2]=e("h4",{class:"text-lg font-medium mb-2"},"VMCR-P",-1)),x[3]||(x[3]=e("div",{class:"text-sm text-muted-foreground mb-1"},"Count",-1)),e("div",gt,[e("div",{class:A(["text-3xl font-bold",w(a.performanceRatings.vmcr_p)])},n(f(a.performanceData.vmcr_p)),3),i(c(F),{variant:p(a.performanceRatings.vmcr_p),class:"text-xs"},{default:d(()=>[b(n(y(a.performanceRatings.vmcr_p)),1)]),_:1},8,["variant"])])]),e("div",pt,[x[4]||(x[4]=e("h4",{class:"text-lg font-medium mb-2"},"Open BOC",-1)),x[5]||(x[5]=e("div",{class:"text-sm text-muted-foreground mb-1"},"Count",-1)),e("div",xt,[e("div",{class:A(["text-3xl font-bold",w(a.performanceRatings.open_boc)])},n(f(a.performanceData.open_boc)),3),i(c(F),{variant:p(a.performanceRatings.open_boc),class:"text-xs"},{default:d(()=>[b(n(y(a.performanceRatings.open_boc)),1)]),_:1},8,["variant"])])])])]))}}),yt=W({__name:"CardDescription",props:{class:{}},setup(a){const f=a;return(u,y)=>(m(),R("p",{class:A(c(ue)("text-sm text-muted-foreground",f.class))},[J(u.$slots,"default")],2))}}),_t={class:"flex flex-col md:flex-row md:items-center md:justify-between gap-2"},wt={class:"flex items-center gap-2"},ht={class:"relative w-full md:w-auto"},Dt={class:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none"},kt={class:"overflow-x-auto"},$t={class:"flex items-center gap-1"},Nt={class:"flex items-center justify-end gap-1"},St={class:"flex items-center justify-end gap-1"},Rt={class:"flex items-center justify-end gap-1"},jt={class:"flex flex-col items-center justify-center gap-2"},Ct={key:0},Tt={key:1},Bt={class:"border-t bg-muted/20 px-4 py-3 flex flex-col sm:flex-row justify-between items-center gap-2"},Ft={class:"flex items-center gap-4 text-sm text-muted-foreground"},Pt={class:"flex items-center gap-1"},At={class:"flex items-center gap-1"},Mt={class:"relative"},Ot=["value"],Vt={class:"flex space-x-1"},Wt=W({__name:"DriverPerformanceTable",props:{driversData:{type:Array,default:()=>[]}},setup(a){const f=a,u=O(""),y=O("overall_score"),p=O("desc"),w=l=>{y.value===l?p.value=p.value==="asc"?"desc":"asc":(y.value=l,p.value=l==="driver_name"?"asc":"desc")},v=()=>{u.value="",y.value="overall_score",p.value="desc",_.value=1,j.value=10},x=C(()=>{if(!f.driversData||f.driversData.length===0)return[];if(!u.value)return f.driversData;const l=u.value.toLowerCase();return f.driversData.filter(r=>r.driver_name.toLowerCase().includes(l))}),T=C(()=>x.value.length===0?[]:[...x.value].sort((l,r)=>{const o=l[y.value],D=r[y.value];return typeof o=="string"?p.value==="asc"?o.localeCompare(D):D.localeCompare(o):p.value==="asc"?o-D:D-o})),_=O(1),j=O(10);K([y,p,u],()=>{_.value=1}),K(j,()=>{_.value=1});const k=C(()=>T.value.length),P=C(()=>Math.max(1,Math.ceil(k.value/j.value)));K([P,_],()=>{_.value>P.value&&(_.value=P.value)});const G=C(()=>{const l=P.value,r=_.value;if(l<=5)return Array.from({length:l},(B,H)=>H+1);let o=[1,l];const D=[r-1,r,r+1].filter(B=>B>1&&B<l);o.push(...D),o=[...new Set(o)].sort((B,H)=>B-H);const M=[];let L=0;for(const B of o)B-L>1&&M.push(-1),M.push(B),L=B;return M}),t=C(()=>(_.value-1)*j.value),s=C(()=>Math.min(t.value+j.value,k.value)),$=C(()=>T.value.slice(t.value,s.value)),h=l=>l>=75?"success":l>=50?"midRange":"destructive",g=l=>l>=900?"success":l>=750?"midRange":l>=600?"warning":"destructive";return(l,r)=>(m(),S(c(oe),{class:"shadow-sm border bg-card"},{default:d(()=>[i(c(ie),{class:"p-4 border-b"},{default:d(()=>[e("div",_t,[e("div",null,[i(c(le),{class:"text-lg font-semibold flex items-center gap-2"},{default:d(()=>[i(N,{name:"users",class:"h-5 w-5 text-primary"}),r[9]||(r[9]=b(" Driver Performance "))]),_:1}),i(yt,null,{default:d(()=>r[10]||(r[10]=[b("Overall driver performance metrics")])),_:1})]),e("div",wt,[e("div",ht,[e("div",Dt,[i(N,{name:"search",class:"h-4 w-4 text-muted-foreground"})]),i(c(de),{modelValue:u.value,"onUpdate:modelValue":r[0]||(r[0]=o=>u.value=o),placeholder:"Search drivers...",class:"pl-10 w-full md:w-[200px]"},null,8,["modelValue"])]),i(c(U),{variant:"outline",size:"sm",onClick:v,class:"hidden md:flex items-center gap-1"},{default:d(()=>[i(N,{name:"rotate-ccw",class:"h-4 w-4"}),r[11]||(r[11]=b(" Reset "))]),_:1})])])]),_:1}),i(c(ce),{class:"p-0"},{default:d(()=>[e("div",kt,[i(c(se),{class:"relative h-[400px] overflow-auto"},{default:d(()=>[i(c(re),null,{default:d(()=>[i(c(Q),{class:"sticky top-0 z-10 border-b bg-background hover:bg-background"},{default:d(()=>[i(c(q),{class:"w-12 text-center"},{default:d(()=>r[12]||(r[12]=[e("div",{class:"flex items-center justify-center"}," # ",-1)])),_:1}),i(c(q),{onClick:r[1]||(r[1]=o=>w("driver_name")),class:"cursor-pointer whitespace-nowrap"},{default:d(()=>[e("div",$t,[r[13]||(r[13]=b(" Driver Name ")),y.value==="driver_name"?(m(),S(N,{key:0,name:p.value==="asc"?"arrow-up":"arrow-down",class:"h-4 w-4"},null,8,["name"])):(m(),S(N,{key:1,name:"arrow-up-down",class:"h-4 w-4 opacity-50"}))])]),_:1}),i(c(q),{onClick:r[2]||(r[2]=o=>w("acceptance_score")),class:"cursor-pointer text-right whitespace-nowrap"},{default:d(()=>[e("div",Nt,[r[14]||(r[14]=b(" Acceptance ")),y.value==="acceptance_score"?(m(),S(N,{key:0,name:p.value==="asc"?"arrow-up":"arrow-down",class:"h-4 w-4"},null,8,["name"])):(m(),S(N,{key:1,name:"arrow-up-down",class:"h-4 w-4 opacity-50"}))])]),_:1}),i(c(q),{onClick:r[3]||(r[3]=o=>w("on_time_score")),class:"cursor-pointer text-right whitespace-nowrap"},{default:d(()=>[e("div",St,[r[15]||(r[15]=b(" On-Time ")),y.value==="on_time_score"?(m(),S(N,{key:0,name:p.value==="asc"?"arrow-up":"arrow-down",class:"h-4 w-4"},null,8,["name"])):(m(),S(N,{key:1,name:"arrow-up-down",class:"h-4 w-4 opacity-50"}))])]),_:1}),i(c(q),{onClick:r[4]||(r[4]=o=>w("safety_score")),class:"cursor-pointer text-right whitespace-nowrap"},{default:d(()=>[e("div",Rt,[r[16]||(r[16]=b(" Green Zone Score ")),y.value==="safety_score"?(m(),S(N,{key:0,name:p.value==="asc"?"arrow-up":"arrow-down",class:"h-4 w-4"},null,8,["name"])):(m(),S(N,{key:1,name:"arrow-up-down",class:"h-4 w-4 opacity-50"}))])]),_:1})]),_:1})]),_:1}),i(c(ne),null,{default:d(()=>[(m(!0),R(z,null,E($.value,(o,D)=>(m(),S(c(Q),{key:o.driver_name,class:"hover:bg-muted/20 transition-colors"},{default:d(()=>[i(c(I),{class:"text-center"},{default:d(()=>[i(c(F),{variant:"outline",class:"min-w-[28px] justify-center"},{default:d(()=>[b(n(t.value+D+1),1)]),_:2},1024)]),_:2},1024),i(c(I),{class:"font-medium"},{default:d(()=>[b(n(o.driver_name),1)]),_:2},1024),i(c(I),{class:"text-right"},{default:d(()=>[i(c(F),{variant:h(o.acceptance_score)},{default:d(()=>[b(n(Math.round(o.acceptance_score))+"% ",1)]),_:2},1032,["variant"])]),_:2},1024),i(c(I),{class:"text-right"},{default:d(()=>[i(c(F),{variant:h(o.on_time_score)},{default:d(()=>[b(n(Math.round(o.on_time_score))+"% ",1)]),_:2},1032,["variant"])]),_:2},1024),i(c(I),{class:"text-right"},{default:d(()=>[i(c(F),{variant:g(o.raw_safety_score)},{default:d(()=>[b(n(Math.round(o.raw_safety_score)),1)]),_:2},1032,["variant"])]),_:2},1024)]),_:2},1024))),128)),x.value.length===0?(m(),S(c(Q),{key:0},{default:d(()=>[i(c(I),{colspan:"6",class:"text-center py-8 text-muted-foreground"},{default:d(()=>[e("div",jt,[i(N,{name:"users-x",class:"h-10 w-10 opacity-50"}),u.value?(m(),R("p",Ct,'No drivers found matching "'+n(u.value)+'"',1)):(m(),R("p",Tt,"No driver performance data available for the selected period.")),u.value?(m(),S(c(U),{key:2,variant:"outline",size:"sm",onClick:r[5]||(r[5]=o=>u.value="")},{default:d(()=>r[17]||(r[17]=[b(" Clear search ")])),_:1})):V("",!0)])]),_:1})]),_:1})):V("",!0)]),_:1})]),_:1})]),e("div",Bt,[e("div",Ft,[e("span",Pt,[i(N,{name:"list",class:"h-4 w-4"}),b(" Showing "+n(t.value+1)+"-"+n(s.value)+" of "+n(k.value)+" drivers ",1)]),e("span",At,[i(N,{name:"layout-grid",class:"h-4 w-4"}),r[18]||(r[18]=b(" Per page: "))]),e("div",Mt,[ee(e("select",{"onUpdate:modelValue":r[6]||(r[6]=o=>j.value=o),class:"h-8 appearance-none rounded-md border bg-background px-2 py-1 text-sm focus:ring-2 focus:ring-ring"},[(m(),R(z,null,E([5,10,20,50],o=>e("option",{key:o,value:o},n(o),9,Ot)),64))],512),[[te,j.value,void 0,{number:!0}]]),r[19]||(r[19]=e("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"},[e("svg",{class:"h-4 w-4 opacity-50",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})])],-1))])]),e("div",Vt,[i(c(U),{size:"sm",variant:"ghost",onClick:r[7]||(r[7]=o=>_.value--),disabled:_.value===1,class:"flex items-center gap-1"},{default:d(()=>[i(N,{name:"chevron-left",class:"h-4 w-4"}),r[20]||(r[20]=b(" Prev "))]),_:1},8,["disabled"]),(m(!0),R(z,null,E(G.value,o=>(m(),S(c(U),{key:o,size:"sm",variant:"ghost",onClick:D=>o!==-1?_.value=o:null,class:A({"border-primary bg-primary/10 text-primary font-medium":o===_.value,"opacity-50 pointer-events-none":o===-1})},{default:d(()=>[b(n(o===-1?"...":o),1)]),_:2},1032,["onClick","class"]))),128)),i(c(U),{size:"sm",variant:"ghost",onClick:r[8]||(r[8]=o=>_.value++),disabled:_.value===P.value,class:"flex items-center gap-1"},{default:d(()=>[r[21]||(r[21]=b(" Next ")),i(N,{name:"chevron-right",class:"h-4 w-4"})]),_:1},8,["disabled"])])])]),_:1})]),_:1}))}}),It={class:"container w-full md:max-w-2xl lg:max-w-3xl xl:max-w-6xl lg:mx-auto m-0 p-2 md:p-4 lg:p-6 space-y-2 md:space-y-4 lg:space-y-6"},zt={class:"flex items-center justify-between mb-6"},Et={class:"h-auto"},Gt={class:"bg-card rounded-lg border shadow-sm p-3 sm:p-4 h-16 sm:h-20"},Lt={class:"flex items-center justify-between h-full"},qt={class:"text-xl sm:text-2xl font-bold text-indigo-600"},ma=W({__name:"Summary",props:{tenantSlug:String,summaries:Object,delayBreakdowns:Object,rejectionBreakdowns:Object,maintenanceBreakdowns:Object,dateFilter:String,dateRange:Object,driversOverallPerformance:Object,milesDriven:Number,permissions:Array},setup(a){const f=a;O("on-time");const u=O(f.dateFilter||"t6w"),y=O(null),p=O(null);ae(()=>{});const w=C(()=>{const s={yesterday:"yesterday","current-week":"current_week",t6w:"rolling_6_weeks",quarterly:"quarterly"}[u.value]||u.value;return j(s)}),v=t=>{u.value=t,Z.visit(route("dashboard",{tenantSlug:f.tenantSlug,dateFilter:t,minInvoiceAmount:y.value||null,outstandingDate:p.value||null}),{only:["summaries","delayBreakdowns","rejectionBreakdowns","maintenanceBreakdowns","dateFilter","dateRange","milesDriven","driversOverallPerformance"]})},x=[{title:f.tenantSlug?"Dashboard":"Admin Dashboard",href:f.tenantSlug?route("dashboard",{tenantSlug:f.tenantSlug}):route("admin.dashboard")},{title:"Performance Summary",href:route("dashboard",{tenantSlug:f.tenantSlug})}],T=C(()=>{var t,s;return(s=(t=f.summaries)==null?void 0:t.performance)!=null&&s.last_updated?_(new Date(f.summaries.performance.last_updated)):_(new Date)}),_=t=>new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(t),j=t=>{var $,h;if((h=($=f.summaries)==null?void 0:$[t])!=null&&h.date_range){const g=new Date(f.summaries[t].date_range.start+"T12:00:00"),l=new Date(f.summaries[t].date_range.end+"T12:00:00");return`${k(g)} - ${k(l)}`}const s=new Date;switch(t){case"yesterday":{const g=new Date(s);return g.setDate(g.getDate()-1),k(g)}case"current_week":{const g=new Date(s);g.setDate(s.getDate()-s.getDay());const l=new Date(g);return l.setDate(g.getDate()+6),`${k(g)} - ${k(l)}`}case"rolling_6_weeks":{const g=new Date(s);g.setDate(s.getDate()-s.getDay()+6);const l=new Date(g);return l.setDate(g.getDate()-6*7+1),`${k(l)} - ${k(g)}`}case"quarterly":{const g=new Date(s),l=new Date(s);return l.setMonth(l.getMonth()-3),`${k(l)} - ${k(g)}`}default:return""}},k=t=>new Intl.DateTimeFormat("en-US",{month:"numeric",day:"numeric",year:"numeric"}).format(t),P=t=>t==null?"0":new Intl.NumberFormat().format(Math.round(t)),G=C(()=>{var g,l;if(!((l=(g=f.summaries)==null?void 0:g.performance)!=null&&l.ratings))return"Not Available";const t=f.summaries.performance.ratings,s={fantastic_plus:5,fantastic:4,good:3,fair:2,poor:1},$=["average_acceptance","average_on_time","average_maintenance_variance_to_spend","open_boc","vcr_preventable","vmcr_p"];let h="fantastic_plus";for(const r of $)t[r]&&s[t[r]]<s[h]&&(h=t[r]);switch(h){case"fantastic_plus":return"Fantastic +";case"fantastic":return"Fantastic";case"good":return"Good";case"fair":return"Fair";case"poor":return"Poor";default:return"Not Available"}});return(t,s)=>(m(),S(X,{breadcrumbs:x,tenantSlug:a.tenantSlug,permissions:f.permissions},{default:d(()=>{var $,h,g,l,r,o,D,M,L,B;return[i(c(Y),{title:"Performance Summary Dashboard"}),e("div",It,[e("div",zt,[s[0]||(s[0]=e("h1",{class:"text-2xl font-bold"},null,-1)),i(c(F),{variant:"outline",class:"text-sm"},{default:d(()=>[i(N,{name:"calendar",class:"mr-1 h-4 w-4"}),b(" Last updated: "+n(T.value),1)]),_:1})]),i(fe,{operationalExcellenceScore:G.value},null,8,["operationalExcellenceScore"]),i(_e,{onTabChange:v,dateRangeText:w.value,weekNumber:($=a.dateRange)==null?void 0:$.weekNumber,startWeekNumber:(h=a.dateRange)==null?void 0:h.startWeekNumber,endWeekNumber:(g=a.dateRange)==null?void 0:g.endWeekNumber,year:(l=a.dateRange)==null?void 0:l.year,activeTabId:u.value},null,8,["dateRangeText","weekNumber","startWeekNumber","endWeekNumber","year","activeTabId"]),a.summaries?(m(),S(ct,{key:0,performanceData:((r=a.summaries.performance)==null?void 0:r.data)||{},performanceRatings:((o=a.summaries.performance)==null?void 0:o.ratings)||{},safetyData:a.summaries.safety||{},delayBreakdowns:((D=a.delayBreakdowns)==null?void 0:D.by_code)||[],rejectionBreakdowns:((M=a.rejectionBreakdowns)==null?void 0:M.by_reason)||[],maintenanceBreakdowns:a.maintenanceBreakdowns||{},milesDriven:a.milesDriven},null,8,["performanceData","performanceRatings","safetyData","delayBreakdowns","rejectionBreakdowns","maintenanceBreakdowns","milesDriven"])):V("",!0),e("div",Et,[a.driversOverallPerformance?(m(),S(Wt,{key:0,driversData:a.driversOverallPerformance.drivers||[]},null,8,["driversData"])):V("",!0)]),a.summaries?(m(),S(bt,{key:1,performanceData:((L=a.summaries.performance)==null?void 0:L.data)||{},performanceRatings:((B=a.summaries.performance)==null?void 0:B.ratings)||{}},null,8,["performanceData","performanceRatings"])):V("",!0),e("div",Gt,[e("div",Lt,[s[1]||(s[1]=e("h3",{class:"text-base font-semibold"},"Miles Driven",-1)),e("div",qt,n(P(a.milesDriven))+" Mile ",1)])])])]}),_:1},8,["tenantSlug","permissions"]))}});export{ma as default};
